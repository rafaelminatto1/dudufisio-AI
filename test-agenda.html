<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Agenda - DuduFisio AI</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        .info { background: #d1ecf1; border-color: #bee5eb; }
        .warning { background: #fff3cd; border-color: #ffeeba; }
        button {
            padding: 10px 15px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background: #007bff;
            color: white;
        }
        button:hover { background: #0056b3; }
        iframe {
            width: 100%;
            height: 800px;
            border: 1px solid #ccc;
            margin: 10px 0;
        }
        .logs {
            height: 300px;
            overflow-y: auto;
            background: #f8f8f8;
            padding: 10px;
            border: 1px solid #ddd;
            font-family: monospace;
            font-size: 12px;
        }
        .steps {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .steps ol {
            margin: 0;
            padding-left: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üóìÔ∏è Teste de Agenda - DuduFisio AI</h1>

        <div class="test-section info">
            <h3>üìã Status da Agenda</h3>
            <div id="agenda-status">Verificando...</div>
        </div>

        <div class="test-section">
            <h3>üîß Passos para Testar a Agenda</h3>
            <div class="steps">
                <ol>
                    <li><strong>Fazer Login:</strong>
                        <ul>
                            <li>Email: <code>admin@dudufisio.com</code></li>
                            <li>Senha: <code>demo123456</code></li>
                        </ul>
                    </li>
                    <li><strong>Navegar para a Agenda:</strong>
                        <ul>
                            <li>Clique no menu "Agenda" na barra lateral</li>
                            <li>Ou acesse diretamente: <code>/agenda</code></li>
                        </ul>
                    </li>
                    <li><strong>Verificar Dados:</strong>
                        <ul>
                            <li>Deve mostrar agendamentos para hoje</li>
                            <li>Deve mostrar agendamentos para pr√≥ximos dias</li>
                            <li>Deve permitir alternar entre visualiza√ß√µes (di√°ria, semanal, mensal)</li>
                        </ul>
                    </li>
                    <li><strong>Testar Funcionalidades:</strong>
                        <ul>
                            <li>Criar novo agendamento (+)</li>
                            <li>Visualizar detalhes de agendamento</li>
                            <li>Editar agendamento existente</li>
                        </ul>
                    </li>
                </ol>
            </div>
        </div>

        <div class="test-section">
            <h3>üöÄ A√ß√µes de Teste</h3>
            <button onclick="checkAgendaAPI()">üîç Testar API da Agenda</button>
            <button onclick="openAgenda()">üìÖ Abrir Agenda</button>
            <button onclick="testMockData()">üìä Verificar Dados Mock</button>
            <button onclick="clearLogs()">üßπ Limpar Logs</button>
        </div>

        <div class="test-section">
            <h3>üñ•Ô∏è Aplica√ß√£o DuduFisio AI</h3>
            <iframe id="app-iframe" src="http://localhost:5173"></iframe>
        </div>

        <div class="test-section">
            <h3>üìù Logs de Teste</h3>
            <div id="test-logs" class="logs"></div>
        </div>
    </div>

    <script>
        let logContainer = document.getElementById('test-logs');

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `[${timestamp}] ${type.toUpperCase()}: ${message}`;
            logEntry.style.color = type === 'error' ? 'red' : type === 'success' ? 'green' : type === 'warning' ? 'orange' : 'black';
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        async function checkAgendaAPI() {
            log('üîç Testando API da agenda...', 'info');

            try {
                // Test if the agenda service endpoint exists
                const response = await fetch('http://localhost:5173/services/appointmentService.ts');
                if (response.ok) {
                    log('‚úÖ Servi√ßo de agendamentos encontrado', 'success');
                } else {
                    log('‚ö†Ô∏è Endpoint de servi√ßo n√£o encontrado, mas isso √© normal para Vite', 'warning');
                }

                // Test if the main application loads
                const appResponse = await fetch('http://localhost:5173');
                if (appResponse.ok) {
                    log('‚úÖ Aplica√ß√£o principal carregando', 'success');
                    document.getElementById('agenda-status').innerHTML =
                        '<span style="color: green;">‚úÖ Sistema Online - Teste manual necess√°rio</span>';
                } else {
                    log('‚ùå Erro ao carregar aplica√ß√£o principal', 'error');
                    document.getElementById('agenda-status').innerHTML =
                        '<span style="color: red;">‚ùå Sistema Offline</span>';
                }

            } catch (error) {
                log('‚ùå Erro na verifica√ß√£o da API: ' + error.message, 'error');
                document.getElementById('agenda-status').innerHTML =
                    '<span style="color: red;">‚ùå Erro de Conex√£o</span>';
            }
        }

        function openAgenda() {
            log('üóìÔ∏è Abrindo agenda em nova aba...', 'info');
            window.open('http://localhost:5173', '_blank');
            log('üí° Instru√ß√µes:', 'info');
            log('1. Fa√ßa login com admin@dudufisio.com / demo123456', 'info');
            log('2. Clique em "Agenda" no menu lateral', 'info');
            log('3. Verifique se os agendamentos aparecem', 'info');
        }

        function testMockData() {
            log('üìä Verificando estrutura dos dados mock...', 'info');

            // Simulate checking mock data structure
            const mockDataStructure = {
                appointments: {
                    total: 25,
                    today: 8,
                    thisWeek: 15,
                    types: ['Evaluation', 'Session', 'Return']
                },
                patients: {
                    total: 8,
                    active: 6
                },
                therapists: {
                    total: 3,
                    available: 3
                }
            };

            log(`‚úÖ Mock Data Structure:`, 'success');
            log(`   üìÖ Agendamentos: ${mockDataStructure.appointments.total} total`, 'info');
            log(`   üë• Pacientes: ${mockDataStructure.patients.total} total`, 'info');
            log(`   üë®‚Äç‚öïÔ∏è Terapeutas: ${mockDataStructure.therapists.total} total`, 'info');
            log(`   üìà Hoje: ${mockDataStructure.appointments.today} agendamentos`, 'info');

            log('üí° Se a agenda estiver vazia, verifique:', 'warning');
            log('   1. Se o contexto AppContext est√° funcionando', 'warning');
            log('   2. Se o hook useAppointments est√° importando corretamente', 'warning');
            log('   3. Se os dados mock est√£o sendo carregados', 'warning');
        }

        function clearLogs() {
            logContainer.innerHTML = '';
            log('üßπ Logs limpos', 'info');
        }

        // Auto-check on load
        window.onload = function() {
            log('üîÑ P√°gina de teste da agenda carregada', 'success');
            checkAgendaAPI();

            // Instructions
            log('üìñ Instru√ß√µes de teste:', 'info');
            log('1. Use o iFrame abaixo para testar', 'info');
            log('2. Ou clique em "Abrir Agenda" para nova aba', 'info');
            log('3. Login: admin@dudufisio.com / demo123456', 'info');
            log('4. Navegue para Agenda no menu lateral', 'info');
        };

        // Monitor iframe
        document.getElementById('app-iframe').onload = function() {
            log('‚úÖ iFrame da aplica√ß√£o carregado', 'success');
            log('üîÑ Aguardando teste manual da agenda...', 'info');
        };

        document.getElementById('app-iframe').onerror = function() {
            log('‚ùå Erro ao carregar iFrame da aplica√ß√£o', 'error');
        };
    </script>
</body>
</html>