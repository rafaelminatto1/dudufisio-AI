<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Final - Status das P√°ginas</title>
    <style>
        body { font-family: system-ui, -apple-system, sans-serif; margin: 0; padding: 20px; background: #f8fafc; }
        .container { max-width: 1000px; margin: 0 auto; }
        .status-card { background: white; border-radius: 12px; padding: 20px; margin: 15px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .success { border-left: 4px solid #10b981; }
        .error { border-left: 4px solid #ef4444; }
        .warning { border-left: 4px solid #f59e0b; }
        .info { border-left: 4px solid #3b82f6; }
        .test-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 20px 0; }
        .test-item { background: white; border-radius: 8px; padding: 15px; border: 1px solid #e5e7eb; }
        .test-result { font-weight: bold; margin: 5px 0; }
        .passed { color: #10b981; }
        .failed { color: #ef4444; }
        .pending { color: #f59e0b; }
        h1 { color: #1f2937; margin-bottom: 30px; }
        h2 { color: #374151; margin-top: 30px; }
        .app-preview { border: 2px solid #e5e7eb; border-radius: 8px; margin: 20px 0; overflow: hidden; }
        iframe { width: 100%; height: 500px; border: none; }
        button { background: #3b82f6; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin: 5px; }
        button:hover { background: #2563eb; }
        .summary { display: flex; gap: 20px; margin: 20px 0; }
        .metric { text-align: center; background: white; padding: 20px; border-radius: 8px; flex: 1; }
        .metric-value { font-size: 32px; font-weight: bold; color: #3b82f6; }
        .metric-label { color: #6b7280; margin-top: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Status Final das P√°ginas - DuduFisio AI</h1>

        <div class="summary" id="summary">
            <div class="metric">
                <div class="metric-value" id="total-score">-</div>
                <div class="metric-label">Score Total</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="core-status">-</div>
                <div class="metric-label">Sistema Core</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="pages-status">-</div>
                <div class="metric-label">P√°ginas Principais</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="auth-status">-</div>
                <div class="metric-label">Autentica√ß√£o</div>
            </div>
        </div>

        <button onclick="runCompleteTest()">üîç Executar Teste Completo</button>
        <button onclick="loadMainApp()">üì± Carregar App Principal</button>

        <div id="test-results"></div>

        <h2>üéØ Preview da Aplica√ß√£o</h2>
        <div class="app-preview">
            <iframe id="app-frame" src="about:blank"></iframe>
        </div>
    </div>

    <script>
        let testResults = [];

        function updateSummary() {
            const coreTests = testResults.filter(t => t.category === 'core');
            const pageTests = testResults.filter(t => t.category === 'pages');
            const authTests = testResults.filter(t => t.category === 'auth');

            const coreScore = coreTests.length ? Math.round((coreTests.filter(t => t.passed).length / coreTests.length) * 100) : 0;
            const pageScore = pageTests.length ? Math.round((pageTests.filter(t => t.passed).length / pageTests.length) * 100) : 0;
            const authScore = authTests.length ? Math.round((authTests.filter(t => t.passed).length / authTests.length) * 100) : 0;

            const totalScore = Math.round((coreScore + pageScore + authScore) / 3);

            document.getElementById('total-score').textContent = totalScore + '%';
            document.getElementById('core-status').textContent = coreScore + '%';
            document.getElementById('pages-status').textContent = pageScore + '%';
            document.getElementById('auth-status').textContent = authScore + '%';
        }

        function addTest(name, category, passed, details) {
            testResults.push({ name, category, passed, details });

            const resultDiv = document.createElement('div');
            resultDiv.className = `status-card ${passed ? 'success' : 'error'}`;
            resultDiv.innerHTML = `
                <div class="test-result ${passed ? 'passed' : 'failed'}">
                    ${passed ? '‚úÖ' : '‚ùå'} ${name}
                </div>
                <div style="color: #6b7280; margin-top: 5px;">
                    ${details}
                </div>
            `;

            document.getElementById('test-results').appendChild(resultDiv);
            updateSummary();
        }

        async function testEndpoint(name, url, category = 'core') {
            try {
                const response = await fetch(url, { method: 'HEAD' });
                addTest(name, category, response.ok, `HTTP ${response.status} - ${response.ok ? 'Respondendo corretamente' : 'Erro na resposta'}`);
                return response.ok;
            } catch (error) {
                addTest(name, category, false, `Erro de conex√£o: ${error.message}`);
                return false;
            }
        }

        async function testReactComponent(name, importPath, category = 'pages') {
            try {
                const module = await import(importPath);
                addTest(name, category, true, 'Componente importado e carregado com sucesso');
                return true;
            } catch (error) {
                addTest(name, category, false, `Erro na importa√ß√£o: ${error.message}`);
                return false;
            }
        }

        async function runCompleteTest() {
            document.getElementById('test-results').innerHTML = '';
            testResults = [];

            // Core System Tests
            await testEndpoint('Servidor Principal', 'http://localhost:5174/', 'core');
            await testEndpoint('JavaScript Entry Point', 'http://localhost:5174/index.tsx', 'core');
            await testEndpoint('CSS Principal', 'http://localhost:5174/index.css', 'core');

            // React Components Tests
            await testReactComponent('App Principal', '/App.tsx', 'core');
            await testReactComponent('Sistema de Rotas', '/AppRoutes.tsx', 'core');

            // Authentication Tests
            await testReactComponent('Contexto de Autentica√ß√£o', '/contexts/SupabaseAuthContext.tsx', 'auth');
            await testEndpoint('Servi√ßo de Autentica√ß√£o', 'http://localhost:5174/services/auth/supabaseAuthService.ts', 'auth');

            // Main Pages Tests
            await testReactComponent('Gest√£o de Pacientes', '/pages/PatientListPage.tsx', 'pages');
            await testReactComponent('P√°gina de Agenda', '/pages/AgendaPage.tsx', 'pages');
            await testReactComponent('Dashboard Completo', '/pages/CompleteDashboard.tsx', 'pages');

            // Additional Components
            await testReactComponent('Portal do Paciente', '/pages/PatientPortalDashboard.tsx', 'pages');
            await testReactComponent('Portal do Parceiro', '/pages/PartnerPortalDashboard.tsx', 'pages');

            // Navigation Tests
            await testReactComponent('Hook de Navega√ß√£o', '/hooks/useNavigate.ts', 'core');

            // UI Components
            await testReactComponent('Error Boundary', '/components/ErrorBoundary.tsx', 'core');

            const finalScore = testResults.filter(t => t.passed).length / testResults.length * 100;

            if (finalScore >= 90) {
                addTest('Status Geral', 'core', true, `üéâ Excelente! ${Math.round(finalScore)}% dos testes passaram. Sistema funcionando corretamente.`);
            } else if (finalScore >= 70) {
                addTest('Status Geral', 'core', true, `‚ö†Ô∏è Bom! ${Math.round(finalScore)}% dos testes passaram. Algumas funcionalidades podem estar limitadas.`);
            } else {
                addTest('Status Geral', 'core', false, `‚ùå ${Math.round(finalScore)}% dos testes passaram. Sistema precisa de corre√ß√µes.`);
            }
        }

        function loadMainApp() {
            const iframe = document.getElementById('app-frame');
            iframe.src = 'http://localhost:5174/';

            addTest('Carregamento da Aplica√ß√£o', 'core', true, 'Aplica√ß√£o carregada no preview abaixo');
        }

        // Auto-load app on page load
        window.addEventListener('load', () => {
            setTimeout(loadMainApp, 1000);
        });
    </script>
</body>
</html>