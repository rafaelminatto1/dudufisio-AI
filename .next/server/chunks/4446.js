"use strict";exports.id=4446,exports.ids=[4446],exports.modules={2408:(a,b,c)=>{c.d(b,{$:()=>l});var d=c(82015),e=c(72393),f=c(4183),g=c(737),h=c(26821);let i={SESSION_COMPLETED:50,PAIN_LOG_ENTRY:10},j=async a=>{let b,[c,d]=await Promise.all([g.Uh(a),h.mQ(a)]),j=d?.painPoints||[],k=c.filter(a=>a.status===e.y2.Completed).length,{level:l,xpForNextLevel:m}=(a=>{let b=1,c=100,d=100;for(;a>=d;)b++,a-=d,c=d=Math.floor(1.5*d);return{level:b,xpForNextLevel:c}})(b=0+k*i.SESSION_COMPLETED+j.length*i.PAIN_LOG_ENTRY),n=(a=>{let b;if(0===a.length)return 0;let c=[...new Set(a.map(a=>new Date(a.toDateString())).sort((a,b)=>b.getTime()-a.getTime()).map(a=>a.getTime()))].map(a=>new Date(a)),d=new Date(new Date().toDateString()),e=new Date(d);e.setDate(d.getDate()-1);let f=0,g=c[0];if(g.getTime()!==d.getTime()&&g.getTime()!==e.getTime())return 0;f=1,b=g;for(let a=1;a<c.length;a++){let d=c[a];if(!d||!b)break;let e=new Date(b);if(e.setDate(b.getDate()-1),d.getTime()===e.getTime())f++,b=d;else break}return f})([...j.map(a=>new Date(a.date)),...c.filter(a=>a.status===e.y2.Completed).map(a=>a.startTime)]),o=f.XI.map(a=>{let b=!1;switch(a.id){case"streak_7":b=n>=7;break;case"sessions_10":b=k>=10;break;case"pain_log_1":b=j.length>0;break;case"first_week":b=f.$3.treatmentProgress>.25;break;case"level_5":b=l>=5;break;case"perfect_month":b=n>=30}return{...a,unlocked:b}});return{points:b,level:l,xpForNextLevel:m,streak:n,achievements:o}};var k=c(99597);let l=a=>{let[b,c]=(0,d.useState)(null),[e,f]=(0,d.useState)(!0),{showToast:g}=(0,k.dj)(),h=(0,d.useCallback)(async()=>{if(!a)return void f(!1);f(!0);try{let b=await j(a);c(b)}catch(a){console.error("Failed to fetch gamification progress:",a),g("Falha ao carregar seus dados de engajamento.","error")}finally{f(!1)}},[a,g]);return(0,d.useEffect)(()=>{h()},[h]),{progress:b,isLoading:e,refetch:h}}},2547:(a,b,c)=>{c.d(b,{A:()=>f});var d=c(8732);c(82015);var e=c(51302);let f=({achievement:a})=>{let{name:b,description:c,icon:f,unlocked:g}=a;return(0,d.jsxs)("div",{className:`p-4 rounded-xl border-2 flex flex-col items-center text-center transition-all duration-300 ${g?"border-teal-400 bg-teal-50 shadow-md":"border-slate-200 bg-slate-100"}`,children:[(0,d.jsxs)("div",{className:`relative w-20 h-20 rounded-full flex items-center justify-center mb-3 ${g?"bg-teal-100 text-teal-500":"bg-slate-200 text-slate-400"}`,children:[(0,d.jsx)(f,{className:"w-10 h-10"}),!g&&(0,d.jsx)("div",{className:"absolute inset-0 bg-slate-200/60 rounded-full flex items-center justify-center",children:(0,d.jsx)(e.c_I,{className:"w-6 h-6 text-slate-500"})}),g&&(0,d.jsx)("div",{className:"absolute -bottom-1 -right-1 bg-white rounded-full p-0.5",children:(0,d.jsx)(e.rAV,{className:"w-5 h-5 text-green-500 fill-white"})})]}),(0,d.jsx)("h4",{className:`font-bold ${g?"text-teal-800":"text-slate-600"}`,children:b}),(0,d.jsx)("p",{className:`text-xs mt-1 ${g?"text-teal-700":"text-slate-500"}`,children:c})]})}},19119:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{E:()=>h});var e=c(8732),f=c(71253),g=a([f]);function h({className:a,...b}){return(0,e.jsx)("div",{className:(0,f.cn)("animate-pulse rounded-md bg-muted",a),...b})}f=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},24579:(a,b,c)=>{c.d(b,{A:()=>f});var d=c(8732);c(82015);var e=c(51302);let f=({level:a,currentXp:b,xpForNextLevel:c})=>{let f=Math.min(100,b/c*100);return(0,d.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm flex items-center",children:[(0,d.jsx)("div",{className:"bg-teal-100 text-teal-600 p-4 rounded-full mr-4",children:(0,d.jsx)(e.wAm,{className:"w-8 h-8"})}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("div",{className:"flex justify-between items-baseline mb-1",children:[(0,d.jsxs)("h3",{className:"text-lg font-bold text-slate-800",children:["N\xedvel ",a]}),(0,d.jsxs)("p",{className:"text-sm font-medium text-slate-500",children:[b," / ",c," XP"]})]}),(0,d.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-4",children:(0,d.jsx)("div",{className:"bg-teal-500 h-4 rounded-full transition-all duration-500",style:{width:`${f}%`}})}),(0,d.jsxs)("p",{className:"text-xs text-slate-500 text-right mt-1",children:["Faltam ",c-b," XP para o pr\xf3ximo n\xedvel."]})]})]})}},42227:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(8732);c(82015);let e=({title:a,subtitle:b,children:c})=>(0,d.jsxs)("div",{className:"pb-8 md:flex md:items-center md:justify-between",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold leading-tight text-slate-900 tracking-tight",children:a}),(0,d.jsx)("p",{className:"mt-2 text-lg text-slate-600",children:b})]}),(0,d.jsx)("div",{className:"mt-4 flex md:mt-0 md:ml-4",children:c})]})},48840:(a,b,c)=>{c.d(b,{A:()=>f});var d=c(8732);c(82015);var e=c(51302);let f=({streak:a})=>(0,d.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm flex flex-col items-center justify-center text-center",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-slate-800",children:"Sequ\xeancia de Atividades"}),(0,d.jsxs)("div",{className:"my-2 flex items-center text-amber-500",children:[(0,d.jsx)(e.Q5j,{className:"w-12 h-12",strokeWidth:1.5}),(0,d.jsx)("span",{className:"text-6xl font-bold ml-2",children:a})]}),(0,d.jsx)("p",{className:"text-sm text-slate-500",children:a>0?"Dias consecutivos de atividades! Continue assim!":"Fa\xe7a uma atividade hoje para come\xe7ar!"})]})},64446:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>n});var e=c(8732);c(82015);var f=c(42227),g=c(28471),h=c(2408),i=c(19119),j=c(24579),k=c(48840),l=c(2547),m=a([i]);i=(m.then?(await m)():m)[0];let n=()=>{let{user:a}=(0,g.As)(),{progress:b,isLoading:c}=(0,h.$)(a?.patientId||"");if(c||!b)return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(f.A,{title:"Meu Engajamento",subtitle:"Acompanhe seu progresso e conquistas no tratamento."}),(0,e.jsx)(i.E,{className:"h-24 w-full rounded-2xl mb-6"}),(0,e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Array.from({length:6}).map((a,b)=>(0,e.jsx)(i.E,{className:"h-40 rounded-2xl"},b))})]});let{level:d,points:m,xpForNextLevel:n,streak:o,achievements:p}=b;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(f.A,{title:"Meu Engajamento",subtitle:"Sua jornada de recupera\xe7\xe3o gamificada para te manter no caminho certo!"}),(0,e.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[(0,e.jsx)(j.A,{level:d,currentXp:m,xpForNextLevel:n}),(0,e.jsx)(k.A,{streak:o}),(0,e.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm text-center flex flex-col justify-center",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold text-slate-800",children:"Conquistas"}),(0,e.jsxs)("p",{className:"text-4xl font-bold text-teal-500 mt-2",children:[p.filter(a=>a.unlocked).length," / ",p.length]})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:"Galeria de Conquistas"}),(0,e.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:p.map(a=>(0,e.jsx)(l.A,{achievement:a},a.id))})]})]})};d()}catch(a){d(a)}})},71253:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{cn:()=>h});var e=c(50802),f=c(75979),g=a([e,f]);function h(...a){return(0,f.twMerge)((0,e.clsx)(a))}[e,f]=g.then?(await g)():g,d()}catch(a){d(a)}})},99597:(a,b,c)=>{c.d(b,{dj:()=>g}),c(8732);var d=c(82015);c(54822);let e=(0,d.createContext)(void 0),f=(0,d.createContext)(void 0),g=()=>{let a=(()=>{let a=(0,d.useContext)(e);return void 0===a?{enabled:!1,logRouterChange:()=>{},logHookCall:()=>{},logContextAccess:()=>{}}:a})(),b=(0,d.useContext)(f);if(a.logContextAccess("ToastContext","useToast"),!b){let a=Error("useToast must be used within a ToastProvider");throw console.error("‚ùå Toast Context Error:",a.message),a}return{showToast:b.showToast}}}};