"use strict";exports.id=5716,exports.ids=[5716],exports.modules={7548:(a,b,c)=>{c.d(b,{A:()=>f});var d=c(8732);c(82015);var e=c(51302);let f=({title:a,value:b,icon:c,change:f,changeType:g,subtitle:h})=>{let i="increase"===g;return(0,d.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm hover:shadow-lg transition-shadow duration-300",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between",children:[(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("p",{className:"text-sm font-medium text-slate-500 truncate",children:a}),(0,d.jsx)("p",{className:"text-3xl font-bold text-slate-800 mt-1",children:b})]}),(0,d.jsx)("div",{className:"bg-sky-100 text-sky-600 p-3 rounded-full",children:c})]}),(0,d.jsxs)("div",{className:"mt-2 flex items-center text-sm",children:[f&&(0,d.jsxs)("div",{className:`flex items-center font-semibold ${i?"text-green-600":"text-red-600"}`,children:[i?(0,d.jsx)(e.DoI,{className:"w-4 h-4"}):(0,d.jsx)(e.yd$,{className:"w-4 h-4"}),(0,d.jsx)("span",{children:f}),(0,d.jsx)("span",{className:"text-slate-500 font-normal ml-1.5",children:"vs. m\xeas anterior"})]}),!f&&h&&(0,d.jsx)("p",{className:"text-slate-500",children:h})]})]})}},19119:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{E:()=>h});var e=c(8732),f=c(71253),g=a([f]);function h({className:a,...b}){return(0,e.jsx)("div",{className:(0,f.cn)("animate-pulse rounded-md bg-muted",a),...b})}f=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},25716:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>p});var e=c(8732),f=c(82015),g=c(42227),h=c(68491),i=c(28471),j=c(99597),k=c(7548),l=c(51302),m=c(50284),n=c(19119),o=a([n]);n=(o.then?(await o)():o)[0];let p=()=>{let[a,b]=(0,f.useState)(null),[c,d]=(0,f.useState)([]),[o,p]=(0,f.useState)(!0),{user:q}=(0,i.As)(),{showToast:r}=(0,j.dj)();(0,f.useEffect)(()=>{(async()=>{if(q){p(!0);try{let{summary:a,transactions:c}=await h.YI(q.id);b(a),d(c)}catch{r("Erro ao carregar dados financeiros.","error")}finally{p(!1)}}})()},[q,r]);let s=(0,f.useMemo)(()=>{let a=new Map;return c.forEach(b=>{let c=b.createdAt.toLocaleDateString("pt-BR",{month:"short",year:"2-digit"});a.set(c,(a.get(c)||0)+b.breakdown.netAmount)}),Array.from(a.entries()).map(([a,b])=>({name:a,"Receita L\xedquida":b}))},[c]),t=a=>`R$ ${a.toFixed(2).replace(".",",")}`;if(o)return(0,e.jsx)(n.E,{className:"h-[600px] w-full"});if(!a)return(0,e.jsx)("div",{className:"text-center p-10",children:"N\xe3o foi poss\xedvel carregar os dados financeiros."});let u=[{title:"Receita Bruta (M\xeas)",value:t(a.grossRevenue),icon:(0,e.jsx)(l.G9t,{})},{title:"Taxa da Plataforma",value:t(a.platformFee),icon:(0,e.jsx)(l.KqI,{})},{title:"Impostos (Simulado)",value:t(a.taxAmount),icon:(0,e.jsx)(l.ekZ,{})},{title:"Receita L\xedquida (M\xeas)",value:t(a.netRevenue),icon:(0,e.jsx)(l.akl,{})}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.A,{title:"Painel Financeiro",subtitle:"Acompanhe suas receitas e transa\xe7\xf5es da parceria."}),(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map(a=>(0,e.jsx)(k.A,{...a},a.title))}),(0,e.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,e.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Receita L\xedquida Mensal"}),(0,e.jsx)("div",{className:"h-72",children:(0,e.jsx)(m.uf,{width:"100%",height:"100%",children:(0,e.jsxs)(m.Es,{data:s,margin:{top:5,right:20,left:-10,bottom:5},children:[(0,e.jsx)(m.dC,{strokeDasharray:"3 3",vertical:!1}),(0,e.jsx)(m.WX,{dataKey:"name",fontSize:12}),(0,e.jsx)(m.h8,{fontSize:12,tickFormatter:a=>`R$${a/1e3}k`}),(0,e.jsx)(m.m_,{formatter:a=>t(a)}),(0,e.jsx)(m.yP,{dataKey:"Receita L\xedquida",fill:"#14b8a6"})]})})})]}),(0,e.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"\xdaltimas Transa\xe7\xf5es"}),(0,e.jsx)("div",{className:"overflow-y-auto max-h-72",children:(0,e.jsx)("table",{className:"min-w-full",children:(0,e.jsx)("tbody",{className:"divide-y divide-slate-200",children:c.slice(0,10).map(a=>(0,e.jsxs)("tr",{children:[(0,e.jsxs)("td",{className:"p-2",children:[(0,e.jsx)("p",{className:"text-sm font-medium",children:a.patientName}),(0,e.jsx)("p",{className:"text-xs text-slate-500",children:a.planName})]}),(0,e.jsxs)("td",{className:"p-2 text-right",children:[(0,e.jsx)("p",{className:"text-sm font-semibold text-green-600",children:t(a.breakdown.netAmount)}),(0,e.jsx)("p",{className:"text-xs text-slate-500",children:a.createdAt.toLocaleDateString("pt-BR")})]})]},a.id))})})})]})]})]})]})};d()}catch(a){d(a)}})},42227:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(8732);c(82015);let e=({title:a,subtitle:b,children:c})=>(0,d.jsxs)("div",{className:"pb-8 md:flex md:items-center md:justify-between",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold leading-tight text-slate-900 tracking-tight",children:a}),(0,d.jsx)("p",{className:"mt-2 text-lg text-slate-600",children:b})]}),(0,d.jsx)("div",{className:"mt-4 flex md:mt-0 md:ml-4",children:c})]})},68491:(a,b,c)=>{c.d(b,{I0:()=>j,Wz:()=>m,YI:()=>n,eY:()=>l,k5:()=>k});var d=c(72393),e=c(4183);let f="fisioflow_expenses",g=a=>new Promise(b=>setTimeout(b,a)),h=()=>{try{let a=localStorage.getItem(f);if(a)return JSON.parse(a).map(a=>({...a,date:new Date(a.date)}))}catch(a){console.error("Failed to parse expenses from localStorage",a)}return i(e.UI),e.UI},i=a=>{try{localStorage.setItem(f,JSON.stringify(a))}catch(a){console.error("Failed to save expenses to localStorage",a)}},j=async a=>{let b;await g(200);let c=new Date;switch(a){case"this_month":b=new Date(c.getFullYear(),c.getMonth(),1);break;case"last_3_months":b=new Date(c.getFullYear(),c.getMonth()-2,1);break;case"this_year":b=new Date(c.getFullYear(),0,1)}return[...e.ZS.filter(a=>a.status===d.y2.Completed&&new Date(a.startTime)>=b).map(a=>({id:`rev_${a.id}`,type:d.D_.Receita,date:a.startTime,description:`${a.type} - ${a.patientName}`,amount:a.value,category:a.type,patientName:a.patientName,appointmentId:a.id})),...h().filter(a=>new Date(a.date)>=b)].sort((a,b)=>b.date.getTime()-a.date.getTime())},k=async a=>{await g(300);let b=h(),c={...a,id:`exp_${Date.now()}`,type:d.D_.Despesa};return b.unshift(c),i(b),c},l=async a=>{await g(300);let b=h();return i(b=b.map(b=>b.id===a.id?a:b)),a},m=async a=>{await g(300);let b=h();i(b=b.filter(b=>b.id!==a))},n=async a=>{await g(500);let b=e.XM,c=new Date,d=new Date(c.getFullYear(),c.getMonth(),1),f=[];for(let a of b)if(new Date(a.purchaseDate)>=d){let b=e.N.find(b=>b.id===a.patientId);if(b){let c=a.plan.price,d=.15*c,e=.05*c,g=c-d-e;f.push({id:`txn_${a.id}`,type:"voucher_purchase",patientName:b.name,planName:a.plan.name,status:"completed",createdAt:a.purchaseDate,breakdown:{grossAmount:c,platformFee:d,taxAmount:e,netAmount:g}})}}return{summary:f.reduce((a,b)=>(a.grossRevenue+=b.breakdown.grossAmount,a.platformFee+=b.breakdown.platformFee,a.taxAmount+=b.breakdown.taxAmount,a.netRevenue+=b.breakdown.netAmount,a),{grossRevenue:0,platformFee:0,taxAmount:0,netRevenue:0,period:"Este M\xeas"}),transactions:b.map(a=>{let b=e.N.find(b=>b.id===a.patientId),c=a.plan.price,d=.15*c,f=.05*c;return{id:`txn_${a.id}`,type:"voucher_purchase",patientName:b?.name||"Desconhecido",planName:a.plan.name,status:"completed",createdAt:a.purchaseDate,breakdown:{grossAmount:c,platformFee:d,taxAmount:f,netAmount:c-d-f}}}).sort((a,b)=>b.createdAt.getTime()-a.createdAt.getTime())}}},71253:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{cn:()=>h});var e=c(50802),f=c(75979),g=a([e,f]);function h(...a){return(0,f.twMerge)((0,e.clsx)(a))}[e,f]=g.then?(await g)():g,d()}catch(a){d(a)}})},99597:(a,b,c)=>{c.d(b,{dj:()=>g}),c(8732);var d=c(82015);c(54822);let e=(0,d.createContext)(void 0),f=(0,d.createContext)(void 0),g=()=>{let a=(()=>{let a=(0,d.useContext)(e);return void 0===a?{enabled:!1,logRouterChange:()=>{},logHookCall:()=>{},logContextAccess:()=>{}}:a})(),b=(0,d.useContext)(f);if(a.logContextAccess("ToastContext","useToast"),!b){let a=Error("useToast must be used within a ToastProvider");throw console.error("‚ùå Toast Context Error:",a.message),a}return{showToast:b.showToast}}}};