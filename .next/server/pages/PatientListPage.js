"use strict";(()=>{var a={};a.id=3554,a.ids=[3220,3554,4305],a.modules={6439:(a,b,c)=>{c.d(b,{d:()=>e});var d=c(82015);function e(a,b){let[c,e]=(0,d.useState)(a);return c}},8732:a=>{a.exports=require("react/jsx-runtime")},19119:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{E:()=>h});var e=c(8732),f=c(71253),g=a([f]);function h({className:a,...b}){return(0,e.jsx)("div",{className:(0,f.cn)("animate-pulse rounded-md bg-muted",a),...b})}f=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},33873:a=>{a.exports=require("path")},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},42227:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(8732);c(82015);let e=({title:a,subtitle:b,children:c})=>(0,d.jsxs)("div",{className:"pb-8 md:flex md:items-center md:justify-between",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold leading-tight text-slate-900 tracking-tight",children:a}),(0,d.jsx)("p",{className:"mt-2 text-lg text-slate-600",children:b})]}),(0,d.jsx)("div",{className:"mt-4 flex md:mt-0 md:ml-4",children:c})]})},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},50802:a=>{a.exports=import("clsx")},54503:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>s,default:()=>o,getServerSideProps:()=>r,getStaticPaths:()=>q,getStaticProps:()=>p,handler:()=>A,reportWebVitals:()=>t,routeModule:()=>z,unstable_getServerProps:()=>x,unstable_getServerSideProps:()=>y,unstable_getStaticParams:()=>w,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>u});var e=c(63885),f=c(80237),g=c(81413),h=c(3317),i=c.n(h),j=c(76195),k=c.n(j),l=c(74305),m=c(12289),n=a([l]);l=(n.then?(await n)():n)[0];let o=(0,g.M)(l,"default"),p=(0,g.M)(l,"getStaticProps"),q=(0,g.M)(l,"getStaticPaths"),r=(0,g.M)(l,"getServerSideProps"),s=(0,g.M)(l,"config"),t=(0,g.M)(l,"reportWebVitals"),u=(0,g.M)(l,"unstable_getStaticProps"),v=(0,g.M)(l,"unstable_getStaticPaths"),w=(0,g.M)(l,"unstable_getStaticParams"),x=(0,g.M)(l,"unstable_getServerProps"),y=(0,g.M)(l,"unstable_getServerSideProps"),z=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/PatientListPage",pathname:"/PatientListPage",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:k(),Document:i()},userland:l}),A=(0,m.U)({srcPage:"/PatientListPage",config:s,userland:l,routeModule:z,getStaticPaths:q,getStaticProps:p,getServerSideProps:r});d()}catch(a){d(a)}})},54822:a=>{a.exports=require("react-router-dom")},55472:(a,b,c)=>{c.d(b,{w:()=>h});var d=c(82015),e=c(26821),f=c(99597),g=c(40396);let h=()=>{let[a,b]=(0,d.useState)([]),[c,h]=(0,d.useState)(!0),[i,j]=(0,d.useState)(!1),[k,l]=(0,d.useState)(null),[m,n]=(0,d.useState)(!0),[o,p]=(0,d.useState)(null),[q,r]=(0,d.useState)({searchTerm:"",statusFilter:"All",startDate:"",endDate:"",therapistId:"All"}),{showToast:s}=(0,f.dj)(),t=(0,d.useCallback)(async(a,c)=>{c?j(!0):h(!0),p(null);try{let d=await e.L5({...a.searchTerm&&{searchTerm:a.searchTerm},...a.statusFilter&&{statusFilter:a.statusFilter},...a.startDate&&{startDate:a.startDate},...a.endDate&&{endDate:a.endDate},...a.therapistId&&{therapistId:a.therapistId},...null!=c&&{cursor:c},limit:15});b(a=>c?[...a,...d.patients]:d.patients),l(d.nextCursor),n(!!d.nextCursor)}catch(a){p(a),s("Falha ao carregar pacientes.","error")}finally{h(!1),j(!1)}},[s]),u=(0,d.useCallback)(a=>{r(a),t(a,null)},[t]),v=(0,d.useCallback)(()=>{!i&&m&&t(q,k)},[i,m,k,t,q]),w=async a=>{try{await e.dc(a),s("Paciente adicionado com sucesso!","success")}catch(a){s("Falha ao adicionar paciente.","error")}};return(0,d.useEffect)(()=>{let a=()=>{u(q)};return g.g.on("patients:changed",a),()=>{g.g.off("patients:changed",a)}},[q,u]),{patients:a,isLoading:c,isLoadingMore:i,hasMore:m,error:o,fetchInitialPatients:u,fetchMorePatients:v,addPatient:w}}},56472:a=>{a.exports=require("@opentelemetry/api")},66618:(a,b,c)=>{c.d(b,{Kl:()=>g});var d=c(8732);c(82015),c(72393);var e=c(17367),f=c(51302);let g=({allowedRoles:a,children:b,fallback:c})=>{let{user:g}=(0,e.W6)();return g&&a.includes(g.role)?(0,d.jsx)(d.Fragment,{children:b}):c||(0,d.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8",children:(0,d.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md text-center",children:[(0,d.jsx)(f.ExS,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),(0,d.jsx)("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Acesso Negado"}),(0,d.jsx)("p",{className:"text-red-600 mb-4",children:"Voc\xea n\xe3o tem permiss\xe3o para acessar esta p\xe1gina."}),(0,d.jsxs)("div",{className:"text-sm text-red-500",children:[(0,d.jsxs)("p",{children:["Seu perfil: ",(0,d.jsx)("strong",{children:g?.role||"N\xe3o identificado"})]}),(0,d.jsxs)("p",{children:["Perfis permitidos: ",(0,d.jsx)("strong",{children:a.join(", ")})]})]})]})})}},71253:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{cn:()=>h});var e=c(50802),f=c(75979),g=a([e,f]);function h(...a){return(0,f.twMerge)((0,e.clsx)(a))}[e,f]=g.then?(await g)():g,d()}catch(a){d(a)}})},74305:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>s});var e=c(8732),f=c(82015),g=c(51302),h=c(42227),i=c(86211),j=c(43709),k=c(19119),l=c(55472),m=c(6439),n=c(28471),o=c(66618),p=c(72393),q=a([k]);k=(q.then?(await q)():q)[0];let r=({patient:a})=>{let b=(0,i.Z)();return(0,e.jsxs)("div",{onClick:()=>b(`/patients/${a.id}`),className:"flex items-center p-4 bg-white rounded-xl shadow-sm border border-transparent hover:border-sky-400 hover:shadow-md cursor-pointer transition-all duration-200",children:[(0,e.jsx)("img",{className:"h-12 w-12 rounded-full object-cover",src:a.avatarUrl,alt:a.name}),(0,e.jsxs)("div",{className:"ml-4 flex-1",children:[(0,e.jsx)("div",{className:"text-md font-bold text-slate-800",children:a.name}),(0,e.jsx)("div",{className:"text-sm text-slate-500",children:a.email||a.phone})]}),(0,e.jsx)("div",{className:"hidden md:block",children:(0,e.jsx)("span",{className:`px-3 py-1 text-xs leading-5 font-semibold rounded-full ring-1 ring-inset ${{Active:"bg-green-100 text-green-800 ring-green-200",Inactive:"bg-yellow-100 text-yellow-800 ring-yellow-200",Discharged:"bg-slate-100 text-slate-800 ring-slate-200"}[a.status]}`,children:a.status})}),(0,e.jsx)(g.c_$,{className:"w-6 h-6 text-slate-400 ml-4"})]})},s=()=>{let[a,b]=(0,f.useState)(!1),{patients:c,isLoading:d,error:i,fetchInitialPatients:q,fetchMorePatients:s,addPatient:t,hasMore:u,isLoadingMore:v}=(0,l.w)(),{therapists:w}=(0,n.Ez)(),[x,y]=(0,f.useState)(""),[z,A]=(0,f.useState)("All"),[B,C]=(0,f.useState)(""),[D,E]=(0,f.useState)(""),[F,G]=(0,f.useState)("All"),H=(0,m.d)(x,300),I=(0,m.d)(B,500),J=(0,m.d)(D,500);(0,f.useEffect)(()=>{q({searchTerm:H,statusFilter:z,startDate:I,endDate:J,therapistId:F})},[H,z,I,J,F,q]);let K=async a=>{await t(a),b(!1)};return(0,e.jsxs)(o.Kl,{allowedRoles:[p.Xh.Admin,p.Xh.Therapist,p.Xh.EducadorFisico],children:[(0,e.jsx)(h.A,{title:"Gest\xe3o de Pacientes",subtitle:"Adicione, visualize e gerencie as informa\xe7\xf5es dos seus pacientes.",children:(0,e.jsxs)("button",{onClick:()=>b(!0),className:"inline-flex items-center justify-center rounded-lg border border-transparent bg-sky-500 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-sky-600 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2",children:[(0,e.jsx)(g.FWt,{className:"-ml-1 mr-2 h-5 w-5"}),"Novo Paciente"]})}),(0,e.jsx)(j.A,{isOpen:a,onClose:()=>b(!1),onSave:K}),(0,e.jsx)("div",{className:"bg-white p-4 rounded-2xl shadow-sm mb-6",children:(0,e.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4 items-end",children:[(0,e.jsxs)("div",{className:"xl:col-span-2",children:[(0,e.jsx)("label",{className:"text-sm font-medium text-slate-600",children:"Buscar"}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(g.vji,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,e.jsx)("input",{type:"text",placeholder:"Nome ou CPF...",value:x,onChange:a=>y(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500"})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"text-sm font-medium text-slate-600",children:"Status"}),(0,e.jsxs)("select",{value:z,onChange:a=>A(a.target.value),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 bg-white",children:[(0,e.jsx)("option",{value:"All",children:"Todos os Status"}),(0,e.jsx)("option",{value:"Active",children:"Ativo"}),(0,e.jsx)("option",{value:"Inactive",children:"Inativo"}),(0,e.jsx)("option",{value:"Discharged",children:"Alta"})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"text-sm font-medium text-slate-600",children:"Data de Cadastro (De)"}),(0,e.jsx)("input",{type:"date",value:B,onChange:a=>C(a.target.value),className:"w-full p-2 border border-slate-300 rounded-lg"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"text-sm font-medium text-slate-600",children:"Data de Cadastro (At\xe9)"}),(0,e.jsx)("input",{type:"date",value:D,onChange:a=>E(a.target.value),className:"w-full p-2 border border-slate-300 rounded-lg"})]}),(0,e.jsxs)("div",{className:"xl:col-span-2",children:[(0,e.jsx)("label",{className:"text-sm font-medium text-slate-600",children:"Fisioterapeuta"}),(0,e.jsxs)("select",{value:F,onChange:a=>G(a.target.value),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 bg-white",children:[(0,e.jsx)("option",{value:"All",children:"Todos os Fisioterapeutas"}),w.map(a=>(0,e.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,e.jsx)("div",{className:"xl:col-span-6",children:(0,e.jsxs)("button",{onClick:()=>{y(""),A("All"),C(""),E(""),G("All")},className:"text-sm font-semibold text-sky-600 hover:text-sky-800 flex items-center",children:[(0,e.jsx)(g.X,{className:"w-4 h-4 mr-1"})," Limpar Filtros"]})})]})}),(0,e.jsx)("div",{className:"space-y-4",children:d?Array.from({length:5}).map((a,b)=>(0,e.jsx)(k.E,{className:"h-20 w-full rounded-xl"},b)):i?(0,e.jsx)("div",{className:"text-center p-10 text-red-500 col-span-full",children:"Falha ao carregar pacientes."}):0!==c.length||d?c.map(a=>(0,e.jsx)(r,{patient:a},a.id)):(0,e.jsxs)("div",{className:"text-center p-10 text-slate-500 col-span-full",children:[(0,e.jsx)(g.zWC,{className:"mx-auto h-12 w-12 text-slate-300"}),(0,e.jsx)("h3",{className:"mt-2 text-sm font-medium text-slate-900",children:"Nenhum paciente encontrado"}),(0,e.jsx)("p",{className:"mt-1 text-sm text-slate-500",children:"Tente ajustar seus filtros ou adicione um novo paciente."})]})}),(0,e.jsxs)("div",{className:"h-16 flex items-center justify-center",children:[v&&(0,e.jsxs)("div",{className:"flex items-center text-slate-500",children:[(0,e.jsx)(g.krw,{className:"w-5 h-5 mr-2 animate-spin"}),(0,e.jsx)("span",{children:"Carregando mais pacientes..."})]}),u&&!d&&!v&&(0,e.jsx)("button",{onClick:()=>s(),className:"inline-flex items-center justify-center rounded-lg border border-transparent bg-sky-500 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-sky-600 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2",children:"Carregar Mais Pacientes"}),!u&&!d&&c.length>0&&(0,e.jsx)("p",{className:"text-sm text-slate-400",children:"Voc\xea chegou ao fim da lista."})]})]})};d()}catch(a){d(a)}})},75979:a=>{a.exports=import("tailwind-merge")},82015:a=>{a.exports=require("react")},86211:(a,b,c)=>{c.d(b,{Z:()=>e});let d={navigate:a=>{console.log("Navigation requested to:",a);let b=window.__setCurrentPage;if(b&&"function"==typeof b){if(a.startsWith("/patients/")){let c=a.replace("/patients/","");window.__selectedPatientId=c,b("patient-detail")}else if(a.startsWith("/patients"))b("patients");else if(a.startsWith("/atendimento/")||a.startsWith("/teleconsulta/")){let c=a.split("/")[2];window.__selectedAppointmentId=c,b("session")}}}},e=()=>d.navigate},93939:a=>{a.exports=require("@supabase/supabase-js")},99597:(a,b,c)=>{c.d(b,{dj:()=>g}),c(8732);var d=c(82015);c(54822);let e=(0,d.createContext)(void 0),f=(0,d.createContext)(void 0),g=()=>{let a=(()=>{let a=(0,d.useContext)(e);return void 0===a?{enabled:!1,logRouterChange:()=>{},logHookCall:()=>{},logContextAccess:()=>{}}:a})(),b=(0,d.useContext)(f);if(a.logContextAccess("ToastContext","useToast"),!b){let a=Error("useToast must be used within a ToastProvider");throw console.error("âŒ Toast Context Error:",a.message),a}return{showToast:b.showToast}}}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[3317,9871,1302,4183,7367,8471,3709],()=>b(b.s=54503));module.exports=c})();