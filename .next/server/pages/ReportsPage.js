"use strict";(()=>{var a={};a.id=4816,a.ids=[155,3220,4816],a.modules={7548:(a,b,c)=>{c.d(b,{A:()=>f});var d=c(8732);c(82015);var e=c(51302);let f=({title:a,value:b,icon:c,change:f,changeType:g,subtitle:h})=>{let i="increase"===g;return(0,d.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm hover:shadow-lg transition-shadow duration-300",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between",children:[(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("p",{className:"text-sm font-medium text-slate-500 truncate",children:a}),(0,d.jsx)("p",{className:"text-3xl font-bold text-slate-800 mt-1",children:b})]}),(0,d.jsx)("div",{className:"bg-sky-100 text-sky-600 p-3 rounded-full",children:c})]}),(0,d.jsxs)("div",{className:"mt-2 flex items-center text-sm",children:[f&&(0,d.jsxs)("div",{className:`flex items-center font-semibold ${i?"text-green-600":"text-red-600"}`,children:[i?(0,d.jsx)(e.DoI,{className:"w-4 h-4"}):(0,d.jsx)(e.yd$,{className:"w-4 h-4"}),(0,d.jsx)("span",{children:f}),(0,d.jsx)("span",{className:"text-slate-500 font-normal ml-1.5",children:"vs. m\xeas anterior"})]}),!f&&h&&(0,d.jsx)("p",{className:"text-slate-500",children:h})]})]})}},8307:a=>{a.exports=require("es-toolkit")},8732:a=>{a.exports=require("react/jsx-runtime")},12490:a=>{a.exports=require("es-toolkit/compat/isPlainObject")},13261:a=>{a.exports=require("victory-vendor/d3-shape")},16844:a=>{a.exports=require("es-toolkit/compat/minBy")},17150:a=>{a.exports=require("es-toolkit/compat/maxBy")},17889:a=>{a.exports=require("es-toolkit/compat/get")},19643:a=>{a.exports=require("es-toolkit/compat/throttle")},20887:a=>{a.exports=require("es-toolkit/compat/last")},22326:a=>{a.exports=require("react-dom")},22544:a=>{a.exports=require("react-redux")},24584:a=>{a.exports=require("use-sync-external-store/shim/with-selector")},33873:a=>{a.exports=require("path")},34562:a=>{a.exports=require("react-is")},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},42227:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(8732);c(82015);let e=({title:a,subtitle:b,children:c})=>(0,d.jsxs)("div",{className:"pb-8 md:flex md:items-center md:justify-between",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold leading-tight text-slate-900 tracking-tight",children:a}),(0,d.jsx)("p",{className:"mt-2 text-lg text-slate-600",children:b})]}),(0,d.jsx)("div",{className:"mt-4 flex md:mt-0 md:ml-4",children:c})]})},45034:a=>{a.exports=require("es-toolkit/compat/omit")},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},47740:a=>{a.exports=require("@reduxjs/toolkit")},51343:a=>{a.exports=require("eventemitter3")},56472:a=>{a.exports=require("@opentelemetry/api")},57106:a=>{a.exports=require("immer")},62546:a=>{a.exports=require("victory-vendor/d3-scale")},65415:(a,b,c)=>{c.r(b),c.d(b,{config:()=>q,default:()=>m,getServerSideProps:()=>p,getStaticPaths:()=>o,getStaticProps:()=>n,handler:()=>y,reportWebVitals:()=>r,routeModule:()=>x,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>u,unstable_getStaticPaths:()=>t,unstable_getStaticProps:()=>s});var d=c(63885),e=c(80237),f=c(81413),g=c(3317),h=c.n(g),i=c(76195),j=c.n(i),k=c(70155),l=c(12289);let m=(0,f.M)(k,"default"),n=(0,f.M)(k,"getStaticProps"),o=(0,f.M)(k,"getStaticPaths"),p=(0,f.M)(k,"getServerSideProps"),q=(0,f.M)(k,"config"),r=(0,f.M)(k,"reportWebVitals"),s=(0,f.M)(k,"unstable_getStaticProps"),t=(0,f.M)(k,"unstable_getStaticPaths"),u=(0,f.M)(k,"unstable_getStaticParams"),v=(0,f.M)(k,"unstable_getServerProps"),w=(0,f.M)(k,"unstable_getServerSideProps"),x=new d.PagesRouteModule({definition:{kind:e.RouteKind.PAGES,page:"/ReportsPage",pathname:"/ReportsPage",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:j(),Document:h()},userland:k}),y=(0,l.U)({srcPage:"/ReportsPage",config:q,userland:k,routeModule:x,getStaticPaths:o,getStaticProps:n,getServerSideProps:p})},70109:a=>{a.exports=require("reselect")},70155:(a,b,c)=>{c.r(b),c.d(b,{default:()=>r});var d=c(8732),e=c(82015),f=c(51302),g=c(42227),h=c(7976),i=c(50284),j=c(7548);let k=({appointments:a,therapists:b})=>{let c=(0,e.useMemo)(()=>{let b=a.filter(a=>"Realizado"===a.status),c=b.reduce((a,b)=>a+b.value,0),d=b.length>0?c/b.length:0,e=a.filter(a=>"Cancelado"!==a.status&&"pending"===a.paymentStatus).reduce((a,b)=>a+b.value,0);return{totalRevenue:c,avgTicket:d,completedCount:b.length,accountsReceivable:e}},[a]),g=(0,e.useMemo)(()=>{let b=new Map,c=new Date,d=new Date(new Date().setDate(c.getDate()-30));return a.filter(a=>"Realizado"===a.status&&a.startTime>=d).forEach(a=>{let c=a.startTime.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"});b.set(c,(b.get(c)||0)+a.value)}),Array.from(b.entries()).map(([a,b])=>({name:a,Faturamento:b})).sort((a,b)=>new Date(a.name.split("/").reverse().join("-")).getTime()-new Date(b.name.split("/").reverse().join("-")).getTime())},[a]),h=(0,e.useMemo)(()=>{let c=new Map;return b.forEach(a=>c.set(a.id,{name:a.name,Faturamento:0,color:a.color})),a.filter(a=>"Realizado"===a.status).forEach(a=>{if(c.has(a.therapistId)){let b=c.get(a.therapistId);b.Faturamento+=a.value}}),Array.from(c.values())},[a,b]),k=a=>`R$ ${a.toFixed(2).replace(".",",")}`,l=[{title:"Faturamento Total",value:k(c.totalRevenue),icon:(0,d.jsx)(f.G9t,{})},{title:"Ticket M\xe9dio",value:k(c.avgTicket),icon:(0,d.jsx)(f.akl,{})},{title:"Consultas Realizadas",value:c.completedCount.toString(),icon:(0,d.jsx)(f.rAV,{})},{title:"Contas a Receber",value:k(c.accountsReceivable),icon:(0,d.jsx)(f.zD7,{})}];return(0,d.jsxs)("div",{className:"space-y-6 animate-fade-in-fast",children:[(0,d.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:l.map(a=>(0,d.jsx)(j.A,{...a},a.title))}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[(0,d.jsxs)("div",{className:"lg:col-span-3 bg-white p-6 rounded-2xl shadow-sm",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Faturamento (\xdaltimos 30 dias)"}),(0,d.jsx)("div",{className:"h-72",children:(0,d.jsx)(i.uf,{width:"100%",height:"100%",children:(0,d.jsxs)(i.bl,{data:g,margin:{top:5,right:20,left:-10,bottom:5},children:[(0,d.jsx)(i.dC,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,d.jsx)(i.WX,{dataKey:"name",stroke:"#64748b",fontSize:12}),(0,d.jsx)(i.h8,{stroke:"#64748b",fontSize:12,tickFormatter:a=>k(a)}),(0,d.jsx)(i.m_,{formatter:a=>[k(a),"Faturamento"]}),(0,d.jsx)(i.N1,{type:"monotone",dataKey:"Faturamento",stroke:"#14b8a6",strokeWidth:2})]})})})]}),(0,d.jsxs)("div",{className:"lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Faturamento por Fisioterapeuta"}),(0,d.jsx)("div",{className:"h-72",children:(0,d.jsx)(i.uf,{width:"100%",height:"100%",children:(0,d.jsxs)(i.Es,{data:h,layout:"vertical",margin:{left:20},children:[(0,d.jsx)(i.dC,{strokeDasharray:"3 3",horizontal:!1,stroke:"#e2e8f0"}),(0,d.jsx)(i.WX,{type:"number",stroke:"#64748b",fontSize:12,tickFormatter:a=>`R$${a/1e3}k`}),(0,d.jsx)(i.h8,{type:"category",dataKey:"name",stroke:"#64748b",fontSize:12,width:80,axisLine:!1,tickLine:!1}),(0,d.jsx)(i.m_,{formatter:a=>k(a)}),(0,d.jsx)(i.yP,{dataKey:"Faturamento",barSize:20,children:h.map(a=>(0,d.jsx)(i.fh,{fill:`#${{teal:"14b8a6",sky:"38bdf8",indigo:"6366f1"}[a.color]||"64748b"}`},a.name))})]})})})]})]}),(0,d.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"\xdaltimas Transa\xe7\xf5es"}),(0,d.jsx)("div",{className:"overflow-x-auto",children:(0,d.jsxs)("table",{className:"min-w-full",children:[(0,d.jsx)("thead",{className:"bg-slate-50",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-3 text-left text-xs font-medium text-slate-500 uppercase",children:"Paciente"}),(0,d.jsx)("th",{className:"p-3 text-left text-xs font-medium text-slate-500 uppercase",children:"Data"}),(0,d.jsx)("th",{className:"p-3 text-left text-xs font-medium text-slate-500 uppercase",children:"Tipo"}),(0,d.jsx)("th",{className:"p-3 text-right text-xs font-medium text-slate-500 uppercase",children:"Valor"}),(0,d.jsx)("th",{className:"p-3 text-center text-xs font-medium text-slate-500 uppercase",children:"Status Pag."})]})}),(0,d.jsx)("tbody",{className:"divide-y divide-slate-200",children:a.filter(a=>"Realizado"===a.status).slice(0,10).map(a=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"p-3 text-sm font-medium text-slate-800",children:a.patientName}),(0,d.jsx)("td",{className:"p-3 text-sm text-slate-500",children:a.startTime.toLocaleDateString("pt-BR")}),(0,d.jsx)("td",{className:"p-3 text-sm text-slate-500",children:a.type}),(0,d.jsx)("td",{className:"p-3 text-sm text-slate-800 font-semibold text-right",children:k(a.value)}),(0,d.jsx)("td",{className:"p-3 text-center",children:(0,d.jsx)("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${"paid"===a.paymentStatus?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:"paid"===a.paymentStatus?"Pago":"Pendente"})})]},a.id))})]})})]}),(0,d.jsx)("style",{children:".animate-fade-in-fast { animation: fade-in-fast 0.5s ease-out forwards; } @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }"})]})},l={Active:"#10b981",Inactive:"#f59e0b",Discharged:"#64748b"},m=({patients:a})=>{let b=(0,e.useMemo)(()=>{let b={Active:0,Inactive:0,Discharged:0},c=a.filter(a=>new Date(a.registrationDate)>=new Date(new Date().setDate(1))).length;return a.forEach(a=>{Object.prototype.hasOwnProperty.call(b,a.status)&&b[a.status]++}),{total:a.length,newThisMonth:c,...b}},[a]),c=(0,e.useMemo)(()=>{let b=new Map,c=new Date;c.setMonth(c.getMonth()-5),c.setDate(1);for(let a=0;a<6;a++){let d=new Date(c);d.setMonth(d.getMonth()+a);let e=d.toLocaleDateString("pt-BR",{month:"short",year:"2-digit"});b.set(e,0)}return a.forEach(a=>{let d=new Date(a.registrationDate);if(d>=c){let a=d.toLocaleDateString("pt-BR",{month:"short",year:"2-digit"});b.has(a)&&b.set(a,b.get(a)+1)}}),Array.from(b.entries()).map(([a,b])=>({name:a,"Novos Pacientes":b}))},[a]),g=Object.entries(b).filter(([a])=>["Active","Inactive","Discharged"].includes(a)).map(([a,b])=>({name:a,value:b})),h=[{title:"Total de Pacientes",value:b.total.toString(),icon:(0,d.jsx)(f.zWC,{})},{title:"Pacientes Ativos",value:b.Active.toString(),icon:(0,d.jsx)(f.MWd,{})},{title:"Novos no M\xeas",value:b.newThisMonth.toString(),icon:(0,d.jsx)(f.ypN,{})},{title:"Inativos/Alta",value:(b.Inactive+b.Discharged).toString(),icon:(0,d.jsx)(f.sut,{})}];return(0,d.jsxs)("div",{className:"space-y-6 animate-fade-in-fast",children:[(0,d.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:h.map(a=>(0,d.jsx)(j.A,{...a},a.title))}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[(0,d.jsxs)("div",{className:"lg:col-span-3 bg-white p-6 rounded-2xl shadow-sm",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Novos Pacientes (\xdaltimos 6 meses)"}),(0,d.jsx)("div",{className:"h-72",children:(0,d.jsx)(i.uf,{width:"100%",height:"100%",children:(0,d.jsxs)(i.Es,{data:c,margin:{top:5,right:20,left:-10,bottom:5},children:[(0,d.jsx)(i.dC,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),(0,d.jsx)(i.WX,{dataKey:"name",stroke:"#64748b",fontSize:12}),(0,d.jsx)(i.h8,{stroke:"#64748b",fontSize:12,allowDecimals:!1}),(0,d.jsx)(i.m_,{}),(0,d.jsx)(i.yP,{dataKey:"Novos Pacientes",fill:"#14b8a6"})]})})})]}),(0,d.jsxs)("div",{className:"lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Distribui\xe7\xe3o por Status"}),(0,d.jsx)("div",{className:"h-72",children:(0,d.jsx)(i.uf,{width:"100%",height:"100%",children:(0,d.jsxs)(i.rW,{children:[(0,d.jsx)(i.Fq,{data:g,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:g.map((a,b)=>(0,d.jsx)(i.fh,{fill:l[a.name]},`cell-${b}`))}),(0,d.jsx)(i.m_,{formatter:(a,b)=>[a,b]})]})})})]})]}),(0,d.jsx)("style",{children:".animate-fade-in-fast { animation: fade-in-fast 0.5s ease-out forwards; } @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }"})]})},n=({title:a})=>(0,d.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-sm text-center animate-fade-in-fast",children:[(0,d.jsx)(f.VH9,{className:"mx-auto h-16 w-16 text-slate-300"}),(0,d.jsx)("h3",{className:"mt-4 text-xl font-bold text-slate-800",children:a}),(0,d.jsx)("p",{className:"mt-2 text-md text-slate-500 max-w-2xl mx-auto",children:"Este relat\xf3rio est\xe1 em desenvolvimento e estar\xe1 dispon\xedvel em breve para fornecer mais insights sobre sua cl\xednica."})]});var o=c(28471),p=c(737),q=c(26821);let r=()=>{let[a,b]=(0,e.useState)("financeiro"),{therapists:c,isLoading:i,error:j}=(0,o.Ez)(),[l,r]=(0,e.useState)([]),[s,t]=(0,e.useState)([]),[u,v]=(0,e.useState)(!0),[w,x]=(0,e.useState)(null);(0,e.useEffect)(()=>{(async()=>{v(!0);try{let[a,b]=await Promise.all([p.Xj(),q.uE()]);t(a),r(b),x(null)}catch(a){console.error("Failed to fetch report data:",a),x("Falha ao carregar dados para os relat\xf3rios.")}finally{v(!1)}})()},[]);let y=[{id:"financeiro",name:"Financeiro",icon:f.G9t},{id:"pacientes",name:"Pacientes",icon:f.zWC},{id:"clinico",name:"Cl\xednico",icon:f.Ilq},{id:"equipe",name:"Equipe",icon:f.MWd},{id:"lgpd",name:"LGPD",icon:f.oxo}];return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.A,{title:"Central de Relat\xf3rios",subtitle:"Transforme dados em decis\xf5es. Insights para otimizar sua cl\xednica."}),(0,d.jsx)("div",{className:"mb-6",children:(0,d.jsx)("div",{className:"border-b border-slate-200",children:(0,d.jsx)("nav",{className:"-mb-px flex space-x-6 overflow-x-auto","aria-label":"Tabs",children:y.map(c=>(0,d.jsxs)("button",{onClick:()=>b(c.id),className:`
                                    whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center
                                    ${a===c.id?"border-sky-500 text-sky-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}
                                `,children:[(0,d.jsx)(c.icon,{className:"mr-2 h-5 w-5"}),c.name]},c.id))})})}),(0,d.jsx)("div",{children:(()=>{let b=j?.message||w;if(i||u)return(0,d.jsx)(h.A,{});if(b)return(0,d.jsx)("div",{className:"text-center p-10 text-red-500",children:b});switch(a){case"financeiro":return(0,d.jsx)(k,{appointments:s,therapists:c});case"pacientes":return(0,d.jsx)(m,{patients:l});case"clinico":return(0,d.jsx)(n,{title:"Relat\xf3rios Cl\xednicos"});case"equipe":return(0,d.jsx)(n,{title:"Relat\xf3rios de Equipe"});case"lgpd":return(0,d.jsx)(n,{title:"Relat\xf3rios de Conformidade LGPD"});default:return null}})()})]})}},74956:a=>{a.exports=require("clsx")},75965:a=>{a.exports=require("decimal.js-light")},79291:a=>{a.exports=require("es-toolkit/compat/sumBy")},82015:a=>{a.exports=require("react")},83428:a=>{a.exports=require("es-toolkit/compat/range")},85923:a=>{a.exports=require("es-toolkit/compat/uniqBy")},90742:a=>{a.exports=require("es-toolkit/compat/sortBy")},91651:a=>{a.exports=require("tiny-invariant")},93939:a=>{a.exports=require("@supabase/supabase-js")}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[3317,9871,1302,284,4183,7367,8471],()=>b(b.s=65415));module.exports=c})();