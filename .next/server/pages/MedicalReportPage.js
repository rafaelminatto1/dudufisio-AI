"use strict";(()=>{var a={};a.id=62,a.ids=[62,3220],a.modules={7976:(a,b,c)=>{c.d(b,{A:()=>f});var d=c(8732);c(82015);var e=c(51302);let f=()=>(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-slate-50",children:[(0,d.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,d.jsx)(e.oYO,{className:"w-16 h-16 text-teal-500 animate-pulse"}),(0,d.jsx)("div",{className:"absolute w-24 h-24 border-t-2 border-b-2 border-teal-200 rounded-full animate-spin"})]}),(0,d.jsx)("p",{className:"mt-4 text-lg font-semibold text-slate-600",children:"Carregando FisioFlow..."})]})},8732:a=>{a.exports=require("react/jsx-runtime")},24249:(a,b,c)=>{c.r(b),c.d(b,{config:()=>C,default:()=>y,getServerSideProps:()=>B,getStaticPaths:()=>A,getStaticProps:()=>z,handler:()=>K,reportWebVitals:()=>D,routeModule:()=>J,unstable_getServerProps:()=>H,unstable_getServerSideProps:()=>I,unstable_getStaticParams:()=>G,unstable_getStaticPaths:()=>F,unstable_getStaticProps:()=>E});var d={};c.r(d),c.d(d,{default:()=>w});var e=c(63885),f=c(80237),g=c(81413),h=c(3317),i=c.n(h),j=c(76195),k=c.n(j),l=c(8732),m=c(82015),n=c(54822),o=c(26821),p=c(65600),q=c(42227),r=c(7976),s=c(50158),t=c(44396),u=c(99597),v=c(51302);let w=()=>{let{patientId:a,reportId:b}=n.useParams(),c=n.useNavigate(),{showToast:d}=(0,u.dj)(),[e,f]=(0,m.useState)(null),[g,h]=(0,m.useState)(null),[i,j]=(0,m.useState)(""),[k,w]=(0,m.useState)(""),[x,y]=(0,m.useState)(""),[z,A]=(0,m.useState)(!0),[B,C]=(0,m.useState)(!1),[D,E]=(0,m.useState)(!1),F=(0,m.useCallback)(async()=>{A(!0);try{if(b){let a=await p.vN(Number(b));if(!a)throw Error("Relat\xf3rio n\xe3o encontrado.");let c=await o.mQ(a.patientId);if(!c)throw Error("Paciente n\xe3o encontrado.");h(a),f(c),j(a.content),w(a.recipientDoctor||""),y(a.recipientCrm||"")}else if(a){let b=await o.mQ(a);if(!b)throw Error("Paciente n\xe3o encontrado.");f(b)}else throw Error("ID de paciente ou relat\xf3rio n\xe3o fornecido.")}catch(a){d(a.message,"error"),c("/patients")}finally{A(!1)}},[b,a,c,d]);(0,m.useEffect)(()=>{F()},[F]);let G=async()=>{if(!a||!k.trim()||!x.trim())return void d("Por favor, informe o m\xe9dico e CRM de destino.","error");C(!0);try{let b=await p.oh(a,k,x);h(b),j(b.content),d("Relat\xf3rio gerado com sucesso!","success"),c(`/medical-report/edit/${b.id}`,{replace:!0})}catch(a){d("Falha ao gerar relat\xf3rio com IA.","error")}finally{C(!1)}},H=async(a=!1)=>{if(g){E(!0);try{let b={content:i,recipientDoctor:k,recipientCrm:x,status:a?"finalized":"draft",finalizedAt:a?new Date:g.finalizedAt};await p.A0(g.id,b),d(a?"Relat\xf3rio finalizado!":"Rascunho salvo!","success"),a?(d("Gerando PDF... (funcionalidade simulada)","info"),c(`/patients/${g.patientId}`)):await F()}catch(a){d("Falha ao salvar relat\xf3rio.","error")}finally{E(!1)}}};if(z)return(0,l.jsx)(r.A,{});if(!e)return null;let I=g?g.title:`Novo Relat\xf3rio para ${e.name}`,J=g?`/patients/${g.patientId}`:`/patients/${a}`;return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)(q.A,{title:I,subtitle:`Gera\xe7\xe3o de relat\xf3rio m\xe9dico com assistente de IA.`,children:(0,l.jsxs)(n.Link,{to:J,className:"inline-flex items-center rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50",children:[(0,l.jsx)(v.JGc,{className:"-ml-1 mr-2 h-5 w-5"})," Voltar"]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 items-start",children:[(0,l.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,l.jsx)(s.A,{title:"Informa\xe7\xf5es do Relat\xf3rio",icon:(0,l.jsx)(v.KJW,{}),children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700",children:"Paciente"}),(0,l.jsx)("p",{className:"font-semibold",children:e.name})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700",children:"M\xe9dico Destinat\xe1rio*"}),(0,l.jsx)("input",{type:"text",value:k,onChange:a=>w(a.target.value),className:"mt-1 w-full p-2 border border-slate-300 rounded-lg"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700",children:"CRM do Destinat\xe1rio*"}),(0,l.jsx)("input",{type:"text",value:x,onChange:a=>y(a.target.value),className:"mt-1 w-full p-2 border border-slate-300 rounded-lg"})]})]})}),!g&&(0,l.jsxs)("button",{onClick:G,disabled:B,className:"w-full inline-flex items-center justify-center bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-4 rounded-lg shadow-sm transition-colors disabled:bg-teal-300",children:[B?(0,l.jsx)(v.aHM,{className:"w-5 h-5 mr-2 animate-spin"}):(0,l.jsx)(v.sUz,{className:"w-5 h-5 mr-2"}),B?"Gerando...":"Gerar Relat\xf3rio com IA"]}),g&&(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("button",{onClick:()=>H(!1),disabled:D||"finalized"===g.status,className:"w-full inline-flex items-center justify-center bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-lg shadow-sm transition-colors disabled:bg-sky-300 disabled:cursor-not-allowed",children:[D?(0,l.jsx)(v.aHM,{className:"w-5 h-5 mr-2 animate-spin"}):(0,l.jsx)(v.eMP,{className:"w-5 h-5 mr-2"}),"Salvar Rascunho"]}),(0,l.jsxs)("button",{onClick:()=>H(!0),disabled:D||"finalized"===g.status,className:"w-full inline-flex items-center justify-center bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg shadow-sm transition-colors disabled:bg-green-300 disabled:cursor-not-allowed",children:[(0,l.jsx)(v.Ttw,{className:"w-5 h-5 mr-2"}),"finalized"===g.status?"Relat\xf3rio Finalizado":"Finalizar e Gerar PDF"]})]})]}),(0,l.jsx)("div",{className:"lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm min-h-[600px] flex flex-col",children:B?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,l.jsx)(v.aHM,{className:"w-12 h-12 text-teal-500 animate-spin"}),(0,l.jsx)("p",{className:"mt-4 text-slate-600",children:"A IA est\xe1 analisando os dados do paciente e gerando o relat\xf3rio..."})]}):g?(0,l.jsx)(t.A,{value:i,onChange:j,rows:25}):(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center text-slate-500",children:[(0,l.jsx)(v.iUU,{className:"w-16 h-16 text-slate-300 mb-4"}),(0,l.jsx)("p",{className:"font-semibold",children:"O relat\xf3rio gerado pela IA aparecer\xe1 aqui."}),(0,l.jsx)("p",{className:"text-sm mt-1",children:'Preencha os dados do destinat\xe1rio e clique em "Gerar Relat\xf3rio com IA".'})]})})]})]})};var x=c(12289);let y=(0,g.M)(d,"default"),z=(0,g.M)(d,"getStaticProps"),A=(0,g.M)(d,"getStaticPaths"),B=(0,g.M)(d,"getServerSideProps"),C=(0,g.M)(d,"config"),D=(0,g.M)(d,"reportWebVitals"),E=(0,g.M)(d,"unstable_getStaticProps"),F=(0,g.M)(d,"unstable_getStaticPaths"),G=(0,g.M)(d,"unstable_getStaticParams"),H=(0,g.M)(d,"unstable_getServerProps"),I=(0,g.M)(d,"unstable_getServerSideProps"),J=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/MedicalReportPage",pathname:"/MedicalReportPage",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:k(),Document:i()},userland:d}),K=(0,x.U)({srcPage:"/MedicalReportPage",config:C,userland:d,routeModule:J,getStaticPaths:A,getStaticProps:z,getServerSideProps:B})},26821:(a,b,c)=>{c.d(b,{L5:()=>k,OS:()=>j,Ob:()=>p,TC:()=>q,Xl:()=>o,Z6:()=>n,bW:()=>i,dc:()=>m,mQ:()=>l,uE:()=>h});var d=c(72393),e=c(92273),f=c(40396);let g=a=>new Promise(b=>setTimeout(b,a)),h=async()=>(await g(500),[...e.db.getPatients()].sort((a,b)=>new Date(b.lastVisit).getTime()-new Date(a.lastVisit).getTime())),i=async a=>{if(await g(300),a.length<2)return[];let b=a.toLowerCase();return e.db.getPatients().filter(a=>a.name.toLowerCase().includes(b)||a.cpf.includes(b)).map(a=>({id:a.id,name:a.name,email:a.email,phone:a.phone,status:a.status,lastVisit:a.lastVisit,avatarUrl:a.avatarUrl,cpf:a.cpf})).slice(0,10)},j=async a=>{await g(500);let b={id:`patient_${Date.now()}`,name:a.trim(),cpf:`TEMP-${Date.now()}`,birthDate:"",phone:"",email:"",emergencyContact:{name:"",phone:""},address:{street:"",city:"",state:"",zip:""},status:d.WW.Active,lastVisit:new Date().toISOString(),registrationDate:new Date().toISOString(),avatarUrl:`https://picsum.photos/seed/${Date.now()}/200/200`,consentGiven:!0,whatsappConsent:"opt-out"};return e.db.addPatient(b),f.g.emit("patients:changed"),b},k=async({limit:a=15,cursor:b,searchTerm:c,statusFilter:d,startDate:f,endDate:h,therapistId:i})=>{await g(500);let j=e.db.getPatients();if(c){let a=c.toLowerCase();j=j.filter(b=>b.name.toLowerCase().includes(a)||b.cpf.includes(a))}if(d&&"All"!==d){let a={Active:"Active",Inactive:"Inactive",Discharged:"Discharged",Ativo:"Active",Inativo:"Inactive",Alta:"Discharged"}[d]||d;j=j.filter(b=>b.status===a)}if(f){let a=new Date(f);a.setHours(0,0,0,0),j=j.filter(b=>new Date(b.registrationDate)>=a)}if(h){let a=new Date(h);a.setHours(23,59,59,999),j=j.filter(b=>new Date(b.registrationDate)<=a)}if(i&&"All"!==i){let a=new Set(e.db.getAppointments().filter(a=>a.therapistId===i).map(a=>a.patientId));j=j.filter(b=>a.has(b.id))}j.sort((a,b)=>{let c=new Date(a.registrationDate).getTime(),d=new Date(b.registrationDate).getTime();return d!==c?d-c:a.id.localeCompare(b.id)});let k=b?j.findIndex(a=>a.id===b)+1:0;if(b&&0===k)return{patients:[],nextCursor:null};let l=j.slice(k,k+a),m=l.length===a&&l.length>0?l[l.length-1].id:null;return{patients:l.map(a=>({id:a.id,name:a.name,email:a.email,phone:a.phone,status:a.status,lastVisit:a.lastVisit,avatarUrl:a.avatarUrl,medicalAlerts:a.medicalAlerts})),nextCursor:m}},l=async a=>(await g(300),e.db.getPatientById(a)),m=async a=>{await g(400);let b={id:`patient_${Date.now()}`,...a,lastVisit:new Date().toISOString()};return e.db.addPatient(b),f.g.emit("patients:changed"),b},n=async a=>(await g(400),e.db.updatePatient(a),f.g.emit("patients:changed"),a),o=async(a,b)=>{await g(600);let c=e.db.getPatientById(a);if(!c)throw Error("Paciente n\xe3o encontrado.");let d={name:b.name,url:"#",type:b.type,size:b.size},h={...c,attachments:[...c.attachments||[],d]};return e.db.updatePatient(h),f.g.emit("patients:changed"),d},p=async(a,b)=>{await g(200);let c=e.db.getPatientById(a);if(!c)throw Error("Paciente n\xe3o encontrado.");let d={id:`log_${Date.now()}`,...b},h={...c,communicationLogs:[d,...c.communicationLogs||[]]};return e.db.updatePatient(h),f.g.emit("patients:changed"),h},q=async(a,b)=>{await g(200);let c=e.db.getPatientById(a);if(!c)throw Error("Paciente n\xe3o encontrado.");let d={...c,painPoints:b};return e.db.updatePatient(d),f.g.emit("patients:changed"),d}},33873:a=>{a.exports=require("path")},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},40396:(a,b,c)=>{c.d(b,{g:()=>h});var d=c(72393),e=c(4183);let f=a=>new Promise(b=>setTimeout(b,a));class g{on(a,b){this.events[a]||(this.events[a]=[]),this.events[a].push(b)}off(a,b){this.events[a]&&(this.events[a]=this.events[a].filter(a=>a!==b))}emit(a,...b){this.events[a]&&this.events[a].forEach(a=>a(...b))}async getEvents(){return await f(300),[...this.eventsData].sort((a,b)=>b.startDate.getTime()-a.startDate.getTime())}async getEventById(a){await f(200);let b=this.eventsData.find(b=>b.id===a);return b?JSON.parse(JSON.stringify(b)):void 0}async getRegistrationsByEventId(a){return await f(200),this.registrationsData.filter(b=>b.eventId===a)}async saveEvent(a,b){if(await f(400),a.id){let b=this.eventsData.findIndex(b=>b.id===a.id);if(b>-1){let c=this.eventsData[b];if(!c)throw Error("Event not found");let d={...c,...a,id:c.id,registrations:c.registrations,providers:c.providers};return this.eventsData[b]=d,this.emit("events:changed"),d}throw Error("Event not found")}{let c={...a,id:`event_${Date.now()}`,registrations:[],providers:[],organizerId:b};return this.eventsData.unshift(c),this.emit("events:changed"),c}}async checkInParticipant(a,b,c){await f(500);let e=this.registrationsData.findIndex(b=>b.id===a);if(-1===e)throw Error("Inscri\xe7\xe3o n\xe3o encontrada.");let g=this.registrationsData[e];if(!g)throw Error("Inscri\xe7\xe3o n\xe3o encontrada.");if(g.status===d.m7.Attended)throw Error("Participante j\xe1 fez check-in.");let h={...g,status:d.m7.Attended,checkedInAt:new Date,checkedInBy:c};this.registrationsData[e]=h;let i=this.eventsData.findIndex(a=>a.id===g.eventId);if(i>-1){let b=this.eventsData[i];if(b){let c=b.registrations.findIndex(b=>b.id===a);c>-1?b.registrations[c]=h:b.registrations.push(h)}}return this.emit("events:changed"),h}async confirmProvider(a){for(let b of(await f(500),this.eventsData)){let c=b.providers.findIndex(b=>b.id===a);if(c>-1){let a=b.providers[c];if(a){if(a.status!==d.aJ.Applied)throw Error("Apenas inscri\xe7\xf5es com status 'Inscrito' podem ser confirmadas.");return a.status=d.aJ.Confirmed,this.emit("events:changed"),a}}}throw Error("Prestador de servi\xe7o n\xe3o encontrado.")}async payProvider(a){for(let b of(await f(500),this.eventsData)){let c=b.providers.findIndex(b=>b.id===a);if(c>-1){let a=b.providers[c];if(a){if(a.status!==d.aJ.Confirmed)throw Error("Apenas prestadores confirmados podem receber pagamento.");return a.status=d.aJ.Paid,this.emit("events:changed"),a}}}throw Error("Prestador de servi\xe7o n\xe3o encontrado.")}constructor(){this.events={},this.eventsData=[...e._X],this.registrationsData=[...e.ZM]}}let h=new g},41906:a=>{a.exports=require("html2pdf.js")},42227:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(8732);c(82015);let e=({title:a,subtitle:b,children:c})=>(0,d.jsxs)("div",{className:"pb-8 md:flex md:items-center md:justify-between",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold leading-tight text-slate-900 tracking-tight",children:a}),(0,d.jsx)("p",{className:"mt-2 text-lg text-slate-600",children:b})]}),(0,d.jsx)("div",{className:"mt-4 flex md:mt-0 md:ml-4",children:c})]})},44396:(a,b,c)=>{c.d(b,{A:()=>g});var d=c(8732),e=c(82015),f=c(51302);let g=({value:a,onChange:b,rows:c=3,placeholder:g,disabled:h=!1})=>{let i=(0,e.useRef)(null),j=c=>{let d=i.current;if(!d||h)return;let e="",f=d.selectionStart,g=d.selectionEnd,j=a.substring(f,g),k="";if("list"===c){let b=a.lastIndexOf("\n",f-1)+1,c=a.substring(0,b),d=a.substring(b,g),e=a.substring(g),h=d.split("\n"),i=h.every(a=>a.trim().startsWith("* ")),j=h.map(a=>i?a.replace(/^\s*\*\s?/,""):a.trim()?`* ${a}`:a).join("\n");k=`${c}${j}${e}`}else{e="bold"===c?"**":"*";let b=`${e}${j}${e}`;k=`${a.substring(0,f)}${b}${a.substring(g)}`}b(k),setTimeout(()=>{d.focus(),"list"!==c&&(d.selectionStart=f+e.length,d.selectionEnd=g+e.length)},0)};return(0,d.jsxs)("div",{className:"flex flex-col h-full",children:[(0,d.jsxs)("div",{className:`flex items-center gap-2 border border-b-0 border-slate-300 p-2 rounded-t-lg ${h?"bg-slate-200":"bg-slate-50"}`,children:[(0,d.jsx)("button",{type:"button",onClick:()=>j("bold"),className:"p-1.5 rounded hover:bg-slate-200 disabled:opacity-50",title:"Negrito (Ctrl+B)",disabled:h,children:(0,d.jsx)(f.yN4,{className:"w-4 h-4"})}),(0,d.jsx)("button",{type:"button",onClick:()=>j("italic"),className:"p-1.5 rounded hover:bg-slate-200 disabled:opacity-50",title:"It\xe1lico (Ctrl+I)",disabled:h,children:(0,d.jsx)(f.J20,{className:"w-4 h-4"})}),(0,d.jsx)("button",{type:"button",onClick:()=>j("list"),className:"p-1.5 rounded hover:bg-slate-200 disabled:opacity-50",title:"Lista",disabled:h,children:(0,d.jsx)(f.B8B,{className:"w-4 h-4"})})]}),(0,d.jsx)("textarea",{ref:i,value:a,onChange:a=>b(a.target.value),rows:c,placeholder:g,className:`w-full p-2 border border-slate-300 rounded-b-lg focus:outline-none focus:ring-1 focus:ring-sky-500 text-sm flex-1 ${h?"bg-slate-100 cursor-not-allowed":""}`,"aria-label":"Editor de Texto do Relat\xf3rio",disabled:h})]})}},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},50158:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(8732);c(82015);let e=({title:a,icon:b,children:c,actionButton:e})=>(0,d.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm h-full flex flex-col border border-slate-200/80",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,d.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 flex items-center",children:[b&&(0,d.jsx)("span",{className:"mr-3 text-sky-500",children:b}),a]}),e]}),(0,d.jsx)("div",{className:"flex-grow",children:c})]})},54822:a=>{a.exports=require("react-router-dom")},56472:a=>{a.exports=require("@opentelemetry/api")},65600:(a,b,c)=>{c.d(b,{A0:()=>k,Mp:()=>n,Ns:()=>m,bb:()=>i,oh:()=>l,vN:()=>j});var d=c(4183),e=c(41906),f=c.n(e);let g=[...d.ps],h=a=>new Promise(b=>setTimeout(b,a)),i=async a=>(await h(300),g.filter(b=>b.patientId===a).sort((a,b)=>b.generatedAt.getTime()-a.generatedAt.getTime())),j=async a=>(await h(300),g.find(b=>b.id===a)),k=async(a,b)=>{await h(400);let c=g.findIndex(b=>b.id===a);if(-1===c)throw Error("Relat\xf3rio n\xe3o encontrado.");return g[c]={...g[c],...b},g[c]},l=async(a,b,c)=>{await h(1e3);let e=d.N.find(b=>b.id===a),f=d.Tf.filter(b=>b.patientId===a).slice(0,3);if(!e)throw Error("Paciente n\xe3o encontrado.");e.name,e.conditions?.[0]?.name,e.medicalAlerts,f.map(a=>`
        Data: ${a.date}
        Subjetivo: ${a.subjective}
        Avalia\xe7\xe3o: ${a.assessment}
        Plano: ${a.plan}
        ---`).join("\n");let i=`**Identifica\xe7\xe3o do Paciente**
${e.name} apresenta queixa principal de ${e.conditions?.[0]?.name||"dor"}.

**Diagn\xf3stico Fisioterap\xeautico**
Baseado na avalia\xe7\xe3o inicial e evolu\xe7\xe3o das sess\xf5es, o diagn\xf3stico aponta para limita\xe7\xe3o funcional com comprometimento da mobilidade.

**Tratamento Realizado**
Foram realizadas sess\xf5es de fisioterapia com t\xe9cnicas espec\xedficas para o quadro apresentado, incluindo exerc\xedcios terap\xeauticos e modalidades f\xedsicas.

**Evolu\xe7\xe3o Cl\xednica**
${f.length>0?`O paciente demonstrou evolu\xe7\xe3o positiva durante o per\xedodo de tratamento, com melhora gradual dos sintomas relatados nas sess\xf5es.`:"Paciente em in\xedcio de tratamento."}

**Progn\xf3stico e Recomenda\xe7\xf5es**
Progn\xf3stico favor\xe1vel com continuidade do tratamento conforme prescri\xe7\xe3o fisioterap\xeautica. Recomenda-se acompanhamento m\xe9dico para evolu\xe7\xe3o do quadro.`,j={id:Date.now(),patientId:a,therapistId:d.rB.find(a=>"Fisioterapeuta"===a.role)?.id||"user_1",title:`Relat\xf3rio M\xe9dico - ${e.name}`,aiGeneratedContent:i,content:i.replace(/\*\*(.*?)\*\*/g,"<h3>$1</h3>").replace(/\n/g,"<br>"),status:"draft",recipientDoctor:b,recipientCrm:c,generatedAt:new Date};return g.unshift(j),j},m=async a=>{await h(300);let b=g.findIndex(b=>b.id===a);if(-1===b)throw Error("Relat\xf3rio n\xe3o encontrado.");let c=g[b];if(!c)throw Error("Relat\xf3rio n\xe3o encontrado.");if("finalized"!==c.status)throw Error("Apenas relat\xf3rios finalizados podem ser enviados.");return c.status="sent",c},n=async(a,b)=>{let c=d.Ko.find(b=>b.id===a.therapistId),e=document.createElement("div");e.innerHTML=`
        <div style="font-family: Arial, sans-serif; padding: 40px; color: #333; font-size: 12px; line-height: 1.6;">
            <header style="display: flex; justify-content: space-between; align-items: flex-start; border-bottom: 2px solid #0ea5e9; padding-bottom: 15px; margin-bottom: 25px;">
                <div>
                    <h1 style="font-size: 22px; color: #0284c7; margin: 0;">${d.TY.name}</h1>
                    <p style="font-size: 11px; color: #666; margin: 5px 0 0 0;">${d.TY.address}</p>
                    <p style="font-size: 11px; color: #666; margin: 5px 0 0 0;">${d.TY.phone} | ${d.TY.email}</p>
                </div>
                ${d.TY.logoUrl?`<img src="${d.TY.logoUrl}" alt="Logo" style="max-height: 50px;"/>`:""}
            </header>
            
            <h2 style="text-align: center; font-size: 16px; margin-bottom: 25px; font-weight: bold; text-transform: uppercase;">Relat\xf3rio Fisioterap\xeautico</h2>
            
            <table style="width: 100%; margin-bottom: 20px; border-collapse: collapse; font-size: 12px;">
                <tr>
                    <td style="padding: 5px; border: 1px solid #ddd; background-color: #f9f9f9; width: 120px;"><strong>Paciente:</strong></td>
                    <td style="padding: 5px; border: 1px solid #ddd;">${b.name}</td>
                </tr>
                 <tr>
                    <td style="padding: 5px; border: 1px solid #ddd; background-color: #f9f9f9;"><strong>Data de Nasc.:</strong></td>
                    <td style="padding: 5px; border: 1px solid #ddd;">${new Date(b.birthDate).toLocaleDateString("pt-BR",{timeZone:"UTC"})}</td>
                </tr>
                <tr>
                    <td style="padding: 5px; border: 1px solid #ddd; background-color: #f9f9f9;"><strong>Destinat\xe1rio:</strong></td>
                    <td style="padding: 5px; border: 1px solid #ddd;">${a.recipientDoctor||"N/A"} (CRM: ${a.recipientCrm||"N/A"})</td>
                </tr>
                 <tr>
                    <td style="padding: 5px; border: 1px solid #ddd; background-color: #f9f9f9;"><strong>Data do Relat\xf3rio:</strong></td>
                    <td style="padding: 5px; border: 1px solid #ddd;">${new Date(a.generatedAt).toLocaleDateString("pt-BR",{timeZone:"UTC"})}</td>
                </tr>
            </table>
            
            <section class="report-content">
                ${a.content.replace(/<h3>/g,'<h3 style="font-size: 14px; color: #0284c7; border-bottom: 1px solid #e2e8f0; padding-bottom: 4px; margin-top: 20px; margin-bottom: 10px;">').replace(/<\/h3>/g,"</h3>")}
            </section>
            
            <footer style="margin-top: 80px; text-align: center;">
                 <div style="display: inline-block; text-align: center;">
                    <p style="border-top: 1px solid #333; padding-top: 5px; width: 250px; margin: 0 auto;">${c?.name||"Fisioterapeuta Respons\xe1vel"}</p>
                    <p style="font-size: 11px; margin-top: 5px;">CREFITO: 12345-F</p>
                 </div>
                 <p style="font-size: 10px; color: #888; margin-top: 40px;">Este relat\xf3rio \xe9 confidencial e protegido por sigilo profissional.</p>
            </footer>
        </div>
    `;let g={margin:[.5,.5,.5,.5],filename:`relatorio-${b.name.replace(/\s/g,"_")}-${a.id}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};return f()().set(g).from(e).save()}},82015:a=>{a.exports=require("react")},92273:(a,b,c)=>{c.d(b,{db:()=>j});var d=c(4183);let e=[...d.N],f=[...d.ZS],g=[...d.Tf],h=[...d.BT],i=[...d.eB],j={getPatients:()=>[...e],getPatientById:a=>e.find(b=>b.id===a),addPatient:a=>{e.unshift(a)},updatePatient:a=>{e=e.map(b=>b.id===a.id?a:b)},getAppointments:()=>[...f],saveAppointment:a=>{let b=f.findIndex(b=>b.id===a.id);b>-1?f[b]=a:f.push(a)},deleteAppointment:a=>{f=f.filter(b=>b.id!==a)},deleteAppointmentSeries:(a,b)=>{f=f.filter(c=>!(c.seriesId===a&&c.startTime>=b))},getSoapNotes:()=>[...g],saveSoapNote:a=>{let b=g.findIndex(b=>b.id===a.id);b>-1?g[b]=a:g.unshift(a)},getTreatmentPlans:()=>[...h],updateTreatmentPlan:a=>{let b=h.findIndex(b=>b.id===a.id);b>-1&&(h[b]=a)},getExercisePrescriptions:()=>[...i],setExercisePrescriptionsForPlan:(a,b)=>{(i=i.filter(b=>b.treatmentPlanId!==a)).push(...b)}}},99597:(a,b,c)=>{c.d(b,{dj:()=>g}),c(8732);var d=c(82015);c(54822);let e=(0,d.createContext)(void 0),f=(0,d.createContext)(void 0),g=()=>{let a=(()=>{let a=(0,d.useContext)(e);return void 0===a?{enabled:!1,logRouterChange:()=>{},logHookCall:()=>{},logContextAccess:()=>{}}:a})(),b=(0,d.useContext)(f);if(a.logContextAccess("ToastContext","useToast"),!b){let a=Error("useToast must be used within a ToastProvider");throw console.error("âŒ Toast Context Error:",a.message),a}return{showToast:b.showToast}}}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[3317,9871,1302,4183],()=>b(b.s=24249));module.exports=c})();