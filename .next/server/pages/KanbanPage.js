"use strict";(()=>{var a={};a.id=8492,a.ids=[3220,8492],a.modules={8732:a=>{a.exports=require("react/jsx-runtime")},11035:(a,b,c)=>{c.d(b,{A:()=>i});var d=c(8732),e=c(82015),f=c(51302),g=c(72393);let h=(a,b)=>({projectId:b,title:"",description:"",status:g.e1.ToDo,priority:g.W6.Medium,dueDate:new Date().toISOString().split("T")[0],assignedUserId:a[0]?.id||""}),i=({isOpen:a,onClose:b,onSave:c,taskToEdit:i,therapists:j,projectId:k})=>{let[l,m]=(0,e.useState)(h(j,k)),[n,o]=(0,e.useState)(!1),p=(0,e.useRef)(null);if((0,e.useEffect)(()=>{i?m(i):m(h(j,k))},[i,a,j,k]),!a)return null;let q=a=>{let{name:b,value:c}=a.target;m(a=>({...a,[b]:c}))},r=async()=>{o(!0);let{actorUserId:a,...b}=l;await c(b),o(!1)},s=i?"Editar Tarefa":"Nova Tarefa";return(0,d.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:b,children:(0,d.jsxs)("div",{ref:p,className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg",onClick:a=>a.stopPropagation(),children:[(0,d.jsxs)("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[(0,d.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:s}),(0,d.jsx)("button",{onClick:b,className:"p-2 rounded-full hover:bg-slate-100",children:(0,d.jsx)(f.X,{className:"w-5 h-5 text-slate-600"})})]}),(0,d.jsxs)("main",{className:"p-6 space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"T\xedtulo*"}),(0,d.jsx)("input",{type:"text",name:"title",value:l.title,onChange:q,className:"mt-1 w-full p-2 border border-slate-300 rounded-lg"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Descri\xe7\xe3o"}),(0,d.jsx)("textarea",{name:"description",value:l.description,onChange:q,rows:3,className:"mt-1 w-full p-2 border border-slate-300 rounded-lg"})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Respons\xe1vel"}),(0,d.jsx)("select",{name:"assignedUserId",value:l.assignedUserId,onChange:q,className:"mt-1 w-full p-2 border border-slate-300 rounded-lg bg-white",children:j.map(a=>(0,d.jsx)("option",{value:a.id,children:a.name},a.id))})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Prazo"}),(0,d.jsx)("input",{type:"date",name:"dueDate",value:l.dueDate,onChange:q,className:"mt-1 w-full p-2 border border-slate-300 rounded-lg"})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Status"}),(0,d.jsx)("select",{name:"status",value:l.status,onChange:q,className:"mt-1 w-full p-2 border border-slate-300 rounded-lg bg-white",children:Object.values(g.e1).map(a=>(0,d.jsx)("option",{value:a,children:a},a))})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Prioridade"}),(0,d.jsx)("select",{name:"priority",value:l.priority,onChange:q,className:"mt-1 w-full p-2 border border-slate-300 rounded-lg bg-white",children:Object.values(g.W6).map(a=>(0,d.jsx)("option",{value:a,children:a},a))})]})]})]}),(0,d.jsxs)("footer",{className:"flex justify-end items-center p-4 border-t border-slate-200 bg-slate-50",children:[(0,d.jsx)("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 mr-2",children:"Cancelar"}),(0,d.jsxs)("button",{onClick:r,disabled:n,className:"px-4 py-2 text-sm font-medium text-white bg-teal-500 rounded-lg hover:bg-teal-600 flex items-center disabled:bg-teal-300",children:[(0,d.jsx)(f.eMP,{className:"w-4 h-4 mr-2"}),n?"Salvando...":"Salvar Tarefa"]})]})]})})}},19119:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{E:()=>h});var e=c(8732),f=c(71253),g=a([f]);function h({className:a,...b}){return(0,e.jsx)("div",{className:(0,f.cn)("animate-pulse rounded-md bg-muted",a),...b})}f=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},33873:a=>{a.exports=require("path")},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},42227:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(8732);c(82015);let e=({title:a,subtitle:b,children:c})=>(0,d.jsxs)("div",{className:"pb-8 md:flex md:items-center md:justify-between",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold leading-tight text-slate-900 tracking-tight",children:a}),(0,d.jsx)("p",{className:"mt-2 text-lg text-slate-600",children:b})]}),(0,d.jsx)("div",{className:"mt-4 flex md:mt-0 md:ml-4",children:c})]})},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},50802:a=>{a.exports=import("clsx")},54822:a=>{a.exports=require("react-router-dom")},56472:a=>{a.exports=require("@opentelemetry/api")},59598:(a,b,c)=>{c.d(b,{A:()=>h});var d=c(8732);c(82015);var e=c(72393),f=c(51302);let g={[e.W6.High]:{icon:(0,d.jsx)(f.uGo,{className:"w-4 h-4 text-red-500"}),color:"bg-red-100 border-red-300"},[e.W6.Medium]:{icon:(0,d.jsx)(f.rXn,{className:"w-4 h-4 text-amber-500"}),color:"bg-amber-100 border-amber-300"},[e.W6.Low]:{icon:(0,d.jsx)(f.n97,{className:"w-4 h-4 text-sky-500"}),color:"bg-sky-100 border-sky-300"}},h=({task:a,therapist:b,onClick:c,onDragStart:e})=>{let{icon:h,color:i}=g[a.priority],j=new Date(a.dueDate),k=j<new Date&&"Conclu\xeddo"!==a.status;return(0,d.jsxs)("div",{onClick:c,draggable:"true",onDragStart:b=>e(b,a.id),className:"bg-white p-3 rounded-lg shadow-sm hover:shadow-md border border-slate-200 cursor-grab active:cursor-grabbing transition-shadow duration-200",children:[(0,d.jsx)("h4",{className:"font-semibold text-slate-800 text-sm mb-1",children:a.title}),(0,d.jsx)("p",{className:"text-xs text-slate-500 mb-3",children:a.description}),(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("div",{className:`p-1 rounded-md border ${i}`,title:`Prioridade: ${a.priority}`,children:h}),(0,d.jsxs)("div",{className:`flex items-center text-xs px-2 py-0.5 rounded-full ${k?"bg-red-100 text-red-700":"bg-slate-100 text-slate-600"}`,children:[(0,d.jsx)(f.VvS,{className:"w-3 h-3 mr-1"}),j.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})]})]}),b&&(0,d.jsx)("img",{src:b.avatarUrl,alt:b.name,title:`Respons\xe1vel: ${b.name}`,className:"w-7 h-7 rounded-full ring-2 ring-white"})]})]})}},63167:(a,b,c)=>{c.d(b,{JQ:()=>h,fd:()=>j,x1:()=>i});var d=c(4183);let e=[...d.Bj],f=[...d.tq],g=a=>new Promise(b=>setTimeout(b,a)),h=async()=>(await g(300),[...f]),i=async a=>(await g(500),a)?[...e].filter(b=>b.projectId===a):[...e],j=async(a,b)=>{if(await g(400),a.id){let c={...e.find(b=>b.id===a.id),...a,actorUserId:b};return e=e.map(b=>b.id===a.id?c:b),c}{let c={id:`task_${Date.now()}`,...a,actorUserId:b};return e.unshift(c),c}}},71253:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{cn:()=>h});var e=c(50802),f=c(75979),g=a([e,f]);function h(...a){return(0,f.twMerge)((0,e.clsx)(a))}[e,f]=g.then?(await g)():g,d()}catch(a){d(a)}})},75979:a=>{a.exports=import("tailwind-merge")},81065:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>r});var e=c(8732),f=c(82015),g=c(42227),h=c(72393),i=c(63167),j=c(51302),k=c(59598),l=c(11035),m=c(19119),n=c(28471),o=c(99597),p=a([m]);m=(p.then?(await p)():p)[0];let q=({title:a,tasks:b,therapists:c,onTaskClick:d,onDragStart:f,isDraggedOver:g,onDragOver:h,onDrop:i,onDragEnter:j,onDragLeave:l})=>(0,e.jsxs)("div",{onDragOver:h,onDrop:i,onDragEnter:j,onDragLeave:l,className:`w-80 flex-shrink-0 rounded-xl p-3 transition-colors duration-200 ${g?"bg-teal-50":"bg-slate-100"}`,children:[(0,e.jsxs)("h3",{className:"font-semibold text-slate-700 mb-3 px-1",children:[a," (",b.length,")"]}),(0,e.jsx)("div",{className:"space-y-3 h-full overflow-y-auto",children:b.map(a=>(0,e.jsx)(k.A,{task:a,therapist:c.find(b=>b.id===a.assignedUserId),onClick:()=>d(a),onDragStart:f},a.id))})]}),r=()=>{let[a,b]=(0,f.useState)([]),[c,d]=(0,f.useState)(""),[k,p]=(0,f.useState)([]),[r,s]=(0,f.useState)(!0),[t,u]=(0,f.useState)(!1),[v,w]=(0,f.useState)(void 0),[x,y]=(0,f.useState)(null),{therapists:z,isLoading:A}=(0,n.Ez)(),{user:B}=(0,n.As)(),{showToast:C}=(0,o.dj)(),D=(0,f.useCallback)(async()=>{try{let a=await i.JQ();b(a),a.length>0&&!c&&a[0]&&d(a[0].id)}catch(a){C("Falha ao carregar projetos.","error")}},[C,c]),E=(0,f.useCallback)(async()=>{if(!c){p([]),s(!1);return}s(!0);try{let a=await i.x1(c);p(a)}catch(a){C("Falha ao carregar tarefas do projeto.","error")}finally{s(!1)}},[c,C]);(0,f.useEffect)(()=>{D()},[D]),(0,f.useEffect)(()=>{E()},[E]);let F=(0,f.useMemo)(()=>({[h.e1.ToDo]:k.filter(a=>a.status===h.e1.ToDo),[h.e1.InProgress]:k.filter(a=>a.status===h.e1.InProgress),[h.e1.Done]:k.filter(a=>a.status===h.e1.Done)}),[k]),G=a=>{w(a),u(!0)},H=async a=>{B&&(await i.fd({...a,projectId:c},B.id),C(a.id?"Tarefa atualizada!":"Tarefa criada!","success"),E(),u(!1))},I=(a,b)=>{a.dataTransfer.setData("taskId",b)},J=a=>{a.preventDefault()},K=async(a,b)=>{a.preventDefault();let c=a.dataTransfer.getData("taskId");y(null);let d=k.find(a=>a.id===c);if(d&&d.status!==b&&B){let a=k.map(a=>a.id===c?{...a,status:b}:a);p(a);try{let{actorUserId:a,...c}={...d,status:b};await i.fd(c,B.id),C(`Tarefa movida para "${b}"`,"success")}catch{C("Falha ao mover a tarefa.","error"),p(k)}}},L=a.find(a=>a.id===c);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.A,{title:L?.title||"Quadro de Projetos",subtitle:L?.description||"Selecione um projeto para visualizar suas tarefas.",children:(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)("select",{value:c,onChange:a=>d(a.target.value),className:"w-full sm:w-56 p-2 border border-slate-300 rounded-lg bg-white",children:a.map(a=>(0,e.jsx)("option",{value:a.id,children:a.title},a.id))}),(0,e.jsxs)("button",{onClick:()=>{if(!c)return void C("Por favor, selecione um projeto primeiro.","error");w(void 0),u(!0)},className:"inline-flex items-center justify-center rounded-lg border border-transparent bg-teal-500 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-teal-600",children:[(0,e.jsx)(j.FWt,{className:"-ml-1 mr-2 h-5 w-5"}),"Nova Tarefa"]})]})}),(0,e.jsx)(l.A,{isOpen:t,onClose:()=>u(!1),onSave:H,taskToEdit:v,therapists:z,projectId:c}),(0,e.jsx)("div",{className:"flex-1 flex gap-4 overflow-x-auto pb-4",children:r||A?Array.from({length:3}).map((a,b)=>(0,e.jsxs)("div",{className:"w-80 flex-shrink-0 bg-slate-100 rounded-xl p-3",children:[(0,e.jsx)(m.E,{className:"h-6 w-1/2 mb-4"}),(0,e.jsx)(m.E,{className:"h-24 w-full mb-3"}),(0,e.jsx)(m.E,{className:"h-24 w-full"})]},b)):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(q,{title:h.e1.ToDo,tasks:F[h.e1.ToDo],therapists:z,onTaskClick:G,onDragStart:I,isDraggedOver:x===h.e1.ToDo,onDragOver:J,onDrop:a=>K(a,h.e1.ToDo),onDragEnter:()=>y(h.e1.ToDo),onDragLeave:()=>y(null)}),(0,e.jsx)(q,{title:h.e1.InProgress,tasks:F[h.e1.InProgress],therapists:z,onTaskClick:G,onDragStart:I,isDraggedOver:x===h.e1.InProgress,onDragOver:J,onDrop:a=>K(a,h.e1.InProgress),onDragEnter:()=>y(h.e1.InProgress),onDragLeave:()=>y(null)}),(0,e.jsx)(q,{title:h.e1.Done,tasks:F[h.e1.Done],therapists:z,onTaskClick:G,onDragStart:I,isDraggedOver:x===h.e1.Done,onDragOver:J,onDrop:a=>K(a,h.e1.Done),onDragEnter:()=>y(h.e1.Done),onDragLeave:()=>y(null)})]})})]})};d()}catch(a){d(a)}})},82015:a=>{a.exports=require("react")},89317:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>s,default:()=>o,getServerSideProps:()=>r,getStaticPaths:()=>q,getStaticProps:()=>p,handler:()=>A,reportWebVitals:()=>t,routeModule:()=>z,unstable_getServerProps:()=>x,unstable_getServerSideProps:()=>y,unstable_getStaticParams:()=>w,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>u});var e=c(63885),f=c(80237),g=c(81413),h=c(3317),i=c.n(h),j=c(76195),k=c.n(j),l=c(81065),m=c(12289),n=a([l]);l=(n.then?(await n)():n)[0];let o=(0,g.M)(l,"default"),p=(0,g.M)(l,"getStaticProps"),q=(0,g.M)(l,"getStaticPaths"),r=(0,g.M)(l,"getServerSideProps"),s=(0,g.M)(l,"config"),t=(0,g.M)(l,"reportWebVitals"),u=(0,g.M)(l,"unstable_getStaticProps"),v=(0,g.M)(l,"unstable_getStaticPaths"),w=(0,g.M)(l,"unstable_getStaticParams"),x=(0,g.M)(l,"unstable_getServerProps"),y=(0,g.M)(l,"unstable_getServerSideProps"),z=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/KanbanPage",pathname:"/KanbanPage",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:k(),Document:i()},userland:l}),A=(0,m.U)({srcPage:"/KanbanPage",config:s,userland:l,routeModule:z,getStaticPaths:q,getStaticProps:p,getServerSideProps:r});d()}catch(a){d(a)}})},93939:a=>{a.exports=require("@supabase/supabase-js")},99597:(a,b,c)=>{c.d(b,{dj:()=>g}),c(8732);var d=c(82015);c(54822);let e=(0,d.createContext)(void 0),f=(0,d.createContext)(void 0),g=()=>{let a=(()=>{let a=(0,d.useContext)(e);return void 0===a?{enabled:!1,logRouterChange:()=>{},logHookCall:()=>{},logContextAccess:()=>{}}:a})(),b=(0,d.useContext)(f);if(a.logContextAccess("ToastContext","useToast"),!b){let a=Error("useToast must be used within a ToastProvider");throw console.error("âŒ Toast Context Error:",a.message),a}return{showToast:b.showToast}}}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[3317,9871,1302,4183,7367,8471],()=>b(b.s=89317));module.exports=c})();