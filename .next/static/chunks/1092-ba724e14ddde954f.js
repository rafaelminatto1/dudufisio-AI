"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1092],{24341:(e,t,s)=>{s.d(t,{A:()=>d});var a=s(37876),i=s(14232),n=s(28249),o=s(93536),l=s(6394),r=s(24688);let c=["aguda","cansa\xe7o","formigamento","latejante","queima\xe7\xe3o"],d=e=>{let{isOpen:t,onClose:s,onSave:d,onDelete:m,point:x}=e,[p,u]=(0,i.useState)(x.intensity||0),[h,b]=(0,i.useState)(x.type||"aguda"),[g,f]=(0,i.useState)(x.description||"");return((0,i.useEffect)(()=>{u(x.intensity||0),b(x.type||"aguda"),f(x.description||"")},[x,t]),t)?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:s,children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:x.id?"Editar Ponto de Dor":"Adicionar Ponto de Dor"}),(0,a.jsx)("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-100",children:(0,a.jsx)(n.A,{className:"w-5 h-5 text-slate-600"})})]}),(0,a.jsxs)("main",{className:"p-6 space-y-4",children:[(0,a.jsx)(r.A,{selectedScore:p,onSelectScore:u}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Tipo de Dor"}),(0,a.jsx)("select",{value:h,onChange:e=>b(e.target.value),className:"mt-1 w-full p-2 border border-slate-300 rounded-lg bg-white",children:c.map(e=>(0,a.jsx)("option",{value:e,className:"capitalize",children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Descri\xe7\xe3o (opcional)"}),(0,a.jsx)("textarea",{value:g,onChange:e=>f(e.target.value),rows:3,className:"mt-1 w-full p-2 border border-slate-300 rounded-lg",placeholder:"Ex: Dor pontual ao realizar rota\xe7\xe3o externa..."})]})]}),(0,a.jsxs)("footer",{className:"flex justify-between items-center p-4 border-t border-slate-200 bg-slate-50",children:[m&&(0,a.jsxs)("button",{onClick:m,className:"px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg flex items-center",children:[(0,a.jsx)(o.A,{className:"w-4 h-4 mr-2"})," Excluir"]}),(0,a.jsxs)("div",{className:"ml-auto flex items-center",children:[(0,a.jsx)("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 mr-2",children:"Cancelar"}),(0,a.jsxs)("button",{onClick:()=>{d({intensity:p,type:h,description:g})},className:"px-4 py-2 text-sm font-medium text-white bg-teal-500 rounded-lg hover:bg-teal-600 flex items-center",children:[(0,a.jsx)(l.A,{className:"w-4 h-4 mr-2"})," Salvar"]})]})]})]})}):null}},25040:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(37876),i=s(14232);let n={front:"\n        M100,20 C115,20 125,30 125,45 S115,70 100,70 S75,60 75,45 S85,20 100,20 Z\n        M100,70 L100,80\n        M100,80 C130,80 140,90 140,120 L140,180\n        M100,80 C70,80 60,90 60,120 L60,180\n        M140,120 L160,120 L165,250 L155,250 Z\n        M60,120 L40,120 L35,250 L45,250 Z\n        M100,180 C120,180 125,185 125,200 L125,350 L115,350 L115,480 L125,490 L125,500 L105,500 Z\n        M100,180 C80,180 75,185 75,200 L75,350 L85,350 L85,480 L75,490 L75,500 L95,500 Z\n    ",back:"\n        M100,20 C115,20 125,30 125,45 S115,70 100,70 S75,60 75,45 S85,20 100,20 Z\n        M100,70 L100,80\n        M100,80 C130,80 140,90 140,120 L140,180\n        M100,80 C70,80 60,90 60,120 L60,180\n        M140,120 L160,120 L165,250 L155,250 Z\n        M60,120 L40,120 L35,250 L45,250 Z\n        M100,180 C120,180 125,185 125,200 L125,350 L115,350 L115,480 L125,490 L125,500 L105,500 Z\n        M100,180 C80,180 75,185 75,200 L75,350 L85,350 L85,480 L75,490 L75,500 L95,500 Z\n        M100,85 L100,175\n    "},o=e=>{let{points:t,onMapClick:s,onPointClick:o}=e,[l,r]=(0,i.useState)(null),c=(0,i.useRef)(null),d=()=>{r(null)};return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"flex justify-center gap-4",children:["front","back"].map(e=>(0,a.jsxs)("div",{className:"w-1/2",children:[(0,a.jsx)("h4",{className:"text-center font-semibold text-sm text-slate-600 mb-1 capitalize",children:"front"===e?"Frente":"Costas"}),(0,a.jsxs)("svg",{ref:c,viewBox:"0 0 200 500",onClick:t=>((e,t)=>{if(!c.current)return;let a=c.current.getBoundingClientRect();s((e.clientX-a.left)/a.width*100,(e.clientY-a.top)/a.height*100,t)})(t,e),className:"w-full cursor-crosshair",children:[(0,a.jsx)("path",{d:n[e],className:"fill-slate-200",stroke:"#94a3b8",strokeWidth:"1"}),t.filter(t=>t.bodyPart===e).map(e=>(0,a.jsx)("circle",{cx:"".concat(e.x,"%"),cy:"".concat(e.y,"%"),r:"5",className:"cursor-pointer transition-all hover:r-7 ".concat((e=>e<=3?"fill-green-500/80 stroke-green-700":e<=6?"fill-yellow-500/80 stroke-yellow-700":"fill-red-500/80 stroke-red-700")(e.intensity)),strokeWidth:"1.5",onClick:t=>{t.stopPropagation(),o(e)},onMouseEnter:t=>((e,t)=>{r({content:"Intensidade: ".concat(t.intensity,"/10\nTipo: ").concat(t.type,"\nData: ").concat(new Date(t.date).toLocaleDateString()),x:e.pageX,y:e.pageY})})(t,e),onMouseLeave:d},e.id))]})]},e))}),l&&(0,a.jsx)("div",{style:{top:l.y,left:l.x},className:"absolute z-10 p-2 text-xs text-white bg-slate-800 rounded-md shadow-lg pointer-events-none transform -translate-y-full -translate-x-1/2 whitespace-pre-wrap",children:l.content})]})}},64717:(e,t,s)=>{s.d(t,{A0:()=>d,Mp:()=>p,Ns:()=>x,bb:()=>r,oh:()=>m,vN:()=>c});var a=s(66766),i=s(32061),n=s.n(i);let o=[...a.ps],l=e=>new Promise(t=>setTimeout(t,e)),r=async e=>(await l(300),o.filter(t=>t.patientId===e).sort((e,t)=>t.generatedAt.getTime()-e.generatedAt.getTime())),c=async e=>(await l(300),o.find(t=>t.id===e)),d=async(e,t)=>{await l(400);let s=o.findIndex(t=>t.id===e);if(-1===s)throw Error("Relat\xf3rio n\xe3o encontrado.");return o[s]={...o[s],...t},o[s]},m=async(e,t,s)=>{var i,n,r,c,d;await l(1e3);let m=a.N.find(t=>t.id===e),x=a.Tf.filter(t=>t.patientId===e).slice(0,3);if(!m)throw Error("Paciente n\xe3o encontrado.");"\n        CONTEXTO: Voc\xea \xe9 um fisioterapeuta experiente criando um relat\xf3rio m\xe9dico profissional para o Dr(a). ".concat(t||"Colega M\xe9dico"," (CRM: ").concat(s||"A informar",").\n\n        DADOS DO PACIENTE:\n        Nome: ").concat(m.name,"\n        Queixa Principal: ").concat((null==(n=m.conditions)||null==(i=n[0])?void 0:i.name)||"N\xe3o especificada","\n        Hist\xf3rico M\xe9dico Relevante: ").concat(m.medicalAlerts||"Nenhum","\n        \n        \xdaLTIMAS EVOLU\xc7\xd5ES (Formato SOAP):\n        ").concat(x.map(e=>"\n        Data: ".concat(e.date,"\n        Subjetivo: ").concat(e.subjective,"\n        Avalia\xe7\xe3o: ").concat(e.assessment,"\n        Plano: ").concat(e.plan,"\n        ---")).join("\n"),'\n        \n        INSTRU\xc7\xd5ES:\n        1. Crie um relat\xf3rio m\xe9dico conciso e profissional em portugu\xeas brasileiro.\n        2. Use linguagem t\xe9cnica apropriada para comunica\xe7\xe3o entre profissionais de sa\xfade.\n        3. Estruture o relat\xf3rio nas seguintes se\xe7\xf5es: Identifica\xe7\xe3o do Paciente, Diagn\xf3stico Fisioterap\xeautico, Tratamento Realizado, Evolu\xe7\xe3o Cl\xednica, e Progn\xf3stico e Recomenda\xe7\xf5es. Formate os t\xedtulos das se\xe7\xf5es em negrito (ex: **Identifica\xe7\xe3o do Paciente**).\n        4. Seja objetivo e factual, baseando-se estritamente nos dados fornecidos. N\xe3o invente informa\xe7\xf5es.\n        5. Sintetize as evolu\xe7\xf5es em um par\xe1grafo coeso na se\xe7\xe3o "Evolu\xe7\xe3o Cl\xednica".\n    ');let p="**Identifica\xe7\xe3o do Paciente**\n".concat(m.name," apresenta queixa principal de ").concat((null==(c=m.conditions)||null==(r=c[0])?void 0:r.name)||"dor",".\n\n**Diagn\xf3stico Fisioterap\xeautico**\nBaseado na avalia\xe7\xe3o inicial e evolu\xe7\xe3o das sess\xf5es, o diagn\xf3stico aponta para limita\xe7\xe3o funcional com comprometimento da mobilidade.\n\n**Tratamento Realizado**\nForam realizadas sess\xf5es de fisioterapia com t\xe9cnicas espec\xedficas para o quadro apresentado, incluindo exerc\xedcios terap\xeauticos e modalidades f\xedsicas.\n\n**Evolu\xe7\xe3o Cl\xednica**\n").concat(x.length>0?"O paciente demonstrou evolu\xe7\xe3o positiva durante o per\xedodo de tratamento, com melhora gradual dos sintomas relatados nas sess\xf5es.":"Paciente em in\xedcio de tratamento.","\n\n**Progn\xf3stico e Recomenda\xe7\xf5es**\nProgn\xf3stico favor\xe1vel com continuidade do tratamento conforme prescri\xe7\xe3o fisioterap\xeautica. Recomenda-se acompanhamento m\xe9dico para evolu\xe7\xe3o do quadro."),u={id:Date.now(),patientId:e,therapistId:(null==(d=a.rB.find(e=>"Fisioterapeuta"===e.role))?void 0:d.id)||"user_1",title:"Relat\xf3rio M\xe9dico - ".concat(m.name),aiGeneratedContent:p,content:p.replace(/\*\*(.*?)\*\*/g,"<h3>$1</h3>").replace(/\n/g,"<br>"),status:"draft",recipientDoctor:t,recipientCrm:s,generatedAt:new Date};return o.unshift(u),u},x=async e=>{await l(300);let t=o.findIndex(t=>t.id===e);if(-1===t)throw Error("Relat\xf3rio n\xe3o encontrado.");let s=o[t];if(!s)throw Error("Relat\xf3rio n\xe3o encontrado.");if("finalized"!==s.status)throw Error("Apenas relat\xf3rios finalizados podem ser enviados.");return s.status="sent",s},p=async(e,t)=>{let s=a.Ko.find(t=>t.id===e.therapistId),i=document.createElement("div");i.innerHTML='\n        <div style="font-family: Arial, sans-serif; padding: 40px; color: #333; font-size: 12px; line-height: 1.6;">\n            <header style="display: flex; justify-content: space-between; align-items: flex-start; border-bottom: 2px solid #0ea5e9; padding-bottom: 15px; margin-bottom: 25px;">\n                <div>\n                    <h1 style="font-size: 22px; color: #0284c7; margin: 0;">'.concat(a.TY.name,'</h1>\n                    <p style="font-size: 11px; color: #666; margin: 5px 0 0 0;">').concat(a.TY.address,'</p>\n                    <p style="font-size: 11px; color: #666; margin: 5px 0 0 0;">').concat(a.TY.phone," | ").concat(a.TY.email,"</p>\n                </div>\n                ").concat(a.TY.logoUrl?'<img src="'.concat(a.TY.logoUrl,'" alt="Logo" style="max-height: 50px;"/>'):"",'\n            </header>\n            \n            <h2 style="text-align: center; font-size: 16px; margin-bottom: 25px; font-weight: bold; text-transform: uppercase;">Relat\xf3rio Fisioterap\xeautico</h2>\n            \n            <table style="width: 100%; margin-bottom: 20px; border-collapse: collapse; font-size: 12px;">\n                <tr>\n                    <td style="padding: 5px; border: 1px solid #ddd; background-color: #f9f9f9; width: 120px;"><strong>Paciente:</strong></td>\n                    <td style="padding: 5px; border: 1px solid #ddd;">').concat(t.name,'</td>\n                </tr>\n                 <tr>\n                    <td style="padding: 5px; border: 1px solid #ddd; background-color: #f9f9f9;"><strong>Data de Nasc.:</strong></td>\n                    <td style="padding: 5px; border: 1px solid #ddd;">').concat(new Date(t.birthDate).toLocaleDateString("pt-BR",{timeZone:"UTC"}),'</td>\n                </tr>\n                <tr>\n                    <td style="padding: 5px; border: 1px solid #ddd; background-color: #f9f9f9;"><strong>Destinat\xe1rio:</strong></td>\n                    <td style="padding: 5px; border: 1px solid #ddd;">').concat(e.recipientDoctor||"N/A"," (CRM: ").concat(e.recipientCrm||"N/A",')</td>\n                </tr>\n                 <tr>\n                    <td style="padding: 5px; border: 1px solid #ddd; background-color: #f9f9f9;"><strong>Data do Relat\xf3rio:</strong></td>\n                    <td style="padding: 5px; border: 1px solid #ddd;">').concat(new Date(e.generatedAt).toLocaleDateString("pt-BR",{timeZone:"UTC"}),'</td>\n                </tr>\n            </table>\n            \n            <section class="report-content">\n                ').concat(e.content.replace(/<h3>/g,'<h3 style="font-size: 14px; color: #0284c7; border-bottom: 1px solid #e2e8f0; padding-bottom: 4px; margin-top: 20px; margin-bottom: 10px;">').replace(/<\/h3>/g,"</h3>"),'\n            </section>\n            \n            <footer style="margin-top: 80px; text-align: center;">\n                 <div style="display: inline-block; text-align: center;">\n                    <p style="border-top: 1px solid #333; padding-top: 5px; width: 250px; margin: 0 auto;">').concat((null==s?void 0:s.name)||"Fisioterapeuta Respons\xe1vel",'</p>\n                    <p style="font-size: 11px; margin-top: 5px;">CREFITO: ').concat("12345-F",'</p>\n                 </div>\n                 <p style="font-size: 10px; color: #888; margin-top: 40px;">Este relat\xf3rio \xe9 confidencial e protegido por sigilo profissional.</p>\n            </footer>\n        </div>\n    ');let o={margin:[.5,.5,.5,.5],filename:"relatorio-".concat(t.name.replace(/\s/g,"_"),"-").concat(e.id,".pdf"),image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};return n()().set(o).from(i).save()}},74220:(e,t,s)=>{s.d(t,{JQ:()=>l,fd:()=>c,x1:()=>r});var a=s(66766);let i=[...a.Bj],n=[...a.tq],o=e=>new Promise(t=>setTimeout(t,e)),l=async()=>(await o(300),[...n]),r=async e=>(await o(500),e)?[...i].filter(t=>t.projectId===e):[...i],c=async(e,t)=>{if(await o(400),e.id){let s={...i.find(t=>t.id===e.id),...e,actorUserId:t};return i=i.map(t=>t.id===e.id?s:t),s}{let s={id:"task_".concat(Date.now()),...e,actorUserId:t};return i.unshift(s),s}}},81092:(e,t,s)=>{s.r(t),s.d(t,{default:()=>tf});var a=s(37876),i=s(14232),n=s(88307),o=s(14952),l=s(80310),r=s(9498),c=s(34287),d=s(28249),m=s(9552),x=s(79758),p=s(12572),u=s(62283),h=s(73305),b=s(8728),g=s(74062),f=s(26101),j=s(56244),y=s(50057),v=s(21174),N=s(68693),w=s(54791),k=s(21355),A=s(60383),C=s(28113),D=s(16075),P=s(34297),S=s(76158),T=s(12168),L=s(39194),E=s(39303),M=s(64717),z=s(74220),I=s(93508),R=s(35880),F=s(15496),O=s(94626),_=s(67098),q=s(88635),Z=s(95857),B=s(66822),V=s(43061),W=s(34007),K=s(45907),G=s(4069),U=s(40570),H=s(25493),Y=s(39493),X=s(27217),Q=s(29466);let J=e=>{let{metric:t,notes:s}=e,n=(0,i.useMemo)(()=>s.filter(e=>{var s;return null==(s=e.metricResults)?void 0:s.some(e=>e.metricId===t.id)}).map(e=>({date:e.date,value:e.metricResults.find(e=>e.metricId===t.id).value})).sort((e,t)=>new Date(e.date.split("/").reverse().join("-")).getTime()-new Date(t.date.split("/").reverse().join("-")).getTime()),[t.id,s]);return n.length<2?(0,a.jsx)(Z.A,{title:"Evolu\xe7\xe3o: ".concat(t.name),icon:(0,a.jsx)(Q.A,{}),children:(0,a.jsx)("p",{className:"text-sm text-center text-slate-500 py-8",children:"Dados insuficientes para gerar o gr\xe1fico. \xc9 necess\xe1rio registrar esta m\xe9trica em pelo menos duas sess\xf5es."})}):(0,a.jsx)(Z.A,{title:"Evolu\xe7\xe3o: ".concat(t.name),icon:(0,a.jsx)(Q.A,{}),children:(0,a.jsx)("div",{className:"h-64 -ml-4",children:(0,a.jsx)(W.u,{width:"100%",height:"100%",children:(0,a.jsxs)(K.b,{data:n,margin:{top:5,right:20,left:0,bottom:5},children:[(0,a.jsx)(G.d,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,a.jsx)(U.W,{dataKey:"date",stroke:"#64748b",fontSize:12,tickLine:!1,axisLine:!1}),(0,a.jsx)(H.h,{stroke:"#64748b",fontSize:12,tickLine:!1,axisLine:!1,domain:["dataMin - 1","dataMax + 1"],unit:t.unit?" ".concat(t.unit):""}),(0,a.jsx)(Y.m,{contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"0.5rem"},labelStyle:{color:"#1e293b",fontWeight:"bold"},formatter:e=>["".concat(e," ").concat(t.unit||""),t.name]}),(0,a.jsx)(X.N,{type:"monotone",dataKey:"value",name:t.name,stroke:"#0ea5e9",strokeWidth:2,dot:{r:4},activeDot:{r:8}})]})})})})},$=e=>{let{notes:t,onViewNote:s}=e;return(0,a.jsx)("div",{className:"bg-white p-6 rounded-2xl shadow-sm",children:(0,a.jsx)("div",{className:"relative border-l-2 border-slate-200 ml-3",children:t.length>0?(0,a.jsx)("ul",{className:"space-y-8",children:t.map(e=>(0,a.jsxs)("li",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute -left-[29px] top-1 w-6 h-6 rounded-full bg-sky-500 flex items-center justify-center ring-4 ring-white",children:(0,a.jsx)(k.A,{className:"w-3 h-3 text-white"})}),(0,a.jsxs)("div",{className:"ml-8",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("p",{className:"font-bold text-slate-800",children:["Sess\xe3o #",e.sessionNumber," - ",e.date]})}),(0,a.jsxs)("p",{className:"text-sm text-slate-600 mt-1",children:[(0,a.jsx)("strong",{className:"font-semibold text-slate-700",children:"Avalia\xe7\xe3o:"})," ",e.assessment]}),(0,a.jsx)("button",{onClick:()=>s(e),className:"mt-2 text-sm font-semibold text-sky-600 hover:text-sky-700",children:"Ver Detalhes →"})]})]},e.id))}):(0,a.jsxs)("div",{className:"pl-8 text-center text-slate-500",children:[(0,a.jsx)(k.A,{className:"mx-auto h-12 w-12 text-slate-300"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-slate-900",children:"Nenhum hist\xf3rico cl\xednico"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-slate-500",children:"Comece adicionando uma nova anota\xe7\xe3o."})]})})})};var ee=s(14776),et=s(83981),es=s(79247),ea=s(93990),ei=s(82144);let en=e=>{let{appointments:t,onAdd:s}=e,i=[...t].sort((e,t)=>t.startTime.getTime()-e.startTime.getTime()),n=new Date;return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 flex items-center",children:[(0,a.jsx)(w.A,{className:"mr-3 text-sky-500"})," Linha do Tempo de Atendimentos"]}),(0,a.jsx)("button",{onClick:s,title:"Agendar nova consulta",className:"p-2 rounded-full hover:bg-sky-100 text-sky-600",children:(0,a.jsx)(A.A,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"relative pl-6",children:[(0,a.jsx)("div",{className:"absolute left-9 top-0 bottom-0 w-0.5 bg-slate-200"}),i.length>0?(0,a.jsx)("ul",{className:"space-y-6",children:i.map(e=>{let t=e.startTime<n,s=((e,t)=>{switch(e){case ee.y2.Completed:return{icon:(0,a.jsx)(et.A,{className:"w-4 h-4 text-white"}),color:"bg-green-500",label:"Realizado"};case ee.y2.Scheduled:return t?{icon:(0,a.jsx)(es.A,{className:"w-4 h-4 text-white"}),color:"bg-slate-400",label:"Agendado (passado)"}:{icon:(0,a.jsx)(es.A,{className:"w-4 h-4 text-white"}),color:"bg-sky-500",label:"Agendado"};case ee.y2.Canceled:return{icon:(0,a.jsx)(ea.A,{className:"w-4 h-4 text-white"}),color:"bg-red-500",label:"Cancelado"};case ee.y2.NoShow:return{icon:(0,a.jsx)(ei.A,{className:"w-4 h-4 text-white"}),color:"bg-amber-500",label:"Faltou"};default:return{icon:(0,a.jsx)(es.A,{className:"w-4 h-4 text-white"}),color:"bg-slate-500",label:""}}})(e.status,t);return(0,a.jsxs)("li",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute -left-3.5 top-1.5 w-8 h-8 rounded-full ".concat(s.color," flex items-center justify-center ring-4 ring-white"),children:s.icon}),(0,a.jsxs)("div",{className:"ml-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"font-bold text-slate-800",children:e.startTime.toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"})}),(0,a.jsx)("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full ".concat(s.color," text-white"),children:s.label})]}),(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:[e.type," - ",e.title]}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:[e.startTime.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})," - ",e.endTime.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]})]},e.id)})}):(0,a.jsx)("div",{className:"text-sm text-slate-500 text-center py-4",children:"Nenhuma consulta encontrada."})]})]})};var eo=s(41547),el=s(89926),er=s(61052);let ec=[{id:"protocolo-joelho-lca",name:"Protocolo P\xf3s-operat\xf3rio de Joelho (LCA)",description:"Reabilita\xe7\xe3o completa com foco em ganho de ADM, for\xe7a e retorno seguro ao esporte."},{id:"protocolo-ombro-impacto",name:"Protocolo para S\xedndrome do Impacto do Ombro",description:"Fortalecimento do manguito rotador e reeduca\xe7\xe3o escapular para al\xedvio da dor."},{id:"protocolo-lombalgia",name:"Protocolo para Lombalgia (Fase Aguda)",description:"Diretrizes para manejo da dor aguda, mobilidade e ativa\xe7\xe3o do core."}];var ed=s(47894);let em=async e=>{await new Promise(e=>setTimeout(e,300));let t=e.toLowerCase();return ec.filter(e=>e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||t.includes("lca")&&e.id.includes("lca")||t.includes("ombro")&&e.id.includes("ombro")||t.includes("lombalgia")&&e.id.includes("lombalgia"))},ex=async e=>(0,ed.vm)({nome_material:e.name,tipo_material:"Protocolo Cl\xednico"});var ep=s(6782);let eu=e=>{let{isOpen:t,onClose:s,patient:n,onApply:o}=e,[r,c]=(0,i.useState)(!1),[m,x]=(0,i.useState)([]),[p,u]=(0,i.useState)(null),[h,b]=(0,i.useState)(""),[g,f]=(0,i.useState)(!1),{showToast:j}=(0,B.dj)();(0,i.useEffect)(()=>{t&&n.conditions&&n.conditions.length>0&&(async()=>{c(!0),u(null),b("");try{var e,t;let s=(null==(t=n.conditions)||null==(e=t[0])?void 0:e.name)||"",a=await em(s);x(a)}catch(e){j("Erro ao buscar sugest\xf5es de protocolos.","error")}finally{c(!1)}})()},[t,n.conditions,j]);let y=async e=>{c(!0),u(e);try{let t=await ex(e);b(t)}catch(e){j("Erro ao carregar detalhes do protocolo.","error"),u(null)}finally{c(!1)}},v=async()=>{if(p&&h){f(!0);try{let e=await ed._z(),t={treatmentGoals:e.treatmentGoals,exercises:e.exercises};await E.td(n.id,t),o()}catch(e){j("Falha ao aplicar o protocolo.","error")}finally{f(!1)}}};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:s,children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[(0,a.jsxs)("h2",{className:"text-lg font-bold text-slate-800 flex items-center",children:[(0,a.jsx)(l.A,{className:"w-5 h-5 mr-3 text-sky-500"}),"Sugest\xe3o de Protocolo Cl\xednico"]}),(0,a.jsx)("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-100",children:(0,a.jsx)(d.A,{className:"w-5 h-5 text-slate-600"})})]}),(0,a.jsx)("main",{className:"flex-1 overflow-y-auto p-6",children:p?(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>u(null),className:"flex items-center text-sm font-semibold text-sky-600 mb-4",children:[(0,a.jsx)(el.A,{className:"w-4 h-4 mr-2"})," Voltar para Sugest\xf5es"]}),r?(0,a.jsx)(ep.E,{className:"h-64 w-full"}):(0,a.jsx)("div",{className:"bg-slate-50 p-4 rounded-lg max-h-96 overflow-y-auto border",children:(0,a.jsx)(V.A,{content:h})})]}):(()=>{var e,t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"text-sm text-slate-600 mb-4",children:["Com base no diagn\xf3stico ",(0,a.jsxs)("strong",{className:"text-slate-800",children:['"',null==(t=n.conditions)||null==(e=t[0])?void 0:e.name,'"']}),", sugerimos os seguintes protocolos:"]}),r?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ep.E,{className:"h-12 w-full"}),(0,a.jsx)(ep.E,{className:"h-12 w-full"})]}):m.length>0?(0,a.jsx)("ul",{className:"space-y-2",children:m.map(e=>(0,a.jsxs)("li",{onClick:()=>y(e),className:"p-3 border rounded-lg hover:bg-sky-50 hover:border-sky-300 cursor-pointer",children:[(0,a.jsx)("h4",{className:"font-semibold text-slate-800",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:e.description})]},e.id))}):(0,a.jsx)("p",{className:"text-center text-slate-500 py-6",children:"Nenhum protocolo sugerido encontrado para este diagn\xf3stico."})]})})()}),p&&(0,a.jsxs)("footer",{className:"flex justify-end items-center p-4 border-t border-slate-200 bg-slate-50",children:[(0,a.jsx)("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 mr-2",children:"Cancelar"}),(0,a.jsxs)("button",{onClick:v,disabled:g||r,className:"px-4 py-2 text-sm font-medium text-white bg-teal-500 rounded-lg hover:bg-teal-600 flex items-center disabled:bg-teal-300",children:[g?(0,a.jsx)(er.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,a.jsx)(et.A,{className:"w-4 h-4 mr-2"}),g?"Aplicando...":"Aplicar Protocolo ao Plano"]})]})]})}):null};var eh=s(78165),eb=s(40336),eg=s(6781),ef=s(73884),ej=s(25040);let ey=e=>{let{title:t,value:s,icon:i,subtitle:n}=e;return(0,a.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-sky-100 text-sky-600 rounded-lg mr-3",children:i}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-500",children:t}),(0,a.jsx)("p",{className:"text-xl font-bold text-slate-800",children:s})]})]}),n&&(0,a.jsx)("p",{className:"text-xs text-slate-400 mt-2",children:n})]})},ev=e=>{let{patient:t,appointments:s,notes:n,plan:o,onMapClick:l,onPointClick:r}=e,{showToast:c}=(0,B.dj)(),[d,m]=(0,i.useState)(""),[x,p]=(0,i.useState)(!1),u=(0,i.useMemo)(()=>{let e=s.filter(e=>e.status===ee.y2.Completed).length,t="N/A",a=o?o.frequencyPerWeek*o.durationWeeks:0;if(o&&a>0){let s=Math.round(e/a*100);t="".concat(s,"%")}let i="N/A",l=n.filter(e=>"number"==typeof e.painScale);if(l.length>=2){let e=l[l.length-1],t=l[0];e&&t&&"number"==typeof e.painScale&&"number"==typeof t.painScale&&(i="".concat(e.painScale,"/10 ➔ ").concat(t.painScale,"/10"))}let r=s.filter(e=>e.status===ee.y2.Scheduled&&e.startTime>new Date).sort((e,t)=>e.startTime.getTime()-t.startTime.getTime())[0];return{completedSessions:e.toString(),packageProgress:t,painEvolution:i,nextAppointment:r?r.startTime.toLocaleDateString("pt-BR"):"Nenhuma",totalSessions:a}},[s,n,o]),h=(0,i.useMemo)(()=>n.filter(e=>"number"==typeof e.painScale).map(e=>({date:e.date,Dor:e.painScale})).reverse(),[n]),b=async()=>{p(!0),m("");try{let e=await ed.Ms(t,n);m(e)}catch(e){c(e.message,"error")}finally{p(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsx)(ey,{title:"Sess\xf5es Realizadas",value:u.completedSessions,icon:(0,a.jsx)(v.A,{size:20})}),(0,a.jsx)(ey,{title:"Progresso do Pacote",value:u.packageProgress,icon:(0,a.jsx)(es.A,{size:20}),subtitle:o?"".concat(u.completedSessions,"/").concat(u.totalSessions||"N/A"," sess\xf5es"):""}),(0,a.jsx)(ey,{title:"Evolu\xe7\xe3o da Dor (EVA)",value:u.painEvolution,icon:(0,a.jsx)(eh.A,{size:20})}),(0,a.jsx)(ey,{title:"Pr\xf3xima Consulta",value:u.nextAppointment,icon:(0,a.jsx)(eb.A,{size:20})})]}),(0,a.jsxs)(Z.A,{title:"Mapa de Dor Interativo",icon:(0,a.jsx)(eg.A,{}),children:[(0,a.jsx)("p",{className:"text-xs text-slate-500 mb-2 -mt-2",children:"Clique no mapa para adicionar um ponto de dor ou em um ponto existente para editar."}),(0,a.jsx)(ej.A,{points:t.painPoints||[],onMapClick:l,onPointClick:r})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm",children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-800 mb-4",children:"Evolu\xe7\xe3o da Dor (EVA)"}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(W.u,{width:"100%",height:"100%",children:(0,a.jsxs)(K.b,{data:h,margin:{top:5,right:20,left:-10,bottom:5},children:[(0,a.jsx)(G.d,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,a.jsx)(U.W,{dataKey:"date",fontSize:12}),(0,a.jsx)(H.h,{domain:[0,10],fontSize:12}),(0,a.jsx)(Y.m,{}),(0,a.jsx)(X.N,{type:"monotone",dataKey:"Dor",stroke:"#ef4444",strokeWidth:2})]})})})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm flex flex-col",children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-800 mb-4",children:"Resumo Cl\xednico com IA"}),(0,a.jsxs)("div",{className:"flex-1 bg-slate-50 p-4 rounded-lg overflow-y-auto min-h-[200px] border",children:[x&&(0,a.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,a.jsx)(er.A,{className:"animate-spin text-sky-500"})}),!x&&d&&(0,a.jsx)(V.A,{content:d}),!x&&!d&&(0,a.jsx)("p",{className:"text-sm text-center text-slate-500 h-full flex items-center justify-center",children:"Clique no bot\xe3o abaixo para gerar um resumo do progresso do paciente."})]}),(0,a.jsxs)("button",{onClick:b,disabled:x||n.length<2,className:"mt-4 w-full flex items-center justify-center bg-sky-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-sky-600 transition-colors disabled:bg-sky-300",children:[(0,a.jsx)(ef.A,{className:"w-4 h-4 mr-2"}),x?"Analisando...":"Gerar Resumo"]})]})]})]})};var eN=s(24341),ew=s(93784),ek=s(61886),eA=s(27212),eC=s(41180);let eD=[{id:"bp_1",patientId:"patient_1",coordinates:{x:.45,y:.25},bodySide:"front",painLevel:7,painType:"acute",bodyRegion:"shoulder",description:"Dor no ombro direito que piora com movimento, especialmente ao levantar o bra\xe7o",symptoms:["Dor aguda","Limita\xe7\xe3o de movimento","Sensibilidade ao toque"],createdAt:new Date("2024-01-15T10:30:00Z"),updatedAt:new Date("2024-01-15T10:30:00Z"),createdBy:"user_1",sessionId:"session_1"},{id:"bp_2",patientId:"patient_1",coordinates:{x:.55,y:.45},bodySide:"front",painLevel:5,painType:"chronic",bodyRegion:"elbow",description:"Rigidez articular no cotovelo com desconforto matinal",symptoms:["Rigidez","Dor latejante","Incha\xe7o"],createdAt:new Date("2024-01-14T09:15:00Z"),updatedAt:new Date("2024-01-14T09:15:00Z"),createdBy:"user_1"},{id:"bp_3",patientId:"patient_1",coordinates:{x:.5,y:.35},bodySide:"back",painLevel:8,painType:"constant",bodyRegion:"lumbar",description:"Dor lombar constante que irradia para as pernas, piora ao ficar sentado",symptoms:["Dor irradiada","Espasmo muscular","Formigamento","Fraqueza"],createdAt:new Date("2024-01-13T14:20:00Z"),updatedAt:new Date("2024-01-13T14:20:00Z"),createdBy:"user_1"},{id:"bp_4",patientId:"patient_1",coordinates:{x:.42,y:.8},bodySide:"front",painLevel:6,painType:"intermittent",bodyRegion:"knee",description:"Dor intermitente no joelho esquerdo, especialmente ap\xf3s atividades",symptoms:["Dor intermitente","Incha\xe7o","Rigidez"],createdAt:new Date("2024-01-12T16:45:00Z"),updatedAt:new Date("2024-01-12T16:45:00Z"),createdBy:"user_1"},{id:"bp_5",patientId:"patient_1",coordinates:{x:.5,y:.15},bodySide:"front",painLevel:4,painType:"acute",bodyRegion:"cervical",description:"Tens\xe3o cervical ap\xf3s longas horas no computador",symptoms:["Tens\xe3o muscular","Dor de cabe\xe7a","Rigidez"],createdAt:new Date("2024-01-11T11:30:00Z"),updatedAt:new Date("2024-01-11T11:30:00Z"),createdBy:"user_1"}],eP=e=>new Promise(t=>setTimeout(t,e)),eS=async e=>{await eP(300);try{return eD.filter(t=>t.patientId===e).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime())}catch(e){throw console.error("Error fetching body points:",e),Error("Failed to fetch body points")}},eT=async e=>{await eP(400);try{var t,s;if(!e.patientId)throw Error("Patient ID is required");if(!e.coordinates)throw Error("Coordinates are required");if(e.painLevel<0||e.painLevel>10)throw Error("Pain level must be between 0-10");if(!(null==(t=e.description)?void 0:t.trim()))throw Error("Description is required");if(!(null==(s=e.symptoms)?void 0:s.length))throw Error("At least one symptom is required");let a={...e,id:"bp_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),createdAt:new Date,updatedAt:new Date};return eD.unshift(a),a}catch(e){throw console.error("Error adding body point:",e),e instanceof Error?e:Error("Failed to add body point")}},eL=async(e,t)=>{await eP(400);let s=eD.findIndex(t=>t.id===e);if(-1===s)throw Error("Ponto n\xe3o encontrado");let a={...eD[s],...t,id:e,created_at:eD[s].created_at};return eD[s]=a,a},eE=async e=>{await eP(300);let t=eD.findIndex(t=>t.id===e);if(-1===t)throw Error("Ponto n\xe3o encontrado");eD.splice(t,1)},eM=async e=>{await eP(350);try{let t=eD.filter(t=>t.patientId===e);if(0===t.length)return{totalPoints:0,averagePainLevel:0,painTrends:[],regionDistribution:{},painTypeDistribution:{},symptomFrequency:{}};let s=t.reduce((e,t)=>{let s=new Date(t.createdAt).toDateString();return e[s]||(e[s]=[]),e[s].push(t),e},{}),a=Object.entries(s).map(e=>{let[t,s]=e;return{date:t,averagePain:Math.round(s.reduce((e,t)=>e+t.painLevel,0)/s.length*10)/10,pointCount:s.length}}).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),i=t.reduce((e,t)=>(e[t.bodyRegion]=(e[t.bodyRegion]||0)+1,e),{}),n=t.reduce((e,t)=>(e[t.painType]=(e[t.painType]||0)+1,e),{}),o=t.reduce((e,t)=>(t.symptoms.forEach(t=>{e[t]=(e[t]||0)+1}),e),{});return{totalPoints:t.length,averagePainLevel:Math.round(t.reduce((e,t)=>e+t.painLevel,0)/t.length*10)/10,painTrends:a,regionDistribution:i,painTypeDistribution:n,symptomFrequency:o}}catch(e){throw console.error("Error calculating analytics:",e),Error("Failed to calculate body map analytics")}},ez={front:{head:{x:.5,y:.08,radius:.05},neck:{x:.5,y:.15,radius:.03},chest:{x:.5,y:.25,radius:.08},leftShoulder:{x:.35,y:.2,radius:.04},rightShoulder:{x:.65,y:.2,radius:.04},leftArm:{x:.25,y:.35,radius:.03},rightArm:{x:.75,y:.35,radius:.03},leftElbow:{x:.2,y:.45,radius:.025},rightElbow:{x:.8,y:.45,radius:.025},leftWrist:{x:.15,y:.55,radius:.02},rightWrist:{x:.85,y:.55,radius:.02},abdomen:{x:.5,y:.4,radius:.06},pelvis:{x:.5,y:.55,radius:.05},leftHip:{x:.42,y:.58,radius:.03},rightHip:{x:.58,y:.58,radius:.03},leftThigh:{x:.42,y:.7,radius:.04},rightThigh:{x:.58,y:.7,radius:.04},leftKnee:{x:.42,y:.8,radius:.025},rightKnee:{x:.58,y:.8,radius:.025},leftShin:{x:.42,y:.9,radius:.02},rightShin:{x:.58,y:.9,radius:.02},leftAnkle:{x:.42,y:.95,radius:.02},rightAnkle:{x:.58,y:.95,radius:.02}},back:{head:{x:.5,y:.08,radius:.05},neck:{x:.5,y:.15,radius:.03},upperBack:{x:.5,y:.25,radius:.08},leftShoulder:{x:.35,y:.2,radius:.04},rightShoulder:{x:.65,y:.2,radius:.04},midBack:{x:.5,y:.4,radius:.06},lowerBack:{x:.5,y:.52,radius:.06},leftGlute:{x:.42,y:.6,radius:.04},rightGlute:{x:.58,y:.6,radius:.04},leftHamstring:{x:.42,y:.72,radius:.04},rightHamstring:{x:.58,y:.72,radius:.04},leftCalf:{x:.42,y:.88,radius:.03},rightCalf:{x:.58,y:.88,radius:.03}}},eI=e=>{let{side:t,points:s,onPointClick:n,onSVGClick:o,selectedPointId:l,isLoading:r=!1,readOnly:c=!1,className:d=""}=e,[m,x]=(0,i.useState)(null),p=(0,i.useMemo)(()=>s.filter(e=>e.bodySide===t),[s,t]),u=(0,i.useCallback)(e=>{if(c||r)return;let s=e.currentTarget.getBoundingClientRect(),a=(e.clientX-s.left)/s.width,i=(e.clientY-s.top)/s.height,n=((e,t,s)=>{for(let[a,i]of Object.entries(ez[s]))if(Math.sqrt(Math.pow(e-i.x,2)+Math.pow(t-i.y,2))<=i.radius)return a;return"other"})(a,i,t);o({x:a,y:i},n)},[c,r,t,o]),h=(0,i.useCallback)((e,t)=>{e.stopPropagation(),n(t)},[n]),b=(0,i.useMemo)(()=>"\n        M 200 60\n        C 190 40, 210 40, 220 60\n        L 220 80\n        C 240 90, 250 120, 260 150\n        L 280 200\n        C 285 250, 280 300, 275 350\n        L 270 400\n        C 268 450, 265 500, 260 550\n        L 250 600\n        L 240 650\n        C 235 700, 240 750, 245 800\n        L 250 850\n        L 255 900\n        L 260 950\n        L 250 1000\n        L 150 1000\n        L 140 950\n        L 145 900\n        L 150 850\n        C 155 800, 160 750, 155 700\n        L 150 650\n        L 140 600\n        L 130 550\n        C 125 500, 122 450, 120 400\n        L 115 350\n        C 110 300, 105 250, 110 200\n        L 130 150\n        C 140 120, 150 90, 170 80\n        L 170 60\n        C 180 40, 200 40, 200 60\n        Z\n      ",[t]);return(0,a.jsxs)("div",{className:"relative w-full max-w-md mx-auto ".concat(d),children:[(0,a.jsxs)("svg",{viewBox:"0 0 400 1000",className:"w-full h-auto cursor-pointer touch-manipulation",onClick:u,role:"img","aria-label":"Mapa corporal - vista ".concat("front"===t?"frontal":"das costas"),children:[(0,a.jsx)(ek.P.path,{d:b,fill:"#f8fafc",stroke:"#e2e8f0",strokeWidth:"2",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5}}),Object.entries(ez[t]).map(e=>{let[t,s]=e;return(0,a.jsx)("circle",{cx:400*s.x,cy:1e3*s.y,r:400*s.radius,fill:"transparent",className:"hover:fill-blue-100 hover:fill-opacity-30 transition-all cursor-pointer","data-region":t},t)}),p.map(e=>(0,a.jsxs)(ek.P.g,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:300,damping:25},children:[(0,a.jsx)("circle",{cx:400*e.coordinates.x+2,cy:1e3*e.coordinates.y+2,r:l===e.id?12:m===e.id?10:8,fill:"rgba(0,0,0,0.15)"}),(0,a.jsx)(ek.P.circle,{cx:400*e.coordinates.x,cy:1e3*e.coordinates.y,r:l===e.id?12:m===e.id?10:8,fill:(e=>e<=3?"#22c55e":e<=6?"#eab308":e<=8?"#f97316":"#ef4444")(e.painLevel),stroke:l===e.id?"#1d4ed8":"#ffffff",strokeWidth:l===e.id?3:2,className:"cursor-pointer",onClick:t=>h(t,e),onMouseEnter:()=>x(e.id),onMouseLeave:()=>x(null),whileHover:{scale:1.2},whileTap:{scale:.9},animate:{scale:l===e.id?1.2:1,stroke:l===e.id?"#1d4ed8":"#ffffff"}}),(0,a.jsx)("text",{x:400*e.coordinates.x,y:1e3*e.coordinates.y+4,textAnchor:"middle",className:"text-xs font-bold fill-white pointer-events-none select-none",style:{fontSize:"12px"},children:e.painLevel}),m===e.id&&(0,a.jsxs)(ek.P.g,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[(0,a.jsx)("rect",{x:400*e.coordinates.x-60,y:1e3*e.coordinates.y-50,width:"120",height:"35",rx:"6",fill:"rgba(0,0,0,0.9)",className:"pointer-events-none"}),(0,a.jsxs)("text",{x:400*e.coordinates.x,y:1e3*e.coordinates.y-35,textAnchor:"middle",className:"text-xs fill-white pointer-events-none select-none",style:{fontSize:"10px"},children:[e.painType," - ",e.painLevel,"/10"]}),(0,a.jsx)("text",{x:400*e.coordinates.x,y:1e3*e.coordinates.y-22,textAnchor:"middle",className:"text-xs fill-gray-300 pointer-events-none select-none",style:{fontSize:"8px"},children:e.bodyRegion})]})]},e.id)),r&&(0,a.jsx)(ek.P.g,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsx)("circle",{cx:"200",cy:"500",r:"20",fill:"none",stroke:"#3b82f6",strokeWidth:"3",strokeLinecap:"round",strokeDasharray:"31.416",strokeDashoffset:"31.416",children:(0,a.jsx)("animate",{attributeName:"stroke-dasharray",dur:"2s",values:"0 31.416;15.708 15.708;0 31.416",repeatCount:"indefinite"})})})]}),(0,a.jsxs)("div",{className:"sr-only",children:[(0,a.jsxs)("p",{children:["Mapa corporal interativo mostrando ",p.length," pontos de dor."]}),(0,a.jsx)("p",{children:"Use as teclas Tab e Enter para navegar pelos pontos."}),p.map(e=>(0,a.jsxs)("button",{onClick:()=>n(e),children:[e.painType," na regi\xe3o ",e.bodyRegion,", n\xedvel ",e.painLevel]},e.id))]})]})};var eR=s(11508),eF=s(6394),eO=s(93536),e_=s(88992),eq=s(13810),eZ=s(22442);let eB={0:"Sem dor",1:"Muito leve",2:"Leve",3:"Moderado baixo",4:"Moderado",5:"Moderado alto",6:"Forte",7:"Muito forte",8:"Intenso",9:"Excruciante",10:"Insuport\xe1vel"},eV=e=>0===e?"#e2e8f0":e<=3?"#22c55e":e<=6?"#eab308":e<=8?"#f97316":"#ef4444",eW=e=>{let{value:t,onChange:s,showValue:n=!0,disabled:o=!1,size:l="medium",showLabels:r=!0,className:c=""}=e,d=(0,i.useMemo)(()=>(e=>{switch(e){case"small":return{container:"gap-1",button:"w-6 h-6 text-xs",value:"text-lg",label:"text-xs"};case"large":return{container:"gap-3",button:"w-12 h-12 text-lg",value:"text-3xl",label:"text-base"};default:return{container:"gap-2",button:"w-8 h-8 text-sm",value:"text-xl",label:"text-sm"}}})(l),[l]),m=e=>{o||s(e)};return(0,a.jsxs)("div",{className:"space-y-4 ".concat(c),children:[n&&(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)(ek.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"font-bold ".concat(d.value),style:{color:eV(t)},children:[t,"/10"]},t),r&&(0,a.jsx)(ek.P.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-gray-600 font-medium ".concat(d.label," mt-1"),children:eB[t]},t)]}),(0,a.jsx)("div",{className:"flex justify-center ".concat(d.container),children:Array.from({length:11},(e,s)=>{let i=t===s,n=eV(s);return(0,a.jsx)(ek.P.button,{type:"button",onClick:()=>m(s),onKeyDown:e=>((e,s)=>{if(!o)switch(e.key){case"Enter":case" ":e.preventDefault(),m(s);break;case"ArrowLeft":case"ArrowDown":e.preventDefault(),t>0&&m(Math.max(0,t-1));break;case"ArrowRight":case"ArrowUp":e.preventDefault(),t<10&&m(Math.min(10,t+1));break;case"Home":e.preventDefault(),m(0);break;case"End":e.preventDefault(),m(10)}})(e,s),disabled:o,className:"\n                ".concat(d.button,"\n                rounded-full font-semibold transition-all duration-200\n                focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n                disabled:opacity-50 disabled:cursor-not-allowed\n                ").concat(i?"shadow-lg ring-2 ring-white":"hover:scale-110","\n              "),style:{backgroundColor:n,color:0===s?"#64748b":"#ffffff",transform:i?"scale(1.2)":"scale(1)",zIndex:i?10:1},whileHover:o?{}:{scale:i?1.2:1.1},whileTap:o?{}:{scale:.95},animate:{scale:i?1.2:1,backgroundColor:n},"aria-label":"N\xedvel de dor ".concat(s,": ").concat(eB[s]),"aria-pressed":i,role:"radio",tabIndex:i?0:-1,children:s},s)})}),(0,a.jsxs)("div",{className:"flex justify-between px-2",children:[(0,a.jsx)("span",{className:"text-gray-500 ".concat(d.label),children:"Sem dor"}),(0,a.jsx)("span",{className:"text-gray-500 ".concat(d.label),children:"Dor m\xe1xima"})]}),(0,a.jsx)("div",{className:"sr-only",children:(0,a.jsx)("p",{children:"Use as setas do teclado para navegar, Enter ou Espa\xe7o para selecionar, Home para ir ao in\xedcio (0), End para ir ao final (10)."})})]})},eK=eZ.Ik({painLevel:eZ.ai().min(0).max(10),painType:eZ.k5(["acute","chronic","intermittent","constant"]),bodyRegion:eZ.k5(["cervical","thoracic","lumbar","sacral","shoulder","elbow","wrist","hip","knee","ankle","head","other"]),description:eZ.Yj().min(1,"Descri\xe7\xe3o \xe9 obrigat\xf3ria").max(500,"Descri\xe7\xe3o muito longa"),symptoms:eZ.YO(eZ.Yj()).min(1,"Pelo menos um sintoma deve ser selecionado")}),eG=["Dor aguda","Dor latejante","Queima\xe7\xe3o","Formigamento","Dorm\xeancia","Rigidez","Incha\xe7o","Sensibilidade ao toque","Dor irradiada","Espasmo muscular","Fraqueza","Limita\xe7\xe3o de movimento"],eU={acute:"Aguda",chronic:"Cr\xf4nica",intermittent:"Intermitente",constant:"Constante"},eH={cervical:"Cervical",thoracic:"Tor\xe1cica",lumbar:"Lombar",sacral:"Sacral",shoulder:"Ombro",elbow:"Cotovelo",wrist:"Punho",hip:"Quadril",knee:"Joelho",ankle:"Tornozelo",head:"Cabe\xe7a",other:"Outro"},eY=e=>{let{point:t,isOpen:s,onClose:n,onSave:o,onDelete:l,coordinates:r,bodyRegion:c}=e,[m,x]=(0,i.useState)(!1),[p,u]=(0,i.useState)(""),h=!!t,{control:b,handleSubmit:g,reset:f,watch:j,setValue:y,formState:{errors:v,isValid:N}}=(0,e_.mN)({resolver:(0,eq.u)(eK),defaultValues:{painLevel:5,painType:"acute",bodyRegion:"other",description:"",symptoms:[]},mode:"onChange"}),w=j("symptoms");j("painLevel"),(0,i.useEffect)(()=>{t?f({painLevel:t.painLevel,painType:t.painType,bodyRegion:t.bodyRegion,description:t.description,symptoms:t.symptoms||[]}):f({painLevel:5,painType:"acute",bodyRegion:c||"other",description:"",symptoms:[]})},[t,c,f]);let k=(0,i.useCallback)(async e=>{x(!0);try{await o({...e,coordinates:r||(null==t?void 0:t.coordinates)||{x:.5,y:.5},updatedAt:new Date})}catch(e){console.error("Error saving point:",e)}finally{x(!1)}},[o,r,t]),C=(0,i.useCallback)(e=>{let t=w||[];y("symptoms",t.includes(e)?t.filter(t=>t!==e):[...t,e],{shouldValidate:!0})},[w,y]),D=(0,i.useCallback)(()=>{p.trim()&&!w.includes(p.trim())&&(y("symptoms",[...w,p.trim()],{shouldValidate:!0}),u(""))},[p,w,y]),P=(0,i.useCallback)(async()=>{if(l&&window.confirm("Tem certeza que deseja remover este ponto de dor?"))try{x(!0),await l()}catch(e){console.error("Error deleting point:",e)}finally{x(!1)}},[l]);return s?(0,a.jsx)(eA.N,{children:(0,a.jsx)(ek.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:n,children:(0,a.jsx)(ek.P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",duration:.3},className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("form",{onSubmit:g(k),className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b border-gray-200 pb-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:h?"Editar Ponto de Dor":"Adicionar Ponto de Dor"}),(0,a.jsx)("button",{type:"button",onClick:n,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Fechar modal",children:(0,a.jsx)(d.A,{size:24})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700",children:"N\xedvel de Dor (0-10) *"}),(0,a.jsx)(e_.xI,{name:"painLevel",control:b,render:e=>{let{field:t}=e;return(0,a.jsx)(eW,{value:t.value,onChange:t.onChange,showValue:!0})}}),v.painLevel&&(0,a.jsxs)("p",{className:"text-red-500 text-sm flex items-center gap-1",children:[(0,a.jsx)(eR.A,{size:16}),v.painLevel.message]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de Dor *"}),(0,a.jsx)(e_.xI,{name:"painType",control:b,render:e=>{let{field:t}=e;return(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(eU).map(e=>{let[s,i]=e;return(0,a.jsxs)("label",{className:"flex items-center p-3 border rounded-lg cursor-pointer transition-all ".concat(t.value===s?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300"),children:[(0,a.jsx)("input",{type:"radio",value:s,checked:t.value===s,onChange:e=>t.onChange(e.target.value),className:"sr-only"}),(0,a.jsx)("span",{className:"font-medium",children:i})]},s)})})}})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700",children:"Regi\xe3o do Corpo *"}),(0,a.jsx)(e_.xI,{name:"bodyRegion",control:b,render:e=>{let{field:t}=e;return(0,a.jsx)("select",{...t,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:Object.entries(eH).map(e=>{let[t,s]=e;return(0,a.jsx)("option",{value:t,children:s},t)})})}})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700",children:"Sintomas *"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3",children:eG.map(e=>(0,a.jsxs)("label",{className:"flex items-center p-2 rounded-md cursor-pointer transition-all ".concat(w.includes(e)?"bg-blue-50 text-blue-700":"hover:bg-gray-50"),children:[(0,a.jsx)("input",{type:"checkbox",checked:w.includes(e),onChange:()=>C(e),className:"mr-2 text-blue-500 focus:ring-blue-500 rounded"}),(0,a.jsx)("span",{className:"text-sm",children:e})]},e))}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:p,onChange:e=>u(e.target.value),placeholder:"Adicionar sintoma personalizado",className:"flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onKeyDown:e=>"Enter"===e.key&&(e.preventDefault(),D())}),(0,a.jsx)("button",{type:"button",onClick:D,disabled:!p.trim(),className:"px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,a.jsx)(A.A,{size:16})})]}),v.symptoms&&(0,a.jsxs)("p",{className:"text-red-500 text-sm flex items-center gap-1",children:[(0,a.jsx)(eR.A,{size:16}),v.symptoms.message]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700",children:"Descri\xe7\xe3o Detalhada *"}),(0,a.jsx)(e_.xI,{name:"description",control:b,render:e=>{let{field:t}=e;return(0,a.jsx)("textarea",{...t,rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",placeholder:"Descreva a dor, quando come\xe7ou, o que a piora ou melhora, etc."})}}),v.description&&(0,a.jsxs)("p",{className:"text-red-500 text-sm flex items-center gap-1",children:[(0,a.jsx)(eR.A,{size:16}),v.description.message]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 border-t border-gray-200",children:[(0,a.jsxs)("button",{type:"submit",disabled:!N||m,className:"flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex-1",children:[(0,a.jsx)(eF.A,{size:20}),m?"Salvando...":"Salvar"]}),h&&l&&(0,a.jsxs)("button",{type:"button",onClick:P,disabled:m,className:"flex items-center justify-center gap-2 px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[(0,a.jsx)(eO.A,{size:20}),"Remover"]}),(0,a.jsx)("button",{type:"button",onClick:n,disabled:m,className:"flex items-center justify-center gap-2 px-6 py-3 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Cancelar"})]})]})})})}):null};var eX=s(31462),eQ=s(44898),eJ=s(97075),e$=s(82470),e0=s(88246),e1=s(42320),e2=s(12347),e5=s(64041),e4=s(5427),e3=s(40394),e6=s(66762),e8=s(77615),e7=s(68212),e9=s(82734);let te=[{label:"7 dias",days:7},{label:"30 dias",days:30},{label:"90 dias",days:90},{label:"6 meses",days:180},{label:"1 ano",days:365}],tt={acute:"#ef4444",chronic:"#f97316",intermittent:"#eab308",constant:"#8b5cf6"},ts=e=>{let{points:t,selectedDate:s,onDateChange:n,analytics:o,className:l=""}=e,[r,c]=(0,i.useState)("evolution"),[d,m]=(0,i.useState)(30),[x,p]=(0,i.useState)(!1),[u,h]=(0,i.useState)(["acute","chronic","intermittent","constant"]),b=(0,i.useMemo)(()=>{let e=(0,e8.e)(new Date,d);return t.filter(t=>new Date(t.createdAt)>=e&&u.includes(t.painType))},[t,d,u]),g=(0,i.useMemo)(()=>Object.entries(b.reduce((e,t)=>{let s=(0,e7.GP)(new Date(t.createdAt),"dd/MM",{locale:e9.F});return e[s]||(e[s]=[]),e[s].push(t),e},{})).map(e=>{let[t,s]=e;return{date:t,avgPain:Number((s.reduce((e,t)=>e+t.painLevel,0)/s.length).toFixed(1)),maxPain:Math.max(...s.map(e=>e.painLevel)),minPain:Math.min(...s.map(e=>e.painLevel)),pointCount:s.length,acutePain:s.filter(e=>"acute"===e.painType).length,chronicPain:s.filter(e=>"chronic"===e.painType).length}}).sort((e,t)=>{let[s,a]=e.date.split("/").map(Number),[i,n]=t.date.split("/").map(Number);return new Date(2024,a-1,s).getTime()-new Date(2024,n-1,i).getTime()}),[b]),f=(0,i.useMemo)(()=>Object.entries(o.regionDistribution).map(e=>{let[t,s]=e;return{region:t.charAt(0).toUpperCase()+t.slice(1),count:s,fill:"hsl(".concat(360*Math.random(),", 70%, 60%)")}}),[o.regionDistribution]),j=(0,i.useMemo)(()=>Object.entries(o.symptomFrequency).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).slice(0,8).map(e=>{let[t,s]=e;return{symptom:t.length>15?t.substring(0,15)+"...":t,frequency:s}}),[o.symptomFrequency]),y=(0,i.useCallback)(e=>{h(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[]),N=e=>{let{active:t,payload:s,label:i}=e;return t&&s&&s.length?(0,a.jsxs)("div",{className:"bg-white p-4 border border-slate-200 rounded-lg shadow-lg",children:[(0,a.jsx)("p",{className:"font-semibold text-slate-800 mb-2",children:i}),(0,a.jsx)("div",{className:"space-y-1",children:s.map((e,t)=>(0,a.jsxs)("p",{className:"text-sm",style:{color:e.color},children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.name,":"]})," ",e.value,"avgPain"===e.dataKey&&"/10"]},t))})]}):null},w=(0,i.useMemo)(()=>{if(g.length<2)return{direction:"stable",value:0};let e=g.slice(-3),t=g.slice(-6,-3);if(0===e.length||0===t.length)return{direction:"stable",value:0};let s=e.reduce((e,t)=>e+t.avgPain,0)/e.length-t.reduce((e,t)=>e+t.avgPain,0)/t.length;return{direction:s>.5?"up":s<-.5?"down":"stable",value:Number(Math.abs(s).toFixed(1))}},[g]);return(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 space-y-6 ".concat(l),children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[(0,a.jsx)(e5.A,{className:"w-5 h-5"}),"Timeline de Evolu\xe7\xe3o"]}),(0,a.jsxs)("p",{className:"text-sm text-slate-600 mt-1",children:["An\xe1lise temporal dos pontos de dor - ",b.length," pontos em ",d," dias"]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("select",{value:d,onChange:e=>m(Number(e.target.value)),className:"px-3 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:te.map(e=>(0,a.jsx)("option",{value:e.days,children:e.label},e.days))}),(0,a.jsx)("button",{onClick:()=>p(!x),className:"px-3 py-2 rounded-lg text-sm transition-colors ".concat(x?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:(0,a.jsx)(e4.A,{className:"w-4 h-4"})})]})]}),(0,a.jsx)(eA.N,{children:x&&(0,a.jsxs)(ek.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border border-slate-200 rounded-lg p-4 bg-slate-50",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Filtros"}),(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-slate-600 mb-2",children:"Tipos de Dor:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(tt).map(e=>{let[t,s]=e;return(0,a.jsxs)("label",{className:"flex items-center gap-2 px-3 py-1 rounded-full text-sm cursor-pointer transition-all ".concat(u.includes(t)?"bg-white border-2":"bg-white border border-slate-300 opacity-60"),style:{borderColor:u.includes(t)?s:void 0},children:[(0,a.jsx)("input",{type:"checkbox",checked:u.includes(t),onChange:()=>y(t),className:"sr-only"}),(0,a.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s}}),t.charAt(0).toUpperCase()+t.slice(1)]},t)})})]})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 text-center",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:["up"===w.direction?(0,a.jsx)(eC.A,{className:"w-5 h-5 text-red-500"}):"down"===w.direction?(0,a.jsx)(eh.A,{className:"w-5 h-5 text-green-500"}):(0,a.jsx)(v.A,{className:"w-5 h-5 text-slate-500"}),(0,a.jsx)("span",{className:"font-semibold ".concat("up"===w.direction?"text-red-600":"down"===w.direction?"text-green-600":"text-slate-600"),children:"up"===w.direction?"Piorando":"down"===w.direction?"Melhorando":"Est\xe1vel"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-slate-800",children:w.value>0?"\xb1".concat(w.value):"0.0"}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:"Varia\xe7\xe3o m\xe9dia"})]}),(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:o.averagePainLevel.toFixed(1)}),(0,a.jsx)("div",{className:"text-sm text-blue-600 font-medium",children:"Dor M\xe9dia Geral"}),(0,a.jsxs)("div",{className:"text-xs text-slate-500",children:["\xdaltimos ",d," dias"]})]}),(0,a.jsxs)("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:b.filter(e=>e.painLevel>=7).length}),(0,a.jsx)("div",{className:"text-sm text-orange-600 font-medium",children:"Epis\xf3dios Intensos"}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:"Dor ≥ 7"})]})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:[{key:"evolution",label:"Evolu\xe7\xe3o",icon:v.A},{key:"distribution",label:"Distribui\xe7\xe3o",icon:e3.A},{key:"symptoms",label:"Sintomas",icon:e6.A},{key:"comparison",label:"Compara\xe7\xe3o",icon:e6.A}].map(e=>{let{key:t,label:s,icon:i}=e;return(0,a.jsxs)("button",{onClick:()=>c(t),className:"flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ".concat(r===t?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:[(0,a.jsx)(i,{className:"w-4 h-4"}),s]},t)})}),(0,a.jsx)(ek.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-white rounded-lg border border-slate-200 p-4",children:(()=>{switch(r){case"evolution":return(0,a.jsx)(W.u,{width:"100%",height:300,children:(0,a.jsxs)(eX.Q,{data:g,children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"painGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),(0,a.jsx)("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:.1})]})}),(0,a.jsx)(G.d,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,a.jsx)(U.W,{dataKey:"date",tick:{fontSize:12}}),(0,a.jsx)(H.h,{domain:[0,10],tick:{fontSize:12}}),(0,a.jsx)(Y.m,{content:(0,a.jsx)(N,{})}),(0,a.jsx)(eQ.Gk,{type:"monotone",dataKey:"avgPain",stroke:"#3b82f6",fill:"url(#painGradient)",strokeWidth:2}),(0,a.jsx)(X.N,{type:"monotone",dataKey:"maxPain",stroke:"#ef4444",strokeWidth:2,strokeDasharray:"5 5",dot:{fill:"#ef4444",r:3}})]})});case"distribution":return(0,a.jsx)(W.u,{width:"100%",height:300,children:(0,a.jsxs)(eJ.r,{children:[(0,a.jsx)(e$.F,{data:f,cx:"50%",cy:"50%",outerRadius:80,dataKey:"count",label:e=>{let{region:t,count:s}=e;return"".concat(t,": ").concat(s)},children:f.map((e,t)=>(0,a.jsx)(e0.f,{fill:e.fill},"cell-".concat(t)))}),(0,a.jsx)(Y.m,{})]})});case"symptoms":return(0,a.jsx)(W.u,{width:"100%",height:300,children:(0,a.jsxs)(e1.E,{data:j,layout:"horizontal",children:[(0,a.jsx)(G.d,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,a.jsx)(U.W,{type:"number",tick:{fontSize:12}}),(0,a.jsx)(H.h,{dataKey:"symptom",type:"category",width:100,tick:{fontSize:11}}),(0,a.jsx)(Y.m,{}),(0,a.jsx)(e2.y,{dataKey:"frequency",fill:"#8b5cf6",radius:[0,4,4,0]})]})});case"comparison":return(0,a.jsx)(W.u,{width:"100%",height:300,children:(0,a.jsxs)(e1.E,{data:g,children:[(0,a.jsx)(G.d,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,a.jsx)(U.W,{dataKey:"date",tick:{fontSize:12}}),(0,a.jsx)(H.h,{tick:{fontSize:12}}),(0,a.jsx)(Y.m,{content:(0,a.jsx)(N,{})}),(0,a.jsx)(e2.y,{dataKey:"acutePain",stackId:"pain",fill:"#ef4444",name:"Dor Aguda"}),(0,a.jsx)(e2.y,{dataKey:"chronicPain",stackId:"pain",fill:"#f97316",name:"Dor Cr\xf4nica"})]})});default:return null}})()},r)]})};var ta=s(40258),ti=s(69244),tn=s(95159);let to=[{level:"0",color:"#e2e8f0",label:"Sem dor",description:"Aus\xeancia completa de desconforto"},{level:"1-3",color:"#22c55e",label:"Leve",description:"Desconforto m\xednimo, n\xe3o interfere nas atividades"},{level:"4-6",color:"#eab308",label:"Moderada",description:"Interfere moderadamente nas atividades di\xe1rias"},{level:"7-8",color:"#f97316",label:"Intensa",description:"Interfere significativamente nas atividades"},{level:"9-10",color:"#ef4444",label:"Severa",description:"Dor incapacitante, impede atividades b\xe1sicas"}],tl=[{type:"acute",label:"Aguda",description:"Dor s\xfabita e intensa, geralmente de curta dura\xe7\xe3o"},{type:"chronic",label:"Cr\xf4nica",description:"Dor persistente por mais de 3-6 meses"},{type:"intermittent",label:"Intermitente",description:"Dor que vai e vem em epis\xf3dios"},{type:"constant",label:"Constante",description:"Dor cont\xednua sem intervalos de al\xedvio"}],tr=[{action:"Clique no corpo",description:"Adicionar novo ponto de dor"},{action:"Clique no ponto",description:"Editar ponto existente"},{action:"Alterar visualiza\xe7\xe3o",description:"Trocar entre frente e costas"},{action:"Usar timeline",description:"Analisar evolu\xe7\xe3o temporal"}],tc=e=>{let{expanded:t=!1,className:s="",showHelp:n=!0}=e,[o,l]=(0,i.useState)(t),[r,c]=(0,i.useState)(!1);return(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 ".concat(s),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ta.A,{className:"w-5 h-5 text-slate-600"}),(0,a.jsx)("h4",{className:"font-semibold text-slate-800",children:"Legenda"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[n&&(0,a.jsx)("button",{onClick:()=>c(!r),className:"p-2 rounded-lg transition-colors ".concat(r?"bg-blue-100 text-blue-600":"text-slate-400 hover:text-slate-600 hover:bg-slate-100"),"aria-label":"Mostrar/ocultar guia de uso",children:(0,a.jsx)(ti.A,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>l(!o),className:"p-2 rounded-lg transition-colors ".concat(o?"bg-blue-100 text-blue-600":"text-slate-400 hover:text-slate-600 hover:bg-slate-100"),"aria-label":"Expandir/recolher legenda",children:(0,a.jsx)(tn.A,{className:"w-4 h-4"})})]})]}),(0,a.jsx)(eA.N,{children:r&&(0,a.jsx)(ek.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-b border-slate-200",children:(0,a.jsxs)("div",{className:"p-4 bg-blue-50",children:[(0,a.jsxs)("h5",{className:"font-medium text-blue-800 mb-3 flex items-center gap-2",children:[(0,a.jsx)(ti.A,{className:"w-4 h-4"}),"Como usar o mapa corporal"]}),(0,a.jsx)("div",{className:"space-y-2",children:tr.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-3 text-sm",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"font-medium text-blue-700",children:[e.action,":"]})," ",(0,a.jsx)("span",{className:"text-blue-600",children:e.description})]})]},t))})]})})}),(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-medium text-slate-700 mb-3",children:"Escala de Dor (0-10)"}),(0,a.jsx)("div",{className:"space-y-2",children:to.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full border border-white shadow-sm flex-shrink-0",style:{backgroundColor:e.color}}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-slate-800",children:e.level}),(0,a.jsx)("span",{className:"text-sm text-slate-600",children:e.label})]}),o&&(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:e.description})]})]},t))})]}),o&&(0,a.jsxs)(ek.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"border-t border-slate-200 pt-4",children:[(0,a.jsx)("h5",{className:"font-medium text-slate-700 mb-3",children:"Tipos de Dor"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-2",children:tl.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-3 p-2 bg-slate-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-slate-400 rounded-full mt-1 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-slate-800",children:e.label}),(0,a.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:e.description})]})]},t))})]}),(0,a.jsxs)("div",{className:"border-t border-slate-200 pt-4",children:[(0,a.jsx)("h5",{className:"font-medium text-slate-700 mb-3",children:"Indicadores Visuais"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-6 h-6 bg-blue-500 rounded-full border-2 border-blue-700"}),(0,a.jsx)("div",{className:"absolute inset-0 rounded-full animate-ping bg-blue-400 opacity-75"})]}),(0,a.jsx)("span",{className:"text-sm text-slate-600",children:"Ponto selecionado"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-6 h-6 bg-orange-500 rounded-full shadow-lg transform scale-110"}),(0,a.jsx)("span",{className:"text-sm text-slate-600",children:"Ponto em foco (hover)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full"})]}),(0,a.jsx)("span",{className:"text-sm text-slate-600",children:"Evolu\xe7\xe3o temporal"})]})]})]}),o&&(0,a.jsxs)(ek.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"border-t border-slate-200 pt-4",children:[(0,a.jsx)("h5",{className:"font-medium text-slate-700 mb-3",children:"Acessibilidade"}),(0,a.jsxs)("div",{className:"text-xs text-slate-600 space-y-1",children:[(0,a.jsx)("p",{children:"• Use Tab para navegar pelos pontos"}),(0,a.jsx)("p",{children:"• Enter ou Espa\xe7o para selecionar"}),(0,a.jsx)("p",{children:"• Setas para navegar na escala de dor"}),(0,a.jsx)("p",{children:"• Suporte a leitores de tela"})]})]}),(0,a.jsx)("div",{className:"border-t border-slate-200 pt-4 text-center",children:(0,a.jsx)("button",{onClick:()=>l(!o),className:"text-xs text-slate-500 hover:text-slate-700 transition-colors",children:o?"Mostrar menos":"Mostrar mais detalhes"})})]})]})},td=e=>{var t;let{patient:s,sessionId:n,className:o="",readOnly:l=!1,showTimeline:r=!0,showAnalytics:c=!0}=e,{state:d,actions:{addPoint:m,updatePoint:x,deletePoint:p,selectPoint:u,clearSelection:h,switchSide:b,setTimelineDate:g,refreshData:f},analytics:j,isLoading:y,error:N}=((e,t)=>{let{showToast:s}=(0,B.dj)(),[a,n]=(0,i.useState)({points:[],selectedPoint:null,activeSide:"front",timelineDate:new Date,isLoading:!1,error:null}),[o,l]=(0,i.useState)({totalPoints:0,averagePainLevel:0,painTrends:[],regionDistribution:{},painTypeDistribution:{},symptomFrequency:{}}),[r,c]=(0,i.useState)(!1),[d,m]=(0,i.useState)(null),x=(0,i.useCallback)(async()=>{c(!0),m(null);try{let[t,s]=await Promise.all([eS(e),eM(e)]);n(e=>({...e,points:t,isLoading:!1,error:null})),l(s)}catch(t){let e=t.message||"Failed to fetch body map data";m(e),n(t=>({...t,isLoading:!1,error:e}))}finally{c(!1)}},[e]);return(0,i.useEffect)(()=>{x()},[x]),{state:a,analytics:o,actions:(0,i.useMemo)(()=>({addPoint:async t=>{c(!0);try{let a=await eT(t);n(e=>({...e,points:[a,...e.points]}));let i=await eM(e);l(i),s("Ponto adicionado com sucesso!","success")}catch(e){throw s(e.message||"Erro ao adicionar ponto","error"),e}finally{c(!1)}},updatePoint:async(t,a)=>{c(!0);try{let i=await eL(t,a);n(e=>({...e,points:e.points.map(e=>e.id===t?i:e)}));let o=await eM(e);l(o),s("Ponto atualizado com sucesso!","success")}catch(e){throw s(e.message||"Erro ao atualizar ponto","error"),e}finally{c(!1)}},deletePoint:async t=>{c(!0);try{await eE(t),n(e=>{var s;return{...e,points:e.points.filter(e=>e.id!==t),selectedPoint:(null==(s=e.selectedPoint)?void 0:s.id)===t?null:e.selectedPoint}});let a=await eM(e);l(a),s("Ponto removido com sucesso!","success")}catch(e){throw s(e.message||"Erro ao remover ponto","error"),e}finally{c(!1)}},selectPoint:e=>{n(t=>({...t,selectedPoint:e}))},clearSelection:()=>{n(e=>({...e,selectedPoint:null}))},switchSide:e=>{n(t=>({...t,activeSide:e,selectedPoint:null}))},setTimelineDate:e=>{n(t=>({...t,timelineDate:e}))},refreshData:async()=>{await x()},undoLastAction:()=>{console.log("Undo functionality would be implemented here")},redoLastAction:()=>{console.log("Redo functionality would be implemented here")}}),[e,s,x]),isLoading:r,error:d}})(s.id,0),{showToast:w}=(0,B.dj)(),[k,A]=(0,i.useState)(!1),[C,D]=(0,i.useState)(null),P=(0,i.useCallback)((e,t)=>{l||(D(e),A(!0))},[l]),S=(0,i.useCallback)(e=>{u(e),A(!0)},[u]),T=(0,i.useCallback)(async e=>{try{if(d.selectedPoint)await x(d.selectedPoint.id,e),w("Ponto atualizado com sucesso!","success");else if(C){let t={patientId:s.id,coordinates:C,bodySide:d.activeSide,createdBy:"current-user",sessionId:n,...e};await m(t),w("Ponto adicionado com sucesso!","success")}A(!1),D(null),h()}catch(e){w(e.message||"Erro ao salvar ponto","error")}},[d.selectedPoint,C,d.activeSide,s.id,n,x,m,h,w]),L=(0,i.useCallback)(async e=>{try{await p(e),w("Ponto removido com sucesso!","success"),A(!1),h()}catch(e){w(e.message||"Erro ao remover ponto","error")}},[p,h,w]),E=(0,i.useMemo)(()=>({totalPoints:j.totalPoints,averagePain:j.averagePainLevel,highPainPoints:d.points.filter(e=>e.painLevel>=7).length,recentTrend:j.painTrends.length>=2?j.painTrends[j.painTrends.length-1].averagePain-j.painTrends[j.painTrends.length-2].averagePain:0}),[j,d.points]);return N?(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[(0,a.jsx)(v.A,{className:"w-8 h-8 text-red-500 mx-auto mb-2"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Erro no Mapa Corporal"}),(0,a.jsx)("p",{className:"text-red-600 mb-4",children:N}),(0,a.jsx)("button",{onClick:f,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Tentar Novamente"})]}):(0,a.jsxs)("div",{className:"space-y-6 ".concat(o),children:[c&&(0,a.jsxs)(ek.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-slate-50 rounded-xl p-4 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-slate-800",children:E.totalPoints}),(0,a.jsx)("div",{className:"text-sm text-slate-600",children:"Pontos Total"})]}),(0,a.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:E.averagePain.toFixed(1)}),(0,a.jsx)("div",{className:"text-sm text-blue-600",children:"Dor M\xe9dia"})]}),(0,a.jsxs)("div",{className:"bg-red-50 rounded-xl p-4 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600",children:E.highPainPoints}),(0,a.jsx)("div",{className:"text-sm text-red-600",children:"Dor Intensa (7+)"})]}),(0,a.jsxs)("div",{className:"bg-green-50 rounded-xl p-4 text-center",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)(eC.A,{className:"w-5 h-5 ".concat(E.recentTrend>0?"text-red-500":"text-green-500")}),(0,a.jsxs)("span",{className:"text-lg font-bold ".concat(E.recentTrend>0?"text-red-600":"text-green-600"),children:[E.recentTrend>0?"+":"",E.recentTrend.toFixed(1)]})]}),(0,a.jsx)("div",{className:"text-sm text-slate-600",children:"Tend\xeancia"})]})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-1 flex",children:[(0,a.jsx)("button",{onClick:()=>b("front"),className:"px-6 py-2 rounded-lg transition-all ".concat("front"===d.activeSide?"bg-blue-500 text-white shadow-sm":"text-slate-600 hover:text-slate-800"),children:"Vista Frontal"}),(0,a.jsx)("button",{onClick:()=>b("back"),className:"px-6 py-2 rounded-lg transition-all ".concat("back"===d.activeSide?"bg-blue-500 text-white shadow-sm":"text-slate-600 hover:text-slate-800"),children:"Vista das Costas"})]})}),(0,a.jsx)(ek.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:"bg-white rounded-2xl border border-slate-200 p-6",children:(0,a.jsx)(eI,{side:d.activeSide,points:d.points,onPointClick:S,onSVGClick:P,selectedPointId:null==(t=d.selectedPoint)?void 0:t.id,isLoading:y,readOnly:l})},d.activeSide),(0,a.jsx)(tc,{}),r&&(0,a.jsx)(ts,{points:d.points,selectedDate:d.timelineDate,onDateChange:g,analytics:j}),(0,a.jsx)(eA.N,{children:k&&(0,a.jsx)(eY,{point:d.selectedPoint,isOpen:k,onClose:()=>{A(!1),D(null),h()},onSave:T,onDelete:d.selectedPoint?()=>L(d.selectedPoint.id):void 0,coordinates:C,bodyRegion:"other"})})]})},tm=e=>{let{patient:t}=e;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(td,{patient:t,className:"w-full",showTimeline:!0,showAnalytics:!0,readOnly:!1}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(ew.A,{className:"w-4 h-4 text-blue-600"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-blue-800 mb-2",children:"Sistema de Mapeamento Corporal Profissional"}),(0,a.jsxs)("div",{className:"text-sm text-blue-700 space-y-1",children:[(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"An\xe1lise Temporal:"})," Acompanhe a evolu\xe7\xe3o da dor ao longo do tempo"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"Distribui\xe7\xe3o Regional:"})," Visualize padr\xf5es de dor por regi\xe3o corporal"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"Sintomas Detalhados:"})," Registre sintomas espec\xedficos para cada ponto"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"Tend\xeancias Inteligentes:"})," Identifique melhorias ou pioras automaticamente"]})]})]})]})})]})};var tx=s(87107),tp=s(45977);let tu=e=>{let{icon:t,label:s,value:i}=e;return(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-10 w-10 flex items-center justify-center bg-slate-100 rounded-lg text-slate-600",children:t}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-500",children:s}),(0,a.jsx)("div",{className:"text-sm font-semibold text-slate-800",children:i})]})]})},th=e=>{let{plan:t,onSuggestProtocol:s}=e;return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm",children:[(0,a.jsxs)("div",{className:"border-b border-slate-200 pb-4 mb-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-lg text-slate-800",children:"Plano de Tratamento"}),(0,a.jsxs)("p",{className:"text-sm text-slate-500",children:["Diagn\xf3stico COFFITO: ",t.coffitoDiagnosisCodes]})]}),(0,a.jsxs)("button",{onClick:s,className:"inline-flex items-center text-sm font-medium text-sky-600 bg-sky-50 border border-sky-200 rounded-lg hover:bg-sky-100 px-3 py-1.5 transition-colors",children:[(0,a.jsx)(l.A,{className:"w-4 h-4 mr-2"})," Sugerir Protocolo"]})]}),(0,a.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h5",{className:"font-semibold text-sky-600 flex items-center mb-2",children:[(0,a.jsx)(r.A,{className:"w-4 h-4 mr-2"})," Objetivos Principais"]}),(0,a.jsx)("p",{className:"text-slate-600 pl-6",children:t.treatmentGoals})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h5",{className:"font-semibold text-sky-600 flex items-center mb-2",children:[(0,a.jsx)(c.A,{className:"w-4 h-4 mr-2"})," Exerc\xedcios Prescritos"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 pl-6",children:(t.exercises||[]).map(e=>(0,a.jsxs)("span",{className:"px-3 py-1 text-sm bg-slate-100 text-slate-800 rounded-md shadow-sm",children:[e.exerciseName," (",e.sets,"x",e.repetitions,")"]},e.id))})]})]})]})},tb=e=>{let{note:t,onClose:s}=e;return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:s,children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("header",{className:"flex justify-between items-center p-4 border-b",children:[(0,a.jsxs)("h3",{className:"font-bold text-lg text-slate-800",children:["Sess\xe3o #",t.sessionNumber," - ",t.date]}),(0,a.jsx)("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-100",children:(0,a.jsx)(d.A,{className:"w-5 h-5"})})]}),(0,a.jsxs)("main",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"font-semibold text-sky-600 block mb-1",children:"S (Subjetivo):"})," ",(0,a.jsx)(V.A,{content:t.subjective})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"font-semibold text-sky-600 block mb-1",children:"O (Objetivo):"})," ",(0,a.jsx)(V.A,{content:t.objective})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"font-semibold text-sky-600 block mb-1",children:"A (Avalia\xe7\xe3o):"})," ",(0,a.jsx)(V.A,{content:t.assessment})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"font-semibold text-sky-600 block mb-1",children:"P (Plano):"})," ",(0,a.jsx)(V.A,{content:t.plan})]})]})]})}):null},tg=e=>{let{icon:t,label:s,isActive:i,onClick:n}=e;return(0,a.jsxs)("button",{onClick:n,className:"flex items-center whitespace-nowrap py-3 px-4 font-medium text-sm rounded-t-lg border-b-2 ".concat(i?"border-sky-500 text-sky-600 bg-white":"border-transparent text-slate-500 hover:text-slate-700 hover:bg-slate-50"),children:[(0,a.jsx)(t,{className:"w-5 h-5 mr-2"})," ",s]})},tf=()=>{var e;let t=n.g(),s=window.__selectedPatientId||t.id,{therapists:l}=(0,eo.Ez)(),{user:r}=(0,tp.W6)(),[c,d]=(0,i.useState)(null),[V,W]=(0,i.useState)([]),[K,G]=(0,i.useState)([]),[U,H]=(0,i.useState)(void 0),[Y,X]=(0,i.useState)([]),[Q,et]=(0,i.useState)([]),[es,ea]=(0,i.useState)(!0),[ei,el]=(0,i.useState)(null),[er,ec]=(0,i.useState)("dashboard"),[ed,em]=(0,i.useState)(!1),[ex,ep]=(0,i.useState)(!1),[eh,eb]=(0,i.useState)(null),[eg,ef]=(0,i.useState)(!1),[ej,ey]=(0,i.useState)(!1),ew=(0,i.useMemo)(()=>{if(!r||!s)return!1;switch(r.role){case ee.Xh.Patient:return r.patientId===s;case ee.Xh.EducadorFisico:case ee.Xh.Therapist:case ee.Xh.Admin:return!0;default:return!1}},[r,s]),[ek,eA]=(0,i.useState)({isOpen:!1,pointToEdit:null}),[eC,eD]=(0,i.useState)(null),[eP,eS]=(0,i.useState)(null),{showToast:eT}=(0,B.dj)(),eL=(0,i.useCallback)(async()=>{if(s){ea(!0);try{let[e,t,a,i,n,o]=await Promise.all([T.mQ(s),L.lV(s),E.z0(s),M.bb(s),z.JQ(),I.Uh(s)]);if(!e)return void el("Paciente n\xe3o encontrado.");d(e),G(t),H(a),X(i),et(n.filter(e=>e.patientId===s)),W(o),el(null)}catch(e){el("Falha ao carregar dados do paciente."),console.error(e)}finally{ea(!1)}}},[s]);(0,i.useEffect)(()=>{eL()},[eL]),(0,i.useEffect)(()=>{let e=()=>eL();return tx.g.on("appointments:changed",e),tx.g.on("notes:changed",e),tx.g.on("treatmentPlans:changed",e),tx.g.on("patients:changed",e),()=>{tx.g.off("appointments:changed",e),tx.g.off("notes:changed",e),tx.g.off("treatmentPlans:changed",e),tx.g.off("patients:changed",e)}},[eL]);let eE=(0,i.useCallback)(async()=>{ey(!1),eT("Protocolo aplicado com sucesso ao plano de tratamento!","success"),await eL()},[eL,eT]),eM=async e=>{c&&(await L.gp(c.id,e),em(!1))},ez=async e=>{c&&(await T.Z6({...c,...e}),ep(!1),eT("Paciente atualizado com sucesso!","success"))},eI=async e=>{try{return await I.Fy(e),eT("Consulta salva com sucesso!","success"),ef(!1),!0}catch(e){return eT("Falha ao salvar a consulta.","error"),!1}},eR=async(e,t)=>{let s=V.find(t=>t.id===e);if(!s)return!1;try{return t?await I.aJ(t,s.startTime):await I.d3(e),eT("Consulta removida com sucesso!","success"),ef(!1),!0}catch(e){return eT("Falha ao remover a consulta.","error"),!1}},eF=async()=>{if(eC&&c)try{await T.Xl(c.id,eC),eT("Arquivo anexado com sucesso!","success"),eD(null)}catch(e){eT("Falha ao anexar arquivo.","error")}},eO=async e=>{if(c){eT("Gerando PDF...","info");try{await M.Mp(e,c)}catch(e){eT("Falha ao gerar o PDF.","error")}}},e_=async e=>{if("finalized"!==e.status)return void eT("Apenas relat\xf3rios finalizados podem ser enviados.","error");eS(e.id);try{await M.Ns(e.id),eT("Relat\xf3rio marcado como enviado!","success"),eL()}catch(e){eT(e.message,"error")}finally{eS(null)}},eq=async e=>{if(!c||!ek.pointToEdit)return;let t=[...c.painPoints||[]];if(ek.pointToEdit.id)t=t.map(t=>t.id===ek.pointToEdit.id?{...t,...e}:t);else{let{x:s,y:a,bodyPart:i}=ek.pointToEdit;if(void 0===s||void 0===a||void 0===i)return void eT("Erro: n\xe3o foi poss\xedvel determinar a localiza\xe7\xe3o do ponto de dor.","error");let n={id:"pp_".concat(Date.now()),date:new Date().toISOString(),x:s,y:a,bodyPart:i,...e};t.push(n)}await T.TC(c.id,t),eA({isOpen:!1,pointToEdit:null}),eT("Mapa de dor atualizado!","success")},eZ=async()=>{var e;if(!c||!(null==(e=ek.pointToEdit)?void 0:e.id))return;let t=(c.painPoints||[]).filter(e=>e.id!==ek.pointToEdit.id);await T.TC(c.id,t),eA({isOpen:!1,pointToEdit:null}),eT("Ponto de dor removido.","success")};if(es)return(0,a.jsx)(q.A,{});if(!ew)return(0,a.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 text-red-500 mx-auto mb-4",children:"\uD83D\uDEAB"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Acesso Negado"}),(0,a.jsx)("p",{className:"text-red-600",children:"Voc\xea n\xe3o tem permiss\xe3o para visualizar este paciente."})]})});if(ei||!c)return(0,a.jsx)("div",{className:"text-center p-10 text-red-500",children:ei||"Paciente n\xe3o encontrado."});let eB=new Date(c.birthDate),eV=isNaN(eB.getTime())?"N/A":eB.toLocaleDateString("pt-BR",{timeZone:"UTC"});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(R.A,{title:c.name,subtitle:"Detalhes do prontu\xe1rio, hist\xf3rico e agendamentos.",children:[(0,a.jsxs)("button",{onClick:()=>{delete window.__selectedPatientId;let e=window.__setCurrentPage;e&&e("patients")},className:"inline-flex items-center rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 mr-3",children:[(0,a.jsx)(m.A,{className:"-ml-1 mr-2 h-5 w-5"}),"Voltar"]}),(0,a.jsxs)("button",{onClick:()=>ep(!0),className:"inline-flex items-center rounded-lg border border-transparent bg-sky-500 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-sky-600",children:[(0,a.jsx)(x.A,{className:"-ml-1 mr-2 h-5 w-5"}),"Editar Cadastro"]})]}),(0,a.jsx)(F.A,{isOpen:ed,onClose:()=>em(!1),onSave:eM}),(0,a.jsx)(O.A,{isOpen:ex,onClose:()=>ep(!1),onSave:ez,patientToEdit:c}),(0,a.jsx)(tb,{note:eh,onClose:()=>eb(null)}),(0,a.jsx)(_.A,{isOpen:eg,onClose:()=>ef(!1),onSave:eI,onDelete:eR,initialData:{date:new Date,therapistId:null==(e=l[0])?void 0:e.id},patients:[c],therapists:l,allAppointments:V}),ek.isOpen&&ek.pointToEdit&&(0,a.jsx)(eN.A,{isOpen:ek.isOpen,onClose:()=>eA({isOpen:!1,pointToEdit:null}),onSave:eq,onDelete:ek.pointToEdit.id?eZ:void 0,point:ek.pointToEdit}),c.conditions&&c.conditions.length>0&&(0,a.jsx)(eu,{isOpen:ej,onClose:()=>ey(!1),patient:c,onApply:eE}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,a.jsx)(Z.A,{title:"Informa\xe7\xf5es Pessoais",icon:(0,a.jsx)(p.A,{}),children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(tu,{icon:(0,a.jsx)(u.A,{className:"w-5 h-5"}),label:"Data de Nascimento",value:eV}),(0,a.jsx)(tu,{icon:(0,a.jsx)(h.A,{className:"w-5 h-5"}),label:"Telefone",value:c.phone}),(0,a.jsx)(tu,{icon:(0,a.jsx)(b.A,{className:"w-5 h-5"}),label:"Email",value:c.email})]})}),Q.length>0&&(0,a.jsx)(Z.A,{title:"Projetos Ativos",icon:(0,a.jsx)(g.A,{}),children:(0,a.jsx)("ul",{className:"space-y-3",children:Q.map(e=>(0,a.jsx)("li",{className:"p-3 bg-slate-50 rounded-lg",children:(0,a.jsx)(o.N_,{to:"/tasks?projectId=".concat(e.id),className:"font-semibold text-slate-800 hover:text-sky-600",children:e.title})},e.id))})}),c.conditions&&c.conditions.length>0&&(0,a.jsx)(Z.A,{title:"Condi\xe7\xf5es / Queixas",icon:(0,a.jsx)(f.A,{}),children:(0,a.jsx)("ul",{className:"space-y-3",children:c.conditions.map((e,t)=>(0,a.jsx)("li",{className:"p-3 bg-slate-50 rounded-lg",children:(0,a.jsx)("p",{className:"font-semibold text-slate-800",children:e.name})},"condition-".concat(e.name,"-").concat(t)))})}),c.surgeries&&c.surgeries.length>0&&(0,a.jsx)(Z.A,{title:"Hist\xf3rico Cir\xfargico",icon:(0,a.jsx)(f.A,{}),children:(0,a.jsx)("ul",{className:"space-y-3",children:c.surgeries.map((e,t)=>{let s=(e=>{let t=new Date(e),s=Math.ceil(Math.abs(new Date().getTime()-t.getTime())/864e5),a=Math.floor(s/7);return{days:s,weeks:a}})(e.date);return(0,a.jsxs)("li",{className:"p-3 bg-slate-50 rounded-lg",children:[(0,a.jsx)("p",{className:"font-semibold text-slate-800",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-slate-500 mt-1",children:(0,a.jsxs)("span",{children:[s.weeks," semanas"]})})]},"surgery-".concat(e.name,"-").concat(t))})})})]}),(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsx)("div",{className:"border-b border-slate-200",children:(0,a.jsxs)("nav",{className:"flex space-x-2","aria-label":"Tabs",children:[(0,a.jsx)(tg,{icon:j.A,label:"Dashboard Cl\xednico",isActive:"dashboard"===er,onClick:()=>ec("dashboard")}),(0,a.jsx)(tg,{icon:y.A,label:"Vis\xe3o Geral",isActive:"overview"===er,onClick:()=>ec("overview")}),(0,a.jsx)(tg,{icon:v.A,label:"Mapa Corporal",isActive:"bodymap"===er,onClick:()=>ec("bodymap")}),(0,a.jsx)(tg,{icon:N.A,label:"Hist\xf3rico Cl\xednico",isActive:"history"===er,onClick:()=>ec("history")}),(0,a.jsx)(tg,{icon:w.A,label:"Agendamentos",isActive:"appointments"===er,onClick:()=>ec("appointments")}),(0,a.jsx)(tg,{icon:k.A,label:"Laudos & Anexos",isActive:"docs"===er,onClick:()=>ec("docs")})]})}),"dashboard"===er&&(0,a.jsx)(ev,{patient:c,appointments:V,notes:K,plan:U,onMapClick:(e,t,s)=>{eA({isOpen:!0,pointToEdit:{x:e,y:t,bodyPart:s}})},onPointClick:e=>{eA({isOpen:!0,pointToEdit:e})}}),"overview"===er&&(0,a.jsxs)("div",{className:"space-y-6",children:[U?(0,a.jsx)(th,{plan:U,onSuggestProtocol:()=>ey(!0)}):(0,a.jsx)(Z.A,{title:"Plano de Tratamento",children:(0,a.jsx)("p",{children:"Nenhum plano ativo."})}),(c.trackedMetrics||[]).filter(e=>e.isActive).map(e=>(0,a.jsx)(J,{metric:e,notes:K},e.id))]}),"bodymap"===er&&(0,a.jsx)(tm,{patient:c}),"history"===er&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("button",{onClick:()=>em(!0),className:"inline-flex items-center rounded-lg border border-transparent bg-sky-500 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-sky-600",children:[(0,a.jsx)(A.A,{className:"-ml-1 mr-2 h-5 w-5"})," Nova Anota\xe7\xe3o"]})}),(0,a.jsx)($,{notes:K,onViewNote:eb})]}),"appointments"===er&&(0,a.jsx)(en,{appointments:V,onAdd:()=>ef(!0)}),"docs"===er&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(Z.A,{title:"Laudos M\xe9dicos",icon:(0,a.jsx)(k.A,{}),children:[(0,a.jsx)("div",{className:"space-y-3 mb-4",children:Y.map(e=>(0,a.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg",children:[(0,a.jsx)("p",{className:"font-semibold text-slate-800",children:e.title}),(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t border-slate-200 flex items-center justify-end gap-2",children:[(0,a.jsxs)(o.N_,{to:"/medical-report/edit/".concat(e.id),className:"inline-flex items-center px-2.5 py-1.5 border border-slate-300 text-xs font-medium rounded-md text-slate-700 bg-white hover:bg-slate-50",children:[(0,a.jsx)(x.A,{className:"w-3 h-3 mr-1.5"})," ","draft"===e.status?"Editar":"Visualizar"]}),(0,a.jsxs)("button",{onClick:()=>e_(e),disabled:"finalized"!==e.status||eP===e.id,className:"inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-sky-500 hover:bg-sky-600 disabled:bg-slate-300",children:[(0,a.jsx)(C.A,{className:"w-3 h-3 mr-1.5"})," Enviar"]}),(0,a.jsxs)("button",{onClick:()=>eO(e),disabled:"draft"===e.status,className:"inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-slate-600 hover:bg-slate-700 disabled:bg-slate-300",children:[(0,a.jsx)(D.A,{className:"w-3 h-3 mr-1.5"})," PDF"]})]})]},e.id))}),(0,a.jsxs)(o.N_,{to:"/medical-report/new/".concat(c.id),className:"w-full inline-flex items-center justify-center rounded-lg border border-transparent bg-sky-500 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-sky-600",children:[(0,a.jsx)(A.A,{className:"-ml-1 mr-2 h-5 w-5"})," Gerar Novo Laudo"]})]}),(0,a.jsxs)(Z.A,{title:"Anexos do Paciente",icon:(0,a.jsx)(P.A,{}),children:[(0,a.jsx)("div",{className:"space-y-3 mb-4",children:(c.attachments||[]).map((e,t)=>(0,a.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center p-2 bg-slate-50 rounded-lg hover:bg-slate-100",children:[(0,a.jsx)(k.A,{className:"w-5 h-5 text-slate-500 mr-3"}),(0,a.jsx)("span",{className:"text-sm text-slate-700 font-medium truncate",children:e.name})]},"attachment-".concat(e.name,"-").concat(t)))}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"file",id:"file-upload",className:"hidden",onChange:e=>{var t;return eD((null==(t=e.target.files)?void 0:t[0])||null)}}),(0,a.jsx)("label",{htmlFor:"file-upload",className:"w-full text-center px-3 py-2 text-sm bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors cursor-pointer truncate",children:eC?eC.name:"Escolher arquivo..."}),(0,a.jsx)("button",{onClick:eF,disabled:!eC,className:"p-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 disabled:bg-slate-300",children:(0,a.jsx)(S.A,{className:"w-5 h-5"})})]})]})]})]})]})]})}},95857:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(37876);s(14232);let i=e=>{let{title:t,icon:s,children:i,actionButton:n}=e;return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm h-full flex flex-col border border-slate-200/80",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-slate-800 flex items-center",children:[s&&(0,a.jsx)("span",{className:"mr-3 text-sky-500",children:s}),t]}),n]}),(0,a.jsx)("div",{className:"flex-grow",children:i})]})}}}]);