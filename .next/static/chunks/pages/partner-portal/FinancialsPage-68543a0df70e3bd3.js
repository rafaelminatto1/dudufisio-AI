(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5542,8745],{368:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(17963).A)("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]])},6782:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var s=a(37876),r=a(93704);function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",t),...a})}},17963:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var s=a(14232);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,s.forwardRef)((e,t)=>{let{color:a="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:m,...u}=e;return(0,s.createElement)("svg",{ref:t,...n,width:r,height:r,stroke:a,strokeWidth:o?24*Number(i)/Number(r):i,className:l("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(u)&&{"aria-hidden":"true"},...u},[...m.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let a=(0,s.forwardRef)((a,n)=>{let{className:o,...c}=a;return(0,s.createElement)(i,{ref:n,iconNode:t,className:l("lucide-".concat(r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),o),...c})});return a.displayName=r(e),a}},35880:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(37876);a(14232);let r=e=>{let{title:t,subtitle:a,children:r}=e;return(0,s.jsxs)("div",{className:"pb-8 md:flex md:items-center md:justify-between",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold leading-tight text-slate-900 tracking-tight",children:t}),(0,s.jsx)("p",{className:"mt-2 text-lg text-slate-600",children:a})]}),(0,s.jsx)("div",{className:"mt-4 flex md:mt-0 md:ml-4",children:r})]})}},36867:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(17963).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},45720:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(17963).A)("chart-no-axes-column",[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]])},48995:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(17963).A)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]])},54893:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(17963).A)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},59537:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var s=a(37876);a(14232);var r=a(79622),l=a(48995);let n=e=>{let{title:t,value:a,icon:n,change:i,changeType:o,subtitle:c}=e,d="increase"===o;return(0,s.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm hover:shadow-lg transition-shadow duration-300",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-slate-500 truncate",children:t}),(0,s.jsx)("p",{className:"text-3xl font-bold text-slate-800 mt-1",children:a})]}),(0,s.jsx)("div",{className:"bg-sky-100 text-sky-600 p-3 rounded-full",children:n})]}),(0,s.jsxs)("div",{className:"mt-2 flex items-center text-sm",children:[i&&(0,s.jsxs)("div",{className:"flex items-center font-semibold ".concat(d?"text-green-600":"text-red-600"),children:[d?(0,s.jsx)(r.A,{className:"w-4 h-4"}):(0,s.jsx)(l.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:i}),(0,s.jsx)("span",{className:"text-slate-500 font-normal ml-1.5",children:"vs. m\xeas anterior"})]}),!i&&c&&(0,s.jsx)("p",{className:"text-slate-500",children:c})]})]})}},60926:(e,t,a)=>{"use strict";a.d(t,{I0:()=>c,Wz:()=>u,YI:()=>h,eY:()=>m,k5:()=>d});var s=a(14776),r=a(66766);let l="fisioflow_expenses",n=e=>new Promise(t=>setTimeout(t,e)),i=()=>{try{let e=localStorage.getItem(l);if(e)return JSON.parse(e).map(e=>({...e,date:new Date(e.date)}))}catch(e){console.error("Failed to parse expenses from localStorage",e)}return o(r.UI),r.UI},o=e=>{try{localStorage.setItem(l,JSON.stringify(e))}catch(e){console.error("Failed to save expenses to localStorage",e)}},c=async e=>{let t;await n(200);let a=new Date;switch(e){case"this_month":t=new Date(a.getFullYear(),a.getMonth(),1);break;case"last_3_months":t=new Date(a.getFullYear(),a.getMonth()-2,1);break;case"this_year":t=new Date(a.getFullYear(),0,1)}return[...r.ZS.filter(e=>e.status===s.y2.Completed&&new Date(e.startTime)>=t).map(e=>({id:"rev_".concat(e.id),type:s.D_.Receita,date:e.startTime,description:"".concat(e.type," - ").concat(e.patientName),amount:e.value,category:e.type,patientName:e.patientName,appointmentId:e.id})),...i().filter(e=>new Date(e.date)>=t)].sort((e,t)=>t.date.getTime()-e.date.getTime())},d=async e=>{await n(300);let t=i(),a={...e,id:"exp_".concat(Date.now()),type:s.D_.Despesa};return t.unshift(a),o(t),a},m=async e=>{await n(300);let t=i();return o(t=t.map(t=>t.id===e.id?e:t)),e},u=async e=>{await n(300);let t=i();o(t=t.filter(t=>t.id!==e))},h=async e=>{await n(500);let t=r.XM,a=new Date,s=new Date(a.getFullYear(),a.getMonth(),1),l=[];for(let e of t)if(new Date(e.purchaseDate)>=s){let t=r.N.find(t=>t.id===e.patientId);if(t){let a=e.plan.price,s=.15*a,r=.05*a,n=a-s-r;l.push({id:"txn_".concat(e.id),type:"voucher_purchase",patientName:t.name,planName:e.plan.name,status:"completed",createdAt:e.purchaseDate,breakdown:{grossAmount:a,platformFee:s,taxAmount:r,netAmount:n}})}}return{summary:l.reduce((e,t)=>(e.grossRevenue+=t.breakdown.grossAmount,e.platformFee+=t.breakdown.platformFee,e.taxAmount+=t.breakdown.taxAmount,e.netRevenue+=t.breakdown.netAmount,e),{grossRevenue:0,platformFee:0,taxAmount:0,netRevenue:0,period:"Este M\xeas"}),transactions:t.map(e=>{let t=r.N.find(t=>t.id===e.patientId),a=e.plan.price,s=.15*a,l=.05*a;return{id:"txn_".concat(e.id),type:"voucher_purchase",patientName:(null==t?void 0:t.name)||"Desconhecido",planName:e.plan.name,status:"completed",createdAt:e.purchaseDate,breakdown:{grossAmount:a,platformFee:s,taxAmount:l,netAmount:a-s-l}}}).sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime())}}},66822:(e,t,a)=>{"use strict";a.d(t,{dj:()=>n}),a(37876);var s=a(14232);let r=(0,s.createContext)(void 0),l=(0,s.createContext)(void 0),n=()=>{let e=(()=>{let e=(0,s.useContext)(r);return void 0===e?{enabled:!1,logRouterChange:()=>{},logHookCall:()=>{},logContextAccess:()=>{}}:e})(),t=(0,s.useContext)(l);if(e.logContextAccess("ToastContext","useToast"),!t){let e=Error("useToast must be used within a ToastProvider");throw console.error("âŒ Toast Context Error:",e.message),e}return{showToast:t.showToast}}},79622:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(17963).A)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},81148:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/partner-portal/FinancialsPage",function(){return a(97552)}])},93704:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(69241),r=a(29573);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},97552:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var s=a(37876),r=a(14232),l=a(35880),n=a(60926),i=a(41547),o=a(66822),c=a(59537),d=a(54893);let m=(0,a(17963).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);var u=a(54410),h=a(45720),x=a(34007),p=a(42320),f=a(4069),g=a(40570),v=a(25493),w=a(39493),y=a(12347),N=a(6782);let j=()=>{let[e,t]=(0,r.useState)(null),[a,j]=(0,r.useState)([]),[A,k]=(0,r.useState)(!0),{user:b}=(0,i.As)(),{showToast:_}=(0,o.dj)();(0,r.useEffect)(()=>{(async()=>{if(b){k(!0);try{let{summary:e,transactions:a}=await n.YI(b.id);t(e),j(a)}catch(e){_("Erro ao carregar dados financeiros.","error")}finally{k(!1)}}})()},[b,_]);let M=(0,r.useMemo)(()=>{let e=new Map;return a.forEach(t=>{let a=t.createdAt.toLocaleDateString("pt-BR",{month:"short",year:"2-digit"});e.set(a,(e.get(a)||0)+t.breakdown.netAmount)}),Array.from(e.entries()).map(e=>{let[t,a]=e;return{name:t,"Receita L\xedquida":a}})},[a]),D=e=>"R$ ".concat(e.toFixed(2).replace(".",","));if(A)return(0,s.jsx)(N.E,{className:"h-[600px] w-full"});if(!e)return(0,s.jsx)("div",{className:"text-center p-10",children:"N\xe3o foi poss\xedvel carregar os dados financeiros."});let C=[{title:"Receita Bruta (M\xeas)",value:D(e.grossRevenue),icon:(0,s.jsx)(d.A,{})},{title:"Taxa da Plataforma",value:D(e.platformFee),icon:(0,s.jsx)(m,{})},{title:"Impostos (Simulado)",value:D(e.taxAmount),icon:(0,s.jsx)(u.A,{})},{title:"Receita L\xedquida (M\xeas)",value:D(e.netRevenue),icon:(0,s.jsx)(h.A,{})}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.A,{title:"Painel Financeiro",subtitle:"Acompanhe suas receitas e transa\xe7\xf5es da parceria."}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:C.map(e=>(0,s.jsx)(c.A,{...e},e.title))}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Receita L\xedquida Mensal"}),(0,s.jsx)("div",{className:"h-72",children:(0,s.jsx)(x.u,{width:"100%",height:"100%",children:(0,s.jsxs)(p.E,{data:M,margin:{top:5,right:20,left:-10,bottom:5},children:[(0,s.jsx)(f.d,{strokeDasharray:"3 3",vertical:!1}),(0,s.jsx)(g.W,{dataKey:"name",fontSize:12}),(0,s.jsx)(v.h,{fontSize:12,tickFormatter:e=>"R$".concat(e/1e3,"k")}),(0,s.jsx)(w.m,{formatter:e=>D(e)}),(0,s.jsx)(y.y,{dataKey:"Receita L\xedquida",fill:"#14b8a6"})]})})})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"\xdaltimas Transa\xe7\xf5es"}),(0,s.jsx)("div",{className:"overflow-y-auto max-h-72",children:(0,s.jsx)("table",{className:"min-w-full",children:(0,s.jsx)("tbody",{className:"divide-y divide-slate-200",children:a.slice(0,10).map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{className:"p-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:e.patientName}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:e.planName})]}),(0,s.jsxs)("td",{className:"p-2 text-right",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-green-600",children:D(e.breakdown.netAmount)}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:e.createdAt.toLocaleDateString("pt-BR")})]})]},e.id))})})})]})]})]})]})}}},e=>{e.O(0,[2749,5898,2170,2104,4164,8558,6766,5977,1547,636,6593,8792],()=>e(e.s=81148)),_N_E=e.O()}]);