(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[430],{13925:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>D});var a=s(37876),l=s(14232),r=s(88307),n=s(14952),i=s(14776),c=s(87107),d=s(66822),o=s(88635),x=s(9552),m=s(56244),h=s(46293),u=s(97433);let p=e=>{let{event:t,registrations:s}=e,{totalRegistered:r,checkInRate:n,revenue:c,checkInCount:d}=(0,l.useMemo)(()=>{let e=s.length,a=s.filter(e=>e.status===i.m7.Attended).length,l=e>0?a/e*100:0,r=t.isFree?0:e*(t.price||0);return{totalRegistered:e.toString(),checkInRate:l,revenue:"R$ ".concat(r.toFixed(2).replace(".",",")),checkInCount:a}},[t,s]),o="".concat(n.toFixed(1),"%"),x="bg-teal-500";return n<75&&(x="bg-amber-500"),n<50&&(x="bg-red-500"),(0,a.jsx)("div",{className:"bg-slate-50 p-6 rounded-2xl border border-slate-200",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"md:col-span-1 space-y-4",children:[(0,a.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow-sm text-center",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-500",children:"Total de Inscritos"}),(0,a.jsx)("p",{className:"text-4xl font-bold text-slate-800 mt-1",children:r})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow-sm text-center",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-500",children:"Faturamento Previsto"}),(0,a.jsx)("p",{className:"text-4xl font-bold text-slate-800 mt-1",children:c})]})]}),(0,a.jsxs)("div",{className:"md:col-span-2 bg-white p-6 rounded-xl shadow-sm flex flex-col justify-center",children:[(0,a.jsx)("h4",{className:"font-semibold text-slate-700 text-center mb-3 text-lg",children:"Taxa de Check-in"}),(0,a.jsxs)("div",{className:"w-full bg-slate-200 rounded-full h-8 relative",children:[(0,a.jsx)("div",{className:"".concat(x," h-8 rounded-full transition-all duration-500"),style:{width:"".concat(n,"%")}}),(0,a.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-sm font-bold text-white drop-shadow-sm",children:o})]}),(0,a.jsxs)("p",{className:"text-center text-xs text-slate-500 mt-2",children:[d," de ",r," participantes compareceram."]})]})]})})};var b=s(59435),g=s(83981);let f={[i.m7.Pending]:{text:"text-amber-700",bg:"bg-amber-100"},[i.m7.Confirmed]:{text:"text-blue-700",bg:"bg-blue-100"},[i.m7.Attended]:{text:"text-green-700",bg:"bg-green-100"},[i.m7.Cancelled]:{text:"text-red-700",bg:"bg-red-100"}},j=e=>{let{registrations:t,onCheckIn:s}=e,[r,n]=(0,l.useState)(""),c=t.filter(e=>e.fullName.toLowerCase().includes(r.toLowerCase())||e.email.toLowerCase().includes(r.toLowerCase()));return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"relative mb-4 max-w-sm",children:[(0,a.jsx)(b.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,a.jsx)("input",{type:"text",value:r,onChange:e=>n(e.target.value),placeholder:"Buscar participante...",className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg"})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-slate-200",children:[(0,a.jsx)("thead",{className:"bg-slate-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-3 text-left text-xs font-medium text-slate-500 uppercase",children:"Nome"}),(0,a.jsx)("th",{className:"p-3 text-left text-xs font-medium text-slate-500 uppercase",children:"Contato"}),(0,a.jsx)("th",{className:"p-3 text-left text-xs font-medium text-slate-500 uppercase",children:"Data Inscri\xe7\xe3o"}),(0,a.jsx)("th",{className:"p-3 text-center text-xs font-medium text-slate-500 uppercase",children:"Status"}),(0,a.jsx)("th",{className:"p-3 text-center text-xs font-medium text-slate-500 uppercase",children:"A\xe7\xf5es"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:c.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"p-3 font-medium text-slate-800",children:e.fullName}),(0,a.jsx)("td",{className:"p-3 text-sm text-slate-500",children:e.email}),(0,a.jsx)("td",{className:"p-3 text-sm text-slate-500",children:e.registrationDate.toLocaleDateString("pt-BR")}),(0,a.jsx)("td",{className:"p-3 text-center",children:(0,a.jsx)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(f[e.status].bg," ").concat(f[e.status].text),children:e.status})}),(0,a.jsx)("td",{className:"p-3 text-center",children:e.status===i.m7.Confirmed&&(0,a.jsx)("button",{onClick:()=>s(e.id),className:"p-1.5 text-green-600 bg-green-50 hover:bg-green-100 rounded-full",title:"Realizar Check-in",children:(0,a.jsx)(g.A,{className:"w-4 h-4"})})})]},e.id))})]})})]})};var N=s(28249),v=s(61052);let w=e=>{let{isOpen:t,onClose:s,registrations:r,onCheckIn:n}=e,[i,c]=(0,l.useState)(""),[d,o]=(0,l.useState)(null);if(!t)return null;let x=r.filter(e=>e.fullName.toLowerCase().includes(i.toLowerCase())),m=async e=>{o(e),await n(e,"manual"),o(null)};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:s,children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("header",{className:"flex items-center justify-between p-5 border-b",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"Check-in Manual"}),(0,a.jsx)("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-100",children:(0,a.jsx)(N.A,{className:"w-5 h-5"})})]}),(0,a.jsxs)("main",{className:"p-6 flex-1 flex flex-col",children:[(0,a.jsxs)("div",{className:"relative mb-4",children:[(0,a.jsx)(b.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,a.jsx)("input",{type:"text",value:i,onChange:e=>c(e.target.value),placeholder:"Buscar participante para check-in...",className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg"})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto -mx-6 px-6 divide-y divide-slate-200",children:[x.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-slate-800",children:e.fullName}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:e.email})]}),(0,a.jsx)("button",{onClick:()=>m(e.id),disabled:d===e.id,className:"inline-flex items-center justify-center bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow-sm transition-colors disabled:bg-green-300",children:d===e.id?(0,a.jsx)(v.A,{className:"w-5 h-5 animate-spin"}):(0,a.jsx)(g.A,{className:"w-5 h-5"})})]},e.id)),0===x.length&&(0,a.jsx)("p",{className:"text-center text-slate-500 pt-10",children:"Nenhum participante encontrado ou todos j\xe1 fizeram check-in."})]})]})]})})};var y=s(41547),C=s(64041),k=s(6781),A=s(79758),S=s(1694);let E={[i.fb.Draft]:{text:"text-slate-700",bg:"bg-slate-200",dot:"bg-slate-500"},[i.fb.Published]:{text:"text-blue-700",bg:"bg-blue-200",dot:"bg-blue-500"},[i.fb.Active]:{text:"text-green-700",bg:"bg-green-200",dot:"bg-green-500"},[i.fb.Completed]:{text:"text-gray-700",bg:"bg-gray-300",dot:"bg-gray-600"},[i.fb.Cancelled]:{text:"text-red-700",bg:"bg-red-200",dot:"bg-red-500"}},P=e=>{let{event:t,onEdit:s,onCheckIn:l}=e,{text:r,bg:n,dot:i}=E[t.status],c=t.startDate.toLocaleString("pt-BR",{dateStyle:"full",timeStyle:"short"});return(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden mb-8",children:[(0,a.jsxs)("div",{className:"relative h-48 md:h-64 bg-slate-200",children:[(0,a.jsx)("img",{src:t.bannerUrl||"https://images.unsplash.com/photo-1511795409834-ef04bbd61622?q=80&w=1470",alt:"Banner for ".concat(t.name),className:"w-full h-full object-cover"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),(0,a.jsxs)("div",{className:"absolute bottom-0 left-0 p-6",children:[(0,a.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ".concat(n," ").concat(r," shadow"),children:[(0,a.jsx)("span",{className:"w-2 h-2 mr-2 rounded-full ".concat(i)}),t.status]}),(0,a.jsx)("h1",{className:"text-2xl md:text-4xl font-extrabold text-white mt-2 shadow-lg",children:t.name})]})]}),(0,a.jsxs)("div",{className:"p-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center text-slate-600",children:[(0,a.jsx)(C.A,{className:"w-5 h-5 mr-3 text-slate-400"}),(0,a.jsx)("span",{className:"font-semibold",children:c})]}),(0,a.jsxs)("div",{className:"flex items-center text-slate-600",children:[(0,a.jsx)(k.A,{className:"w-5 h-5 mr-3 text-slate-400"}),(0,a.jsx)("span",{className:"font-semibold",children:t.location})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[(0,a.jsxs)("button",{onClick:s,className:"w-full md:w-auto flex-1 inline-flex items-center justify-center rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50",children:[(0,a.jsx)(A.A,{className:"w-4 h-4 mr-2"})," Editar"]}),(0,a.jsxs)("button",{onClick:l,className:"w-full md:w-auto flex-1 inline-flex items-center justify-center rounded-lg border border-transparent bg-teal-500 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-teal-600",children:[(0,a.jsx)(S.A,{className:"w-4 h-4 mr-2"})," Check-in"]})]})]})]})};var _=s(32257),I=s(54893);let L={[i.aJ.Applied]:{text:"text-amber-700",bg:"bg-amber-100"},[i.aJ.Confirmed]:{text:"text-blue-700",bg:"bg-blue-100"},[i.aJ.Paid]:{text:"text-green-700",bg:"bg-green-100"},[i.aJ.Cancelled]:{text:"text-red-700",bg:"bg-red-100"}},F=e=>{let{providers:t}=e,[s,r]=(0,l.useState)(""),[n,o]=(0,l.useState)(null),{showToast:x}=(0,d.dj)(),m=async e=>{o(e);try{await c.g.confirmProvider(e),x("Participa\xe7\xe3o confirmada!","success")}catch(e){x(e.message,"error")}finally{o(null)}},h=async e=>{o(e);try{await c.g.payProvider(e),x("Pagamento registrado!","success")}catch(e){x(e.message,"error")}finally{o(null)}},u=t.filter(e=>e.name.toLowerCase().includes(s.toLowerCase()));return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"relative mb-4 max-w-sm",children:[(0,a.jsx)(b.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,a.jsx)("input",{type:"text",value:s,onChange:e=>r(e.target.value),placeholder:"Buscar fisioterapeuta...",className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg"})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-slate-200",children:[(0,a.jsx)("thead",{className:"bg-slate-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-3 text-left text-xs font-medium text-slate-500 uppercase",children:"Nome"}),(0,a.jsx)("th",{className:"p-3 text-left text-xs font-medium text-slate-500 uppercase",children:"Contato"}),(0,a.jsx)("th",{className:"p-3 text-left text-xs font-medium text-slate-500 uppercase",children:"CREFITO"}),(0,a.jsx)("th",{className:"p-3 text-center text-xs font-medium text-slate-500 uppercase",children:"Status"}),(0,a.jsx)("th",{className:"p-3 text-center text-xs font-medium text-slate-500 uppercase",children:"A\xe7\xf5es"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:u.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"p-3 font-medium text-slate-800",children:e.name}),(0,a.jsx)("td",{className:"p-3 text-sm text-slate-500",children:e.phone}),(0,a.jsx)("td",{className:"p-3 text-sm text-slate-500",children:e.professionalId||"N/A"}),(0,a.jsx)("td",{className:"p-3 text-center",children:(0,a.jsx)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(L[e.status].bg," ").concat(L[e.status].text),children:e.status})}),(0,a.jsx)("td",{className:"p-3 text-center space-x-2",children:n===e.id?(0,a.jsx)(v.A,{className:"w-4 h-4 animate-spin mx-auto text-slate-400"}):(0,a.jsxs)(a.Fragment,{children:[e.status===i.aJ.Applied&&(0,a.jsx)("button",{onClick:()=>m(e.id),className:"p-1.5 text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-full",title:"Confirmar Presen\xe7a",children:(0,a.jsx)(_.A,{className:"w-4 h-4"})}),e.status===i.aJ.Confirmed&&(0,a.jsx)("button",{onClick:()=>h(e.id),className:"p-1.5 text-green-600 bg-green-50 hover:bg-green-100 rounded-full",title:"Registrar Pagamento",children:(0,a.jsx)(I.A,{className:"w-4 h-4"})})]})})]},e.id))})]})}),0===u.length&&(0,a.jsx)("p",{className:"text-center py-8 text-sm text-slate-500",children:"Nenhum fisioterapeuta encontrado."})]})};var R=s(46885);let B=e=>{let{icon:t,label:s,isActive:l,onClick:r}=e;return(0,a.jsxs)("button",{onClick:r,className:"flex items-center whitespace-nowrap py-3 px-4 font-medium text-sm rounded-t-lg border-b-2 ".concat(l?"border-teal-500 text-teal-600 bg-white":"border-transparent text-slate-500 hover:text-slate-700 hover:bg-slate-50"),children:[(0,a.jsx)(t,{className:"w-5 h-5 mr-2"})," ",s]})},D=()=>{let{id:e}=r.g(),{showToast:t}=(0,d.dj)(),{user:s}=(0,y.As)(),[b,g]=(0,l.useState)(null),[f,N]=(0,l.useState)([]),[v,C]=(0,l.useState)(!0),[k,A]=(0,l.useState)("participants"),[S,E]=(0,l.useState)(!1),[_,I]=(0,l.useState)(!1),L=(0,l.useCallback)(async()=>{if(e){C(!0);try{let t=await c.g.getEventById(e),s=await c.g.getRegistrationsByEventId(e);g(t||null),N(s)}catch(e){t("Erro ao carregar detalhes do evento.","error")}finally{C(!1)}}},[e,t]);(0,l.useEffect)(()=>(L(),c.g.on("events:changed",L),()=>{c.g.off("events:changed",L)}),[L]);let D=async(e,a)=>{if(!s)return!1;try{return await c.g.checkInParticipant(e,a,s.id),t("Check-in realizado com sucesso!","success"),!0}catch(e){return t(e.message,"error"),!1}},T=async e=>{if(s)try{await c.g.saveEvent(e,s.id),t(e.id?"Evento atualizado!":"Evento criado!","success"),I(!1)}catch(e){t("Falha ao salvar o evento.","error")}};return v?(0,a.jsx)(o.A,{}):b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.N_,{to:"/events",className:"inline-flex items-center text-sm font-semibold text-slate-600 hover:text-slate-800 mb-4",children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Voltar para todos os eventos"]}),(0,a.jsx)(P,{event:b,onEdit:()=>I(!0),onCheckIn:()=>E(!0)}),(0,a.jsx)(R.A,{isOpen:_,onClose:()=>I(!1),onSave:T,eventToEdit:b}),(0,a.jsx)(w,{isOpen:S,onClose:()=>E(!1),registrations:f.filter(e=>e.status!==i.m7.Attended),onCheckIn:D}),(0,a.jsxs)("div",{className:"mt-8 bg-white rounded-2xl shadow-sm",children:[(0,a.jsx)("div",{className:"border-b border-slate-200",children:(0,a.jsxs)("nav",{className:"flex space-x-2 px-4","aria-label":"Tabs",children:[(0,a.jsx)(B,{icon:m.A,label:"Dashboard",isActive:"dashboard"===k,onClick:()=>A("dashboard")}),(0,a.jsx)(B,{icon:h.A,label:"Participantes",isActive:"participants"===k,onClick:()=>A("participants")}),b.allowsProviders&&(0,a.jsx)(B,{icon:u.A,label:"Fisioterapeutas",isActive:"providers"===k,onClick:()=>A("providers")})]})}),(0,a.jsxs)("div",{className:"p-6",children:["dashboard"===k&&(0,a.jsx)(p,{event:b,registrations:f}),"participants"===k&&(0,a.jsx)(j,{registrations:f,onCheckIn:e=>D(e,"manual")}),"providers"===k&&b.allowsProviders&&(0,a.jsx)(F,{providers:b.providers})]})]})]}):(0,a.jsx)("div",{className:"text-center p-10",children:"Evento n\xe3o encontrado."})}},17732:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/EventDetailPage",function(){return s(13925)}])}},e=>{e.O(0,[3796,5898,2170,8307,4952,2954,6766,5977,1547,2546,636,6593,8792],()=>e(e.s=17732)),_N_E=e.O()}]);